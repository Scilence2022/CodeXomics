<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•åŸºå› ç»„æ•°æ®ä¸‹è½½åŠŸèƒ½</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .test-section h2 {
            color: #34495e;
            margin-top: 0;
        }
        
        .button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
        }
        
        .button.success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
        }
        
        .menu-info {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .menu-info h3 {
            margin: 0 0 10px 0;
            color: #2e7d32;
        }
        
        .api-test {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .api-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }
        
        .api-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .api-card p {
            margin: 0 0 15px 0;
            color: #7f8c8d;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§¬ åŸºå› ç»„æ•°æ®ä¸‹è½½åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="menu-info">
            <h3>ğŸ“‹ æµ‹è¯•è¯´æ˜</h3>
            <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•æ–°æ·»åŠ çš„åŸºå› ç»„æ•°æ®ä¸‹è½½åŠŸèƒ½ã€‚åŠŸèƒ½å·²æ·»åŠ åˆ° <strong>File â†’ Download Genomic Data</strong> èœå•ä¸­ã€‚</p>
            <ul>
                <li><strong>NCBI Databases:</strong> GenBank Sequences, RefSeq Genomes, SRA Sequencing Data, Assembly Data</li>
                <li><strong>EMBL-EBI Databases:</strong> EMBL Sequences, Ensembl Genomes, ENA Archive</li>
                <li><strong>Other Databases:</strong> DDBJ Sequences, UniProt Proteins, KEGG Pathways</li>
                <li><strong>Bulk Download Manager:</strong> æ‰¹é‡ä¸‹è½½ç®¡ç†å™¨ (Cmd/Ctrl+Shift+D)</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” èœå•è®¿é—®æµ‹è¯•</h2>
            <p>é€šè¿‡åº”ç”¨èœå•æµ‹è¯•å„ä¸ªæ•°æ®åº“çš„è®¿é—®åŠŸèƒ½ï¼š</p>
            <button class="button" onclick="testMenuAccess('ncbi-genbank')">æµ‹è¯• NCBI GenBank</button>
            <button class="button" onclick="testMenuAccess('ncbi-refseq')">æµ‹è¯• NCBI RefSeq</button>
            <button class="button" onclick="testMenuAccess('embl-sequences')">æµ‹è¯• EMBL Sequences</button>
            <button class="button" onclick="testMenuAccess('ensembl-genomes')">æµ‹è¯• Ensembl Genomes</button>
            <button class="button" onclick="testMenuAccess('uniprot-proteins')">æµ‹è¯• UniProt Proteins</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“¡ API è¿æ¥æµ‹è¯•</h2>
            <p>æµ‹è¯•ä¸å„ä¸ªå…¬å…±æ•°æ®åº“APIçš„è¿æ¥çŠ¶æ€ï¼š</p>
            <div class="api-test">
                <div class="api-card">
                    <h4>NCBI E-utilities</h4>
                    <p>æµ‹è¯•NCBI E-utilities APIè¿æ¥</p>
                    <button class="button" onclick="testAPI('ncbi')">æµ‹è¯• NCBI API</button>
                    <div id="ncbi-status"></div>
                </div>
                
                <div class="api-card">
                    <h4>EMBL-EBI</h4>
                    <p>æµ‹è¯•EMBL-EBI REST APIè¿æ¥</p>
                    <button class="button" onclick="testAPI('embl')">æµ‹è¯• EMBL API</button>
                    <div id="embl-status"></div>
                </div>
                
                <div class="api-card">
                    <h4>Ensembl</h4>
                    <p>æµ‹è¯•Ensembl REST APIè¿æ¥</p>
                    <button class="button" onclick="testAPI('ensembl')">æµ‹è¯• Ensembl API</button>
                    <div id="ensembl-status"></div>
                </div>
                
                <div class="api-card">
                    <h4>UniProt</h4>
                    <p>æµ‹è¯•UniProt REST APIè¿æ¥</p>
                    <button class="button" onclick="testAPI('uniprot')">æµ‹è¯• UniProt API</button>
                    <div id="uniprot-status"></div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”¬ æ ·æœ¬æœç´¢æµ‹è¯•</h2>
            <p>ä½¿ç”¨é¢„å®šä¹‰çš„æœç´¢è¯æµ‹è¯•å„ä¸ªæ•°æ®åº“çš„æœç´¢åŠŸèƒ½ï¼š</p>
            <button class="button success" onclick="performSampleSearch('escherichia coli')">æœç´¢ E.coli</button>
            <button class="button success" onclick="performSampleSearch('homo sapiens')">æœç´¢ Human</button>
            <button class="button success" onclick="performSampleSearch('saccharomyces cerevisiae')">æœç´¢ Yeast</button>
            <button class="button success" onclick="performSampleSearch('NC_000913')">æœç´¢ç‰¹å®šåºåˆ—å·</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“¥ ä¸‹è½½åŠŸèƒ½æµ‹è¯•</h2>
            <p>æµ‹è¯•æ–‡ä»¶ä¸‹è½½åŠŸèƒ½çš„åŸºæœ¬æ“ä½œï¼š</p>
            <button class="button" onclick="testDirectorySelection()">æµ‹è¯•ç›®å½•é€‰æ‹©</button>
            <button class="button" onclick="testFileDownload()">æµ‹è¯•æ–‡ä»¶ä¸‹è½½</button>
            <div id="download-status"></div>
        </div>
        
        <div class="log" id="testLog">æµ‹è¯•æ—¥å¿—å°†åœ¨è¿™é‡Œæ˜¾ç¤º...</div>
    </div>

    <script>
        let logElement = document.getElementById('testLog');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function testMenuAccess(downloadType) {
            log(`ğŸ” Testing menu access for: ${downloadType}`);
            log(`âœ… Menu structure successfully added to File â†’ Download Genomic Data`);
            log(`ğŸ“ To test: Go to File menu â†’ Download Genomic Data â†’ Select database type`);
            log(`ğŸ¯ Expected: Opens genomic download window with ${downloadType} configuration\n`);
        }
        
        async function testAPI(apiType) {
            const statusElement = document.getElementById(`${apiType}-status`);
            statusElement.innerHTML = 'â³ Testing...';
            
            try {
                let testUrl;
                switch (apiType) {
                    case 'ncbi':
                        testUrl = 'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nucleotide&term=escherichia%20coli&retmax=1&retmode=json';
                        break;
                    case 'embl':
                        testUrl = 'https://www.ebi.ac.uk/ena/portal/api/search?result=sequence&query=escherichia%20coli&format=json&limit=1';
                        break;
                    case 'ensembl':
                        testUrl = 'https://rest.ensembl.org/info/ping?content-type=application/json';
                        break;
                    case 'uniprot':
                        testUrl = 'https://rest.uniprot.org/uniprotkb/search?query=escherichia%20coli&format=json&size=1';
                        break;
                }
                
                log(`ğŸ”— Testing ${apiType.toUpperCase()} API: ${testUrl}`);
                
                const response = await fetch(testUrl);
                if (response.ok) {
                    statusElement.innerHTML = 'âœ… API Connected';
                    statusElement.style.color = 'green';
                    log(`âœ… ${apiType.toUpperCase()} API test successful (Status: ${response.status})`);
                } else {
                    statusElement.innerHTML = 'âŒ API Error';
                    statusElement.style.color = 'red';
                    log(`âŒ ${apiType.toUpperCase()} API test failed (Status: ${response.status})`);
                }
            } catch (error) {
                statusElement.innerHTML = 'âŒ Connection Failed';
                statusElement.style.color = 'red';
                log(`âŒ ${apiType.toUpperCase()} API connection failed: ${error.message}`);
            }
            log('');
        }
        
        function performSampleSearch(searchTerm) {
            log(`ğŸ”¬ Sample search test for: "${searchTerm}"`);
            log(`ğŸ“ To perform actual search:`);
            log(`   1. Open File â†’ Download Genomic Data â†’ Select any database`);
            log(`   2. Enter search term: "${searchTerm}"`);
            log(`   3. Click "Search Database"`);
            log(`   4. Verify results appear with organism information`);
            log(`ğŸ¯ Expected: Results showing accession numbers, organisms, lengths\n`);
        }
        
        async function testDirectorySelection() {
            log(`ğŸ“ Testing directory selection...`);
            
            if (window.electronAPI && window.electronAPI.selectDirectory) {
                try {
                    const result = await window.electronAPI.selectDirectory();
                    if (result.success && !result.canceled) {
                        log(`âœ… Directory selection successful: ${result.filePath}`);
                    } else if (result.canceled) {
                        log(`â„¹ï¸ Directory selection canceled by user`);
                    } else {
                        log(`âŒ Directory selection failed: ${result.error || 'Unknown error'}`);
                    }
                } catch (error) {
                    log(`âŒ Directory selection error: ${error.message}`);
                }
            } else {
                log(`âŒ electronAPI.selectDirectory not available - requires Electron environment`);
            }
            log('');
        }
        
        async function testFileDownload() {
            log(`ğŸ“¥ Testing file download functionality...`);
            
            if (window.electronAPI && window.electronAPI.downloadFile) {
                try {
                    // æµ‹è¯•ä¸‹è½½ä¸€ä¸ªå°çš„æ ·æœ¬æ–‡ä»¶
                    const testUrl = 'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&id=NC_000913&rettype=fasta&retmode=text&retstart=1&retend=100';
                    const outputPath = './test_download.fasta';
                    
                    log(`ğŸ”— Testing download from: ${testUrl}`);
                    
                    const result = await window.electronAPI.downloadFile(testUrl, outputPath);
                    
                    if (result.success) {
                        log(`âœ… File download successful: ${result.filePath}`);
                        document.getElementById('download-status').innerHTML = 'âœ… Download test passed';
                        document.getElementById('download-status').style.color = 'green';
                    } else {
                        log(`âŒ File download failed: ${result.error}`);
                        document.getElementById('download-status').innerHTML = 'âŒ Download test failed';
                        document.getElementById('download-status').style.color = 'red';
                    }
                } catch (error) {
                    log(`âŒ Download test error: ${error.message}`);
                    document.getElementById('download-status').innerHTML = 'âŒ Download test error';
                    document.getElementById('download-status').style.color = 'red';
                }
            } else {
                log(`âŒ electronAPI.downloadFile not available - requires Electron environment`);
                document.getElementById('download-status').innerHTML = 'âŒ Electron API not available';
                document.getElementById('download-status').style.color = 'red';
            }
            log('');
        }
        
        // åˆå§‹åŒ–æµ‹è¯•
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸ§¬ åŸºå› ç»„æ•°æ®ä¸‹è½½åŠŸèƒ½æµ‹è¯•é¡µé¢å·²åŠ è½½');
            log('ğŸ“‹ åŠŸèƒ½ç‰¹æ€§ï¼š');
            log('   âœ“ æ”¯æŒå¤šä¸ªå…¬å…±æ•°æ®åº“ (NCBI, EMBL, DDBJ, UniProt, KEGG)');
            log('   âœ“ å®æ—¶APIæœç´¢å’Œæ•°æ®æ£€ç´¢');
            log('   âœ“ å¤šç§æ–‡ä»¶æ ¼å¼ä¸‹è½½ (FASTA, GenBank, GFF, EMBL)');
            log('   âœ“ æ‰¹é‡ä¸‹è½½ç®¡ç†');
            log('   âœ“ æ™ºèƒ½æœç´¢è¿‡æ»¤å™¨');
            log('   âœ“ ä¸‹è½½è¿›åº¦è·Ÿè¸ª');
            log('');
            log('ğŸ¯ æµ‹è¯•æŒ‡å—ï¼š');
            log('   1. ä½¿ç”¨ä¸Šæ–¹æŒ‰é’®æµ‹è¯•å„ä¸ªåŠŸèƒ½æ¨¡å—');
            log('   2. é€šè¿‡èœå• File â†’ Download Genomic Data è®¿é—®ä¸»åŠŸèƒ½');
            log('   3. éªŒè¯æœç´¢ã€é¢„è§ˆå’Œä¸‹è½½åŠŸèƒ½');
            log('');
        });
    </script>
</body>
</html> 