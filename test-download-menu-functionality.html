<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Genomic Data Menu Functionality Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }

        .menu-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }

        .menu-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-item:hover {
            border-color: #3498db;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
        }

        .menu-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .menu-desc {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .menu-path {
            font-family: 'Courier New', monospace;
            background: #f1f3f4;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
            color: #495057;
        }

        .test-results {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }

        .test-result {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 14px;
        }

        .status-icon {
            margin-right: 8px;
            font-size: 16px;
        }

        .status-pass {
            color: #27ae60;
        }

        .status-fail {
            color: #e74c3c;
        }

        .status-pending {
            color: #f39c12;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            margin: 5px;
            transition: background 0.3s ease;
        }

        .btn:hover {
            background: #2980b9;
        }

        .btn-test {
            background: #27ae60;
        }

        .btn-test:hover {
            background: #229954;
        }

        .btn-reset {
            background: #95a5a6;
        }

        .btn-reset:hover {
            background: #7f8c8d;
        }

        .summary {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .summary h3 {
            color: #155724;
            margin: 0 0 10px 0;
        }

        .metric {
            display: inline-block;
            background: white;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 4px;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß¨ Download Genomic Data Menu Functionality Test</h1>
        
        <div class="instructions">
            <h3>üìã Testing Instructions</h3>
            <p><strong>Purpose:</strong> Verify that all Download Genomic Data submenu items work without requiring active projects.</p>
            <p><strong>Method:</strong> Test each menu item by clicking the test buttons below. Each should open a download window without showing "Please open or create a project first" dialog.</p>
            <p><strong>Expected Result:</strong> All menu items should open directly to the genomic data download interface.</p>
        </div>

        <h2>üóÇÔ∏è File Menu Structure</h2>
        <div class="menu-section">
            <div class="menu-title">üìÅ File ‚Üí Download Genomic Data</div>
            <div class="menu-desc">The main download menu with three database categories and a bulk download manager.</div>
        </div>

        <h2>üî¨ NCBI Databases</h2>
        <div class="menu-section">
            <div class="menu-item" onclick="testMenuItem('ncbi-genbank')">
                <div class="menu-title">GenBank Sequences</div>
                <div class="menu-desc">Download nucleotide sequences from NCBI GenBank database</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí NCBI Databases ‚Üí GenBank Sequences</div>
                <div class="test-result" id="result-ncbi-genbank">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('ncbi-refseq')">
                <div class="menu-title">RefSeq Genomes</div>
                <div class="menu-desc">Download reference genome sequences from NCBI RefSeq</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí NCBI Databases ‚Üí RefSeq Genomes</div>
                <div class="test-result" id="result-ncbi-refseq">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('ncbi-sra')">
                <div class="menu-title">SRA Sequencing Data</div>
                <div class="menu-desc">Search sequencing read archives from NCBI SRA database</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí NCBI Databases ‚Üí SRA Sequencing Data</div>
                <div class="test-result" id="result-ncbi-sra">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('ncbi-assembly')">
                <div class="menu-title">Assembly Data</div>
                <div class="menu-desc">Download genome assembly data from NCBI</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí NCBI Databases ‚Üí Assembly Data</div>
                <div class="test-result" id="result-ncbi-assembly">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>
        </div>

        <h2>üá™üá∫ EMBL-EBI Databases</h2>
        <div class="menu-section">
            <div class="menu-item" onclick="testMenuItem('embl-sequences')">
                <div class="menu-title">EMBL Sequences</div>
                <div class="menu-desc">Search and download sequences from EMBL-EBI database</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí EMBL-EBI Databases ‚Üí EMBL Sequences</div>
                <div class="test-result" id="result-embl-sequences">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('ensembl-genomes')">
                <div class="menu-title">Ensembl Genomes</div>
                <div class="menu-desc">Download genome data from Ensembl</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí EMBL-EBI Databases ‚Üí Ensembl Genomes</div>
                <div class="test-result" id="result-ensembl-genomes">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('ena-archive')">
                <div class="menu-title">ENA Archive</div>
                <div class="menu-desc">European Nucleotide Archive data</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí EMBL-EBI Databases ‚Üí ENA Archive</div>
                <div class="test-result" id="result-ena-archive">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>
        </div>

        <h2>üåê Other Databases</h2>
        <div class="menu-section">
            <div class="menu-item" onclick="testMenuItem('ddbj-sequences')">
                <div class="menu-title">DDBJ Sequences</div>
                <div class="menu-desc">DNA Data Bank of Japan sequences</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí Other Databases ‚Üí DDBJ Sequences</div>
                <div class="test-result" id="result-ddbj-sequences">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('uniprot-proteins')">
                <div class="menu-title">UniProt Proteins</div>
                <div class="menu-desc">Protein sequence and annotation data</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí Other Databases ‚Üí UniProt Proteins</div>
                <div class="test-result" id="result-uniprot-proteins">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>

            <div class="menu-item" onclick="testMenuItem('kegg-pathways')">
                <div class="menu-title">KEGG Pathways</div>
                <div class="menu-desc">KEGG pathway and genome data</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí Other Databases ‚Üí KEGG Pathways</div>
                <div class="test-result" id="result-kegg-pathways">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>
        </div>

        <h2>üì¶ Bulk Download Manager</h2>
        <div class="menu-section">
            <div class="menu-item" onclick="testMenuItem('bulk-manager')">
                <div class="menu-title">Bulk Download Manager</div>
                <div class="menu-desc">Manage multiple downloads and batch operations (Ctrl+Shift+D)</div>
                <div class="menu-path">File ‚Üí Download Genomic Data ‚Üí Bulk Download Manager</div>
                <div class="test-result" id="result-bulk-manager">
                    <span class="status-icon status-pending">‚è≥</span>
                    <span>Not tested</span>
                </div>
            </div>
        </div>

        <h2>üéØ Test Controls</h2>
        <div class="menu-section">
            <button class="btn btn-test" onclick="testAllMenuItems()">üöÄ Test All Menu Items</button>
            <button class="btn btn-reset" onclick="resetAllTests()">üîÑ Reset Test Results</button>
            <button class="btn" onclick="generateTestReport()">üìä Generate Test Report</button>
        </div>

        <div class="test-results" id="testSummary" style="display: none;">
            <h3>üìä Test Summary</h3>
            <div id="summaryContent"></div>
        </div>
    </div>

    <script>
        const menuItems = [
            'ncbi-genbank', 'ncbi-refseq', 'ncbi-sra', 'ncbi-assembly',
            'embl-sequences', 'ensembl-genomes', 'ena-archive',
            'ddbj-sequences', 'uniprot-proteins', 'kegg-pathways',
            'bulk-manager'
        ];

        let testResults = {};
        let testStartTime = null;

        function testMenuItem(itemType) {
            console.log(`üß™ Testing menu item: ${itemType}`);
            
            // Update status to testing
            updateTestResult(itemType, 'testing', 'Testing...');
            
            // Simulate menu item test
            // In a real test, this would trigger the actual menu item
            setTimeout(() => {
                // For this demo, we'll simulate successful tests
                // In reality, you would check if the download window opened without project dialog
                const success = Math.random() > 0.1; // 90% success rate for demo
                
                if (success) {
                    updateTestResult(itemType, 'pass', 'Download window opened successfully');
                } else {
                    updateTestResult(itemType, 'fail', 'Project dialog shown or window failed to open');
                }
                
                updateTestSummary();
            }, 1000 + Math.random() * 2000); // Random delay 1-3 seconds
        }

        function updateTestResult(itemType, status, message) {
            testResults[itemType] = { status, message, timestamp: new Date() };
            
            const resultElement = document.getElementById(`result-${itemType}`);
            if (resultElement) {
                let icon, className;
                switch (status) {
                    case 'pass':
                        icon = '‚úÖ';
                        className = 'status-pass';
                        break;
                    case 'fail':
                        icon = '‚ùå';
                        className = 'status-fail';
                        break;
                    case 'testing':
                        icon = 'üîÑ';
                        className = 'status-pending';
                        break;
                    default:
                        icon = '‚è≥';
                        className = 'status-pending';
                }
                
                resultElement.innerHTML = `
                    <span class="status-icon ${className}">${icon}</span>
                    <span>${message}</span>
                `;
            }
        }

        function testAllMenuItems() {
            console.log('üöÄ Starting comprehensive menu test...');
            testStartTime = new Date();
            
            // Reset all results
            testResults = {};
            
            // Test each item with a delay to avoid overwhelming
            menuItems.forEach((item, index) => {
                setTimeout(() => {
                    testMenuItem(item);
                }, index * 500); // 500ms delay between tests
            });
        }

        function resetAllTests() {
            console.log('üîÑ Resetting all test results...');
            testResults = {};
            testStartTime = null;
            
            menuItems.forEach(item => {
                updateTestResult(item, 'pending', 'Not tested');
            });
            
            document.getElementById('testSummary').style.display = 'none';
        }

        function updateTestSummary() {
            const totalTests = menuItems.length;
            const completedTests = Object.keys(testResults).length;
            const passedTests = Object.values(testResults).filter(r => r.status === 'pass').length;
            const failedTests = Object.values(testResults).filter(r => r.status === 'fail').length;
            
            if (completedTests === totalTests) {
                const summaryElement = document.getElementById('testSummary');
                const contentElement = document.getElementById('summaryContent');
                
                const duration = testStartTime ? Math.round((new Date() - testStartTime) / 1000) : 0;
                const successRate = Math.round((passedTests / totalTests) * 100);
                
                contentElement.innerHTML = `
                    <div class="summary">
                        <h3>Test Completed!</h3>
                        <div class="metric">Total Tests: ${totalTests}</div>
                        <div class="metric">Passed: ${passedTests}</div>
                        <div class="metric">Failed: ${failedTests}</div>
                        <div class="metric">Success Rate: ${successRate}%</div>
                        <div class="metric">Duration: ${duration}s</div>
                    </div>
                `;
                
                summaryElement.style.display = 'block';
                
                // Log detailed results
                console.log('üìä Test Summary:', {
                    total: totalTests,
                    passed: passedTests,
                    failed: failedTests,
                    successRate: successRate + '%',
                    duration: duration + 's',
                    results: testResults
                });
            }
        }

        function generateTestReport() {
            console.log('üìä Generating detailed test report...');
            
            const report = {
                timestamp: new Date().toISOString(),
                testSuite: 'Download Genomic Data Menu Functionality',
                totalTests: menuItems.length,
                results: testResults,
                summary: {
                    passed: Object.values(testResults).filter(r => r.status === 'pass').length,
                    failed: Object.values(testResults).filter(r => r.status === 'fail').length,
                    pending: menuItems.length - Object.keys(testResults).length
                }
            };
            
            // In a real test environment, this would save the report
            console.log('üìã Test Report Generated:', report);
            
            // Display report in console for now
            console.table(Object.entries(testResults).map(([item, result]) => ({
                MenuItem: item,
                Status: result.status,
                Message: result.message,
                Timestamp: result.timestamp.toLocaleTimeString()
            })));
            
            alert(`Test report generated! Check console for details.\n\nSummary:\n‚úÖ Passed: ${report.summary.passed}\n‚ùå Failed: ${report.summary.failed}\n‚è≥ Pending: ${report.summary.pending}`);
        }

        // Initialize test results on page load
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üß¨ Download Menu Functionality Test Page Loaded');
            resetAllTests();
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch (e.key) {
                        case 't':
                            e.preventDefault();
                            testAllMenuItems();
                            break;
                        case 'r':
                            e.preventDefault();
                            resetAllTests();
                            break;
                    }
                }
            });
            
            console.log('‚å®Ô∏è Keyboard shortcuts: Ctrl+T (test all), Ctrl+R (reset)');
        });
    </script>
</body>
</html> 