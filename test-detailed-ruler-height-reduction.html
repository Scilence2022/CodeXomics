<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二级标尺内部绘图高度调整测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: #fafafa;
        }
        
        .ruler-demo {
            margin: 10px 0;
            position: relative;
        }
        
        .detailed-ruler-container {
            position: relative;
            height: 35px;
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 0px;
            z-index: 10;
            overflow: visible;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .detailed-ruler-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 11;
        }
        
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .demo-label {
            font-weight: bold;
            margin-bottom: 10px;
            padding: 8px;
            background: #e3f2fd;
            border-radius: 4px;
            text-align: center;
        }
        
        .old-style {
            background: #ffebee;
        }
        
        .new-style {
            background: #e8f5e8;
        }
        
        .info-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .changes-list {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
        }
        
        .changes-list ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .changes-list li {
            margin: 8px 0;
        }
        
        .test-instructions {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .test-instructions h4 {
            margin-top: 0;
            color: #0056b3;
        }
        
        .test-instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .test-instructions li {
            margin: 8px 0;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔧 二级标尺内部绘图高度调整测试</h1>
        
        <div class="info-box">
            <h3>📋 修改说明</h3>
            <p>本次修改调整了基因组浏览器中二级标尺（详细标尺）的内部绘图高度，使其在保持35px容器高度不变的情况下，内部元素占用更少的垂直空间，视觉效果更加紧凑。</p>
        </div>
        
        <div class="changes-list">
            <h4>🎯 具体改动项目：</h4>
            <ul>
                <li><strong>字体大小：</strong>从 11px 减小到 10px</li>
                <li><strong>主要刻度线：</strong>从 0-22px 调整为 3-19px（高度从22px减少到16px）</li>
                <li><strong>次要刻度线：</strong>从 0-10px 调整为 3-10px（高度从10px减少到7px）</li>
                <li><strong>标签位置：</strong>从 y=32 上移到 y=28</li>
                <li><strong>整体效果：</strong>内部绘图在35px容器内更加紧凑，留出更多空白空间</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h3>📊 视觉对比演示</h3>
            <div class="before-after">
                <div>
                    <div class="demo-label old-style">修改前 - 原始高度</div>
                    <div class="ruler-demo">
                        <canvas id="oldRuler" width="500" height="35" class="detailed-ruler-canvas"></canvas>
                    </div>
                    <p><small>刻度线较长，字体较大，整体占用更多垂直空间</small></p>
                </div>
                
                <div>
                    <div class="demo-label new-style">修改后 - 紧凑高度</div>
                    <div class="ruler-demo">
                        <canvas id="newRuler" width="500" height="35" class="detailed-ruler-canvas"></canvas>
                    </div>
                    <p><small>刻度线较短，字体较小，整体更加紧凑</small></p>
                </div>
            </div>
        </div>
        
        <div class="test-instructions">
            <h4>🧪 测试指南</h4>
            <ol>
                <li>打开 GenomeExplorer 应用程序</li>
                <li>加载任意基因组文件（FASTA、GenBank等）</li>
                <li>在基因组浏览器中打开基因轨道（Gene Track）</li>
                <li>观察基因轨道上方的二级标尺（详细标尺）</li>
                <li><strong>检查要点：</strong>
                    <ul>
                        <li>标尺容器高度仍为35px（未改变）</li>
                        <li>刻度线高度明显减少，更加紧凑</li>
                        <li>标签字体稍小，位置略有上移</li>
                        <li>整体视觉效果更加精简</li>
                        <li>功能完全正常，所有交互保持不变</li>
                    </ul>
                </li>
                <li>缩放基因组视图，验证标尺在不同尺度下的显示效果</li>
                <li>拖拽浏览器窗口大小，确认标尺响应式调整正常</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>✅ 预期效果</h3>
            <ul>
                <li>二级标尺外观更加紧凑，减少视觉干扰</li>
                <li>基因轨道与标尺之间的视觉平衡更好</li>
                <li>保持所有原有功能和交互特性</li>
                <li>在不同设备和分辨率下表现一致</li>
                <li>与整体UI风格更加协调</li>
            </ul>
        </div>
        
        <div class="info-box">
            <h4>🔍 技术细节</h4>
            <p><strong>修改文件：</strong> <code>src/renderer/modules/TrackRenderer.js</code></p>
            <p><strong>修改方法：</strong> <code>drawDetailedRuler(ctx, width, chromosome)</code></p>
            <p><strong>设计原则：</strong> 在不改变容器尺寸的前提下，优化内部绘图元素的空间利用，实现更紧凑的视觉效果。</p>
        </div>
    </div>
    
    <script>
        // 绘制修改前的标尺样式
        function drawOldRuler() {
            const canvas = document.getElementById('oldRuler');
            const ctx = canvas.getContext('2d');
            const width = 500;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, 35);
            
            // Fill background
            const gradient = ctx.createLinearGradient(0, 0, 0, 35);
            gradient.addColorStop(0, '#f8f9fa');
            gradient.addColorStop(1, '#e9ecef');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, 35);
            
            // 原始样式设置
            ctx.strokeStyle = '#6c757d';
            ctx.fillStyle = '#495057';
            ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // 绘制主要刻度线（原始高度）
            for (let i = 0; i <= 10; i++) {
                const x = i * 50;
                ctx.beginPath();
                ctx.moveTo(x, 0);  // 原始：从0开始
                ctx.lineTo(x, 22); // 原始：到22结束
                ctx.stroke();
                
                // 标签（原始位置）
                ctx.fillText((i * 1000).toString(), x, 32); // 原始：y=32
            }
            
            // 绘制次要刻度线（原始高度）
            ctx.strokeStyle = '#adb5bd';
            for (let i = 0; i < 10; i++) {
                for (let j = 1; j < 5; j++) {
                    const x = i * 50 + j * 10;
                    ctx.beginPath();
                    ctx.moveTo(x, 0);  // 原始：从0开始
                    ctx.lineTo(x, 10); // 原始：到10结束
                    ctx.stroke();
                }
            }
            
            // 绘制边框
            ctx.strokeStyle = '#dee2e6';
            ctx.beginPath();
            ctx.moveTo(0, 34.5);
            ctx.lineTo(width, 34.5);
            ctx.stroke();
        }
        
        // 绘制修改后的标尺样式
        function drawNewRuler() {
            const canvas = document.getElementById('newRuler');
            const ctx = canvas.getContext('2d');
            const width = 500;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, 35);
            
            // Fill background
            const gradient = ctx.createLinearGradient(0, 0, 0, 35);
            gradient.addColorStop(0, '#f8f9fa');
            gradient.addColorStop(1, '#e9ecef');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, 35);
            
            // 新样式设置
            ctx.strokeStyle = '#6c757d';
            ctx.fillStyle = '#495057';
            ctx.font = '10px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'; // 新：10px
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // 绘制主要刻度线（新高度）
            for (let i = 0; i <= 10; i++) {
                const x = i * 50;
                ctx.beginPath();
                ctx.moveTo(x, 3);  // 新：从3开始
                ctx.lineTo(x, 19); // 新：到19结束
                ctx.stroke();
                
                // 标签（新位置）
                ctx.fillText((i * 1000).toString(), x, 28); // 新：y=28
            }
            
            // 绘制次要刻度线（新高度）
            ctx.strokeStyle = '#adb5bd';
            for (let i = 0; i < 10; i++) {
                for (let j = 1; j < 5; j++) {
                    const x = i * 50 + j * 10;
                    ctx.beginPath();
                    ctx.moveTo(x, 3);  // 新：从3开始
                    ctx.lineTo(x, 10); // 新：到10结束（高度从10减少到7）
                    ctx.stroke();
                }
            }
            
            // 绘制边框
            ctx.strokeStyle = '#dee2e6';
            ctx.beginPath();
            ctx.moveTo(0, 34.5);
            ctx.lineTo(width, 34.5);
            ctx.stroke();
        }
        
        // 页面加载后绘制对比图
        window.addEventListener('load', () => {
            drawOldRuler();
            drawNewRuler();
        });
    </script>
</body>
</html> 