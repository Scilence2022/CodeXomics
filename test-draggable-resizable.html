<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Draggable and Resizable Modals</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        
        .test-controls {
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-btn {
            margin: 5px;
            padding: 10px 15px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .test-btn:hover {
            background: #005999;
        }
        
        .test-log {
            margin-top: 20px;
            padding: 15px;
            background: #1e1e1e;
            color: #f0f0f0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            height: 200px;
            overflow-y: auto;
        }
        
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .info { color: #60a5fa; }
        .warning { color: #fbbf24; }
    </style>
</head>
<body>
    <h1>🧪 Draggable and Resizable Modal Test</h1>
    
    <div class="test-controls">
        <h3>Test Controls</h3>
        <button class="test-btn" onclick="testGeneralSettings()">Test General Settings Modal</button>
        <button class="test-btn" onclick="testActionList()">Test Action List Modal</button>
        <button class="test-btn" onclick="runAllTests()">Run All Tests</button>
        <button class="test-btn" onclick="clearLog()">Clear Log</button>
    </div>
    
    <div class="test-log" id="testLog"></div>
    
    <script>
        // Load the main application files for testing
        const script1 = document.createElement('script');
        script1.src = 'src/renderer/modules/GeneralSettingsManager.js';
        document.head.appendChild(script1);
        
        const script2 = document.createElement('script');
        script2.src = 'src/renderer/modules/ActionManager.js';
        document.head.appendChild(script2);
        
        // Load CSS
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'src/renderer/styles.css';
        document.head.appendChild(link);
        
        // Test logging
        function log(message, type = 'info') {
            const logElement = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            const logEntry = `<div class="${className}">[${timestamp}] ${message}</div>`;
            logElement.innerHTML += logEntry;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearLog() {
            document.getElementById('testLog').innerHTML = '';
        }
        
        // Test functions
        function testGeneralSettings() {
            log('🔄 Testing General Settings Modal...', 'info');
            
            try {
                // Create a mock General Settings modal for testing
                const modal = createMockGeneralSettingsModal();
                document.body.appendChild(modal);
                
                // Test draggable functionality
                const header = modal.querySelector('.draggable-header');
                if (header) {
                    log('✅ Draggable header found', 'success');
                    
                    // Simulate mouse events
                    const mouseDown = new MouseEvent('mousedown', {
                        clientX: 100,
                        clientY: 100,
                        bubbles: true
                    });
                    header.dispatchEvent(mouseDown);
                    log('✅ Mouse down event dispatched on header', 'success');
                } else {
                    log('❌ Draggable header not found', 'error');
                }
                
                // Test resizable handles
                const handles = modal.querySelectorAll('.resize-handle');
                if (handles.length > 0) {
                    log(`✅ Found ${handles.length} resize handles`, 'success');
                    handles.forEach((handle, index) => {
                        const className = handle.className;
                        log(`  - Handle ${index + 1}: ${className}`, 'info');
                    });
                } else {
                    log('❌ No resize handles found', 'error');
                }
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(modal);
                    log('🧹 Test modal cleaned up', 'info');
                }, 2000);
                
                log('✅ General Settings modal test completed', 'success');
                
            } catch (error) {
                log(`❌ Error testing General Settings: ${error.message}`, 'error');
            }
        }
        
        function testActionList() {
            log('🔄 Testing Action List Modal...', 'info');
            
            try {
                // Create a mock Action List modal for testing
                const modal = createMockActionListModal();
                document.body.appendChild(modal);
                
                // Test draggable functionality
                const header = modal.querySelector('.draggable-header');
                if (header) {
                    log('✅ Draggable header found', 'success');
                } else {
                    log('❌ Draggable header not found', 'error');
                }
                
                // Test resizable handles
                const handles = modal.querySelectorAll('.resize-handle');
                if (handles.length > 0) {
                    log(`✅ Found ${handles.length} resize handles`, 'success');
                } else {
                    log('❌ No resize handles found', 'error');
                }
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(modal);
                    log('🧹 Test modal cleaned up', 'info');
                }, 2000);
                
                log('✅ Action List modal test completed', 'success');
                
            } catch (error) {
                log(`❌ Error testing Action List: ${error.message}`, 'error');
            }
        }
        
        function runAllTests() {
            log('🚀 Running all draggable/resizable tests...', 'info');
            clearLog();
            
            setTimeout(() => testGeneralSettings(), 100);
            setTimeout(() => testActionList(), 1500);
            setTimeout(() => {
                log('✅ All tests completed!', 'success');
                log('📋 Summary: Check above for any errors', 'info');
            }, 3000);
        }
        
        // Mock modal creation functions
        function createMockGeneralSettingsModal() {
            const modal = document.createElement('div');
            modal.id = 'generalSettingsModal';
            modal.className = 'modal draggable-modal';
            modal.style.display = 'block';
            modal.style.position = 'fixed';
            modal.style.top = '50px';
            modal.style.left = '50px';
            modal.style.zIndex = '9999';
            
            modal.innerHTML = `
                <div class="modal-content resizable-modal-content">
                    <div class="modal-header draggable-header">
                        <h2>General Settings (Test)</h2>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>This is a test modal for draggable and resizable functionality.</p>
                        <p>Try dragging the header and resizing using the handles.</p>
                    </div>
                    
                    <!-- Resize handles -->
                    <div class="resize-handle resize-handle-n"></div>
                    <div class="resize-handle resize-handle-s"></div>
                    <div class="resize-handle resize-handle-e"></div>
                    <div class="resize-handle resize-handle-w"></div>
                    <div class="resize-handle resize-handle-ne"></div>
                    <div class="resize-handle resize-handle-nw"></div>
                    <div class="resize-handle resize-handle-se"></div>
                    <div class="resize-handle resize-handle-sw"></div>
                </div>
            `;
            
            return modal;
        }
        
        function createMockActionListModal() {
            const modal = document.createElement('div');
            modal.id = 'actionListModal';
            modal.className = 'modal draggable-modal';
            modal.style.display = 'block';
            modal.style.position = 'fixed';
            modal.style.top = '100px';
            modal.style.left = '100px';
            modal.style.zIndex = '9999';
            
            modal.innerHTML = `
                <div class="modal-content resizable-modal-content">
                    <div class="modal-header draggable-header">
                        <h2>Action List Manager (Test)</h2>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>This is a test modal for draggable and resizable functionality.</p>
                        <p>Try dragging the header and resizing using the handles.</p>
                    </div>
                    
                    <!-- Resize handles -->
                    <div class="resize-handle resize-handle-n"></div>
                    <div class="resize-handle resize-handle-s"></div>
                    <div class="resize-handle resize-handle-e"></div>
                    <div class="resize-handle resize-handle-w"></div>
                    <div class="resize-handle resize-handle-ne"></div>
                    <div class="resize-handle resize-handle-nw"></div>
                    <div class="resize-handle resize-handle-se"></div>
                    <div class="resize-handle resize-handle-sw"></div>
                </div>
            `;
            
            return modal;
        }
        
        // Initialize tests when page loads
        window.addEventListener('load', () => {
            log('🎯 Draggable/Resizable Test Suite Loaded', 'success');
            log('📋 Click the test buttons above to validate functionality', 'info');
        });
    </script>
</body>
</html>