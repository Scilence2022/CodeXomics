<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evo2 API Endpoint Tester</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
        .code { background: #f8f9fa; padding: 10px; font-family: monospace; border: 1px solid #e9ecef; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß¨ Evo2 API Endpoint Tester</h1>
        <p>This tool helps debug and test the correct NVIDIA Evo2 API endpoint structure.</p>
        
        <div class="test-section">
            <h3>API Configuration</h3>
            <label>API Key:</label>
            <input type="password" id="apiKey" placeholder="nvapi-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
            <button onclick="toggleKeyVisibility()">Show/Hide Key</button>
            
            <label>Base URL (optional):</label>
            <input type="text" id="baseUrl" value="https://integrate.api.nvidia.com" placeholder="https://integrate.api.nvidia.com">
        </div>

        <div class="test-section">
            <h3>‚ö†Ô∏è Important Notice</h3>
            <div class="result info">
                <strong>NVIDIA NIM API Requirements:</strong><br>
                Based on recent findings, NVIDIA Evo2 may require their proprietary SDK (<code>@api/nim</code>) rather than direct REST calls.<br><br>
                <strong>If all endpoints return 404:</strong><br>
                1. The API likely requires Node.js SDK integration<br>
                2. Direct HTTP calls may not be supported<br>
                3. Consider using simulation mode for browser-based testing<br><br>
                <strong>For production use:</strong> Install the SDK with <code>npx api install "@nim/v1.0#11azas1wm7c3eqdn"</code>
            </div>
        </div>
            <button onclick="testAllEndpoints()">Test All Possible Endpoints</button>
            <button onclick="testSpecificEndpoint()">Test Custom Endpoint</button>
            
            <label>Custom Endpoint:</label>
            <input type="text" id="customEndpoint" placeholder="/v1/chat/completions">
        </div>

        <div class="test-section">
            <h3>Test Results</h3>
            <div id="results"></div>
        </div>
    </div>

    <script>
        function addResult(message, type = 'info') {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message;
            resultsDiv.appendChild(resultDiv);
        }

        function toggleKeyVisibility() {
            const keyInput = document.getElementById('apiKey');
            keyInput.type = keyInput.type === 'password' ? 'text' : 'password';
        }

        async function testAllEndpoints() {
            const apiKey = document.getElementById('apiKey').value;
            const baseUrl = document.getElementById('baseUrl').value || 'https://integrate.api.nvidia.com';
            
            if (!apiKey) {
                addResult('‚ùå Please enter your NVIDIA API key first', 'error');
                return;
            }

            document.getElementById('results').innerHTML = '';
            addResult('üîç Testing multiple endpoint configurations...', 'info');

            const testData = {
                text_input: 'ATGAAGTCG',
                num_tokens: 10,
                temperature: 0.7,
                top_p: 1,
                top_k: 3,
                enable_logits: false,
                enable_sampled_probs: false,
                enable_elapsed_ms_per_token: false
            };

            const endpointsToTest = [
                // NVIDIA NIM API endpoints based on sample code
                { url: `${baseUrl}/v1/models/nvidia/arc/evo2-40b/generate`, description: 'NIM Models Generate Endpoint' },
                { url: `${baseUrl}/nvidia/arc/evo2-40b/generate`, description: 'Direct Model Generate' },
                { url: `https://api.nvidia.com/v1/models/nvidia/arc/evo2-40b/generate`, description: 'Official API Generate' },
                { url: `${baseUrl}/v1/chat/completions`, description: 'Legacy Chat Completions (for comparison)' },
                { url: `${baseUrl}/api/v1/generate`, description: 'API Generate Endpoint' }
            ];

            for (const endpoint of endpointsToTest) {
                await testSingleEndpoint(endpoint.url, endpoint.description, testData, apiKey);
            }
        }

        async function testSingleEndpoint(url, description, data, apiKey) {
            try {
                addResult(`üîç Testing: ${description}<br><code>${url}</code>`, 'info');

                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const responseText = await response.text();
                let responseData;
                
                try {
                    responseData = JSON.parse(responseText);
                } catch {
                    responseData = { rawResponse: responseText };
                }

                if (response.ok) {
                    addResult(`‚úÖ SUCCESS: ${description}<br>Status: ${response.status}<br>Response: ${JSON.stringify(responseData, null, 2).substring(0, 200)}...`, 'success');
                } else {
                    addResult(`‚ùå FAILED: ${description}<br>Status: ${response.status} ${response.statusText}<br>Error: ${responseText.substring(0, 300)}...`, 'error');
                }

            } catch (error) {
                addResult(`‚ùå ERROR: ${description}<br>Network/Fetch Error: ${error.message}`, 'error');
            }
        }

        async function testSpecificEndpoint() {
            const apiKey = document.getElementById('apiKey').value;
            const baseUrl = document.getElementById('baseUrl').value || 'https://integrate.api.nvidia.com';
            const customEndpoint = document.getElementById('customEndpoint').value || '/v1/chat/completions';
            
            if (!apiKey) {
                addResult('‚ùå Please enter your NVIDIA API key first', 'error');
                return;
            }

            const testData = {
                text_input: 'ATGAAGTCG',
                num_tokens: 10,
                temperature: 0.7,
                top_p: 1,
                top_k: 3,
                enable_logits: false,
                enable_sampled_probs: false,
                enable_elapsed_ms_per_token: false
            };

            const fullUrl = `${baseUrl}${customEndpoint}`;
            await testSingleEndpoint(fullUrl, 'Custom endpoint', testData, apiKey);
        }

        // Auto-fill API key from localStorage if available
        document.addEventListener('DOMContentLoaded', function() {
            const savedKey = localStorage.getItem('evo2_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
                addResult('üîë API key loaded from localStorage', 'info');
            }
        });
    </script>
</body>
</html>