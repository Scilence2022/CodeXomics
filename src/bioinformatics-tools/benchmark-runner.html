<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Instruction Following Benchmark - Genome AI Studio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            height: 100vh;
            overflow: hidden;
        }

        /* Menu Bar Styles */
        .menu-bar {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 0;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            height: 40px;
            position: relative;
            z-index: 1000;
        }

        .menu-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.3s ease;
            position: relative;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .menu-item:hover {
            background: rgba(52, 152, 219, 0.3);
        }

        .menu-item.active {
            background: rgba(52, 152, 219, 0.5);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 0 0 5px 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: none;
            min-width: 200px;
            z-index: 1001;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            color: #333;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s ease;
        }

        .dropdown-item:hover {
            background: #f8f9fa;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-separator {
            height: 1px;
            background: #e9ecef;
            margin: 5px 0;
        }

        .dropdown-item.disabled {
            color: #6c757d;
            cursor: not-allowed;
        }

        .dropdown-item.disabled:hover {
            background: none;
        }

        /* Main Content */
        .main-container {
            height: calc(100vh - 40px);
            display: flex;
            flex-direction: column;
        }

        .benchmark-header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 30px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .benchmark-header h1 {
            color: #2c3e50;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .benchmark-subtitle {
            color: #6c757d;
            font-size: 14px;
        }

        .benchmark-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        /* Configuration Panel */
        .config-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 25px;
        }

        .config-group h3 {
            color: #34495e;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 13px;
            color: #495057;
        }

        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #3498db;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-size: 13px;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select {
            padding: 8px 12px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 13px;
            background: white;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        /* Progress Panel */
        .progress-container {
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db 0%, #27ae60 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 4px;
            font-size: 13px;
        }

        .progress-label {
            color: #6c757d;
            font-weight: 500;
        }

        .progress-value {
            color: #2c3e50;
            font-weight: 600;
        }

        /* Results Panel */
        .results-tabs {
            display: flex;
            border-bottom: 2px solid #e1e8ed;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 10px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            color: #3498db;
        }

        .tab-button.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-content {
            min-height: 300px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Status Bar */
        .status-bar {
            background: #2c3e50;
            color: white;
            padding: 8px 20px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #27ae60;
        }

        .status-indicator.warning {
            background: #f39c12;
        }

        .status-indicator.error {
            background: #e74c3c;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .config-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .progress-info {
                grid-template-columns: 1fr;
            }
        }

        /* Hide elements initially */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Menu Bar -->
    <div class="menu-bar">
        <div class="menu-item" data-menu="file">
            File
            <div class="dropdown-menu" id="fileMenu">
                <div class="dropdown-item" onclick="benchmarkApp.newBenchmark()">
                    <span>üÜï New Benchmark</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.openBenchmark()">
                    <span>üìÇ Open Benchmark Results</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.saveBenchmark()">
                    <span>üíæ Save Results</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.saveAsReport()">
                    <span>üìä Save as Report</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.exportResults()">
                    <span>üì§ Export Results</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.closeWindow()">
                    <span>‚ùå Close</span>
                </div>
            </div>
        </div>

        <div class="menu-item" data-menu="edit">
            Edit
            <div class="dropdown-menu" id="editMenu">
                <div class="dropdown-item" onclick="benchmarkApp.copyResults()">
                    <span>üìã Copy Results</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.copySelectedTest()">
                    <span>üìÑ Copy Selected Test</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.selectAllTests()">
                    <span>üéØ Select All Tests</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.selectFailedTests()">
                    <span>‚ùå Select Failed Tests</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.selectPassedTests()">
                    <span>‚úÖ Select Passed Tests</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.clearSelection()">
                    <span>üîÑ Clear Selection</span>
                </div>
            </div>
        </div>

        <div class="menu-item" data-menu="view">
            View
            <div class="dropdown-menu" id="viewMenu">
                <div class="dropdown-item" onclick="benchmarkApp.showOverview()">
                    <span>üìä Overview</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.showDetailedResults()">
                    <span>üìã Detailed Results</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.showStatistics()">
                    <span>üìà Statistics</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.showCharts()">
                    <span>üìä Charts</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.showErrorAnalysis()">
                    <span>üîç Error Analysis</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.showPerformanceAnalysis()">
                    <span>‚ö° Performance Analysis</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.toggleFullscreen()">
                    <span>üñ•Ô∏è Toggle Fullscreen</span>
                </div>
            </div>
        </div>

        <div class="menu-item" data-menu="benchmark">
            Benchmark
            <div class="dropdown-menu" id="benchmarkMenu">
                <div class="dropdown-item" onclick="benchmarkApp.runQuickBenchmark()">
                    <span>‚ö° Quick Benchmark</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.runFullBenchmark()">
                    <span>üß™ Full Benchmark</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.runCustomBenchmark()">
                    <span>‚öôÔ∏è Custom Benchmark</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.runBasicOperationsTest()">
                    <span>‚úÇÔ∏è Basic Operations Test</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.runEditOperationsTest()">
                    <span>üìù Edit Operations Test</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.stopBenchmark()" id="stopBenchmarkMenu" class="disabled">
                    <span>‚èπÔ∏è Stop Benchmark</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.pauseBenchmark()" id="pauseBenchmarkMenu" class="disabled">
                    <span>‚è∏Ô∏è Pause Benchmark</span>
                </div>
            </div>
        </div>

        <div class="menu-item" data-menu="tools">
            Tools
            <div class="dropdown-menu" id="toolsMenu">
                <div class="dropdown-item" onclick="benchmarkApp.validateConfiguration()">
                    <span>üîß Validate Configuration</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.testLLMConnection()">
                    <span>üîó Test LLM Connection</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.clearHistory()">
                    <span>üóëÔ∏è Clear History</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.resetSettings()">
                    <span>üîÑ Reset Settings</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.openDebugConsole()">
                    <span>üêõ Debug Console</span>
                </div>
            </div>
        </div>

        <div class="menu-item" data-menu="help">
            Help
            <div class="dropdown-menu" id="helpMenu">
                <div class="dropdown-item" onclick="benchmarkApp.showDocumentation()">
                    <span>üìö Documentation</span>
                </div>
                <div class="dropdown-item" onclick="benchmarkApp.showTestGuide()">
                    <span>üìñ Test Guide</span>
                </div>
                <div class="dropdown-separator"></div>
                <div class="dropdown-item" onclick="benchmarkApp.showAbout()">
                    <span>‚ÑπÔ∏è About</span>
                </div>
            </div>
        </div>

        <!-- Window Controls -->
        <div style="margin-left: auto; display: flex; gap: 10px; padding-right: 15px;">
            <span id="connectionStatus" class="status-item">
                <span class="status-indicator" id="statusIndicator"></span>
                <span id="statusText">Ready</span>
            </span>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Header -->
        <div class="benchmark-header">
            <h1>üß™ LLM Instruction Following Benchmark</h1>
            <div class="benchmark-subtitle">Comprehensive testing of LLM instruction following capabilities</div>
        </div>

        <!-- Content -->
        <div class="benchmark-content">
            <!-- Configuration Section -->
            <div class="section" id="configSection">
                <h2>‚öôÔ∏è Configuration</h2>
                <div class="config-grid">
                    <div class="config-group">
                        <h3>Test Suites</h3>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="suite-basic_operations" checked> Basic Operations (Copy/Paste/Select)</label>
                            <label><input type="checkbox" id="suite-edit_operations" checked> Edit Operations (Comprehensive)</label>
                            <label><input type="checkbox" id="suite-basic_functions" checked> Basic Functions</label>
                            <label><input type="checkbox" id="suite-complex_analysis"> Complex Analysis</label>
                            <label><input type="checkbox" id="suite-plugin_integration"> Plugin Integration</label>
                            <label><input type="checkbox" id="suite-parameter_handling" checked> Parameter Handling</label>
                            <label><input type="checkbox" id="suite-error_recovery"> Error Recovery</label>
                            <label><input type="checkbox" id="suite-workflow_tests"> Workflow Tests</label>
                            <label><input type="checkbox" id="suite-contextual_understanding"> Contextual Understanding</label>
                            <label><input type="checkbox" id="suite-edge_cases"> Edge Cases</label>
                            <label><input type="checkbox" id="suite-performance_tests" checked> Performance Tests</label>
                            <label><input type="checkbox" id="suite-consistency_tests"> Consistency Tests</label>
                        </div>
                    </div>
                    <div class="config-group">
                        <h3>Options</h3>
                        <div class="form-group">
                            <label><input type="checkbox" id="generateReport" checked> Generate Report</label>
                            <label><input type="checkbox" id="includeCharts" checked> Include Charts</label>
                            <label><input type="checkbox" id="includeRawData"> Include Raw Data</label>
                            <label><input type="checkbox" id="stopOnError"> Stop on Error</label>
                            <label><input type="checkbox" id="verboseLogging"> Verbose Logging</label>
                        </div>
                    </div>
                    <div class="config-group">
                        <h3>Settings</h3>
                        <div class="form-group">
                            <label>Test Timeout:</label>
                            <select id="testTimeout">
                                <option value="15000">15 seconds</option>
                                <option value="30000" selected>30 seconds</option>
                                <option value="60000">60 seconds</option>
                                <option value="120000">120 seconds</option>
                            </select>
                            
                            <label>Concurrency:</label>
                            <select id="concurrency">
                                <option value="1" selected>Sequential</option>
                                <option value="2">2 parallel tests</option>
                                <option value="3">3 parallel tests</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn btn-primary" onclick="benchmarkApp.startBenchmark()" id="startBtn">
                        <span>‚ñ∂Ô∏è</span> Start Benchmark
                    </button>
                    <button class="btn btn-secondary" onclick="benchmarkApp.stopBenchmark()" id="stopBtn" disabled>
                        <span>‚èπÔ∏è</span> Stop
                    </button>
                    <button class="btn btn-success" onclick="benchmarkApp.exportResults()" id="exportBtn" disabled>
                        <span>üìä</span> Export Results
                    </button>
                </div>
            </div>

            <!-- Progress Section -->
            <div class="section hidden" id="progressSection">
                <h2>üìä Progress</h2>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-info">
                        <div class="progress-item">
                            <span class="progress-label">Current Suite:</span>
                            <span class="progress-value" id="currentSuite">-</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Current Test:</span>
                            <span class="progress-value" id="currentTest">-</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Completed:</span>
                            <span class="progress-value" id="completedTests">0</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Passed:</span>
                            <span class="progress-value" id="passedTests">0</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Failed:</span>
                            <span class="progress-value" id="failedTests">0</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">Elapsed:</span>
                            <span class="progress-value" id="elapsedTime">00:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="section hidden" id="resultsSection">
                <h2>üìà Results</h2>
                <div class="results-tabs">
                    <button class="tab-button active" data-tab="overview">Overview</button>
                    <button class="tab-button" data-tab="suites">Test Suites</button>
                    <button class="tab-button" data-tab="operations">Edit Operations</button>
                    <button class="tab-button" data-tab="statistics">Statistics</button>
                    <button class="tab-button" data-tab="errors">Errors</button>
                    <button class="tab-button" data-tab="charts">Charts</button>
                </div>
                <div class="tab-content">
                    <div class="tab-pane active" id="tab-overview"></div>
                    <div class="tab-pane" id="tab-suites"></div>
                    <div class="tab-pane" id="tab-operations"></div>
                    <div class="tab-pane" id="tab-statistics"></div>
                    <div class="tab-pane" id="tab-errors"></div>
                    <div class="tab-pane" id="tab-charts"></div>
                </div>
            </div>

            <!-- History Section -->
            <div class="section" id="historySection">
                <h2>üìö History</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <button class="btn btn-secondary" onclick="benchmarkApp.refreshHistory()">
                            <span>üîÑ</span> Refresh
                        </button>
                        <button class="btn btn-secondary" onclick="benchmarkApp.clearHistory()">
                            <span>üóëÔ∏è</span> Clear History
                        </button>
                    </div>
                    <div>
                        <button class="btn btn-primary" onclick="benchmarkApp.exportHistory()">
                            <span>üì§</span> Export History
                        </button>
                    </div>
                </div>
                <div id="historyList"></div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item">
            <span class="status-indicator" id="systemStatus"></span>
            <span id="systemStatusText">System Ready</span>
        </div>
        <div class="status-item">
            <span id="testCount">0 tests loaded</span>
        </div>
        <div class="status-item">
            <span id="timeStamp"></span>
        </div>
    </div>

    <script>
        class BenchmarkApp {
            constructor() {
                this.isRunning = false;
                this.currentResults = null;
                this.benchmarkManager = null;
                this.startTime = null;
                this.timer = null;
                
                this.initializeApp();
                this.setupEventListeners();
                this.updateTimeStamp();
            }

            async initializeApp() {
                try {
                    // Get benchmark manager from parent window
                    if (window.opener && window.opener.app) {
                        console.log('üîó Connecting to parent application...');
                        this.benchmarkManager = await window.opener.app.initializeBenchmarkSystemOnDemand();
                        
                        if (this.benchmarkManager) {
                            this.updateSystemStatus('ready', 'System Ready');
                            this.updateTestCount();
                            console.log('‚úÖ Benchmark system connected successfully');
                        } else {
                            throw new Error('Failed to initialize benchmark system');
                        }
                    } else {
                        throw new Error('Parent application not available');
                    }
                } catch (error) {
                    console.error('‚ùå Failed to initialize benchmark app:', error);
                    this.updateSystemStatus('error', 'Initialization Failed');
                    alert('Failed to initialize benchmark system: ' + error.message);
                }
            }

            setupEventListeners() {
                // Menu dropdown handling
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleMenu(item);
                    });
                });

                // Close dropdowns when clicking outside
                document.addEventListener('click', () => {
                    this.closeAllMenus();
                });

                // Tab switching
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.switchTab(btn.dataset.tab);
                    });
                });

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    this.handleKeyboardShortcuts(e);
                });

                // Update timestamp every second
                setInterval(() => this.updateTimeStamp(), 1000);
            }

            toggleMenu(menuItem) {
                const menuData = menuItem.dataset.menu;
                const dropdown = document.getElementById(menuData + 'Menu');
                
                // Close other menus
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    if (menu !== dropdown) {
                        menu.classList.remove('show');
                    }
                });
                
                document.querySelectorAll('.menu-item').forEach(item => {
                    if (item !== menuItem) {
                        item.classList.remove('active');
                    }
                });

                // Toggle current menu
                dropdown.classList.toggle('show');
                menuItem.classList.toggle('active');
            }

            closeAllMenus() {
                document.querySelectorAll('.dropdown-menu').forEach(menu => {
                    menu.classList.remove('show');
                });
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });
            }

            handleKeyboardShortcuts(e) {
                const isCtrlOrCmd = e.ctrlKey || e.metaKey;
                
                if (isCtrlOrCmd) {
                    switch (e.key) {
                        case 'n':
                            e.preventDefault();
                            this.newBenchmark();
                            break;
                        case 's':
                            e.preventDefault();
                            this.saveBenchmark();
                            break;
                        case 'o':
                            e.preventDefault();
                            this.openBenchmark();
                            break;
                        case 'c':
                            e.preventDefault();
                            this.copyResults();
                            break;
                        case 'a':
                            e.preventDefault();
                            this.selectAllTests();
                            break;
                        case 'r':
                            e.preventDefault();
                            this.runQuickBenchmark();
                            break;
                    }
                }
                
                if (e.key === 'F11') {
                    e.preventDefault();
                    this.toggleFullscreen();
                }
            }

            // Menu Actions Implementation

            // File Menu
            newBenchmark() {
                if (this.isRunning) {
                    if (!confirm('A benchmark is currently running. Stop it and create a new benchmark?')) {
                        return;
                    }
                    this.stopBenchmark();
                }
                
                // Reset UI to initial state
                document.getElementById('configSection').classList.remove('hidden');
                document.getElementById('progressSection').classList.add('hidden');
                document.getElementById('resultsSection').classList.add('hidden');
                
                // Reset form
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                    cb.checked = cb.id.includes('basic_operations') || 
                                cb.id.includes('edit_operations') ||
                                cb.id.includes('basic_functions') || 
                                cb.id.includes('parameter_handling') ||
                                cb.id.includes('performance_tests') ||
                                cb.id === 'generateReport' ||
                                cb.id === 'includeCharts';
                });
                
                this.updateSystemStatus('ready', 'New Benchmark Ready');
                console.log('üìù New benchmark created');
            }

            openBenchmark() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                const results = JSON.parse(e.target.result);
                                this.displayResults(results);
                                this.updateSystemStatus('ready', 'Benchmark Loaded');
                                console.log('üìÇ Benchmark results loaded from file');
                            } catch (error) {
                                alert('Invalid benchmark file format');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }

            saveBenchmark() {
                if (!this.currentResults) {
                    alert('No benchmark results to save');
                    return;
                }
                
                this.downloadJSON(this.currentResults, 'benchmark-results');
                console.log('üíæ Benchmark results saved');
            }

            saveAsReport() {
                if (!this.currentResults) {
                    alert('No benchmark results to save as report');
                    return;
                }
                
                // Generate HTML report
                const report = this.generateHTMLReport(this.currentResults);
                this.downloadHTML(report, 'benchmark-report');
                console.log('üìä Benchmark report saved');
            }

            exportResults() {
                if (!this.currentResults) {
                    alert('No results to export');
                    return;
                }
                
                const format = prompt('Export format (json/csv/html):', 'json');
                if (format) {
                    switch (format.toLowerCase()) {
                        case 'json':
                            this.downloadJSON(this.currentResults, 'benchmark-export');
                            break;
                        case 'csv':
                            this.downloadCSV(this.generateCSV(this.currentResults), 'benchmark-export');
                            break;
                        case 'html':
                            this.downloadHTML(this.generateHTMLReport(this.currentResults), 'benchmark-export');
                            break;
                        default:
                            alert('Unsupported format');
                    }
                }
            }

            closeWindow() {
                if (this.isRunning) {
                    if (confirm('A benchmark is currently running. Stop it and close?')) {
                        this.stopBenchmark();
                        window.close();
                    }
                } else {
                    window.close();
                }
            }

            // Edit Menu
            copyResults() {
                if (!this.currentResults) {
                    alert('No results to copy');
                    return;
                }
                
                const text = JSON.stringify(this.currentResults, null, 2);
                navigator.clipboard.writeText(text).then(() => {
                    this.updateSystemStatus('ready', 'Results copied to clipboard');
                    setTimeout(() => this.updateSystemStatus('ready', 'System Ready'), 2000);
                });
            }

            copySelectedTest() {
                // Implementation for copying selected test results
                alert('Copy Selected Test - Feature to be implemented');
            }

            selectAllTests() {
                document.querySelectorAll('input[id^="suite-"]').forEach(cb => {
                    cb.checked = true;
                });
                this.updateSystemStatus('ready', 'All test suites selected');
                setTimeout(() => this.updateSystemStatus('ready', 'System Ready'), 2000);
            }

            selectFailedTests() {
                // Implementation for selecting only failed tests
                alert('Select Failed Tests - Feature to be implemented');
            }

            selectPassedTests() {
                // Implementation for selecting only passed tests  
                alert('Select Passed Tests - Feature to be implemented');
            }

            clearSelection() {
                document.querySelectorAll('input[id^="suite-"]').forEach(cb => {
                    cb.checked = false;
                });
                this.updateSystemStatus('ready', 'Selection cleared');
                setTimeout(() => this.updateSystemStatus('ready', 'System Ready'), 2000);
            }

            // View Menu
            showOverview() {
                this.switchTab('overview');
            }

            showDetailedResults() {
                this.switchTab('suites');
            }

            showStatistics() {
                this.switchTab('statistics');
            }

            showCharts() {
                this.switchTab('charts');
            }

            showErrorAnalysis() {
                this.switchTab('errors');
            }

            showPerformanceAnalysis() {
                // Implementation for performance analysis view
                alert('Performance Analysis - Feature to be implemented');
            }

            toggleFullscreen() {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    document.documentElement.requestFullscreen();
                }
            }

            // Benchmark Menu
            runQuickBenchmark() {
                // Select basic operations, edit operations and performance tests only
                document.querySelectorAll('input[id^="suite-"]').forEach(cb => {
                    cb.checked = cb.id.includes('basic_operations') || 
                                cb.id.includes('edit_operations') ||
                                cb.id.includes('basic_functions') ||
                                cb.id.includes('performance_tests');
                });
                this.startBenchmark();
            }

            runFullBenchmark() {
                // Select all test suites
                this.selectAllTests();
                setTimeout(() => this.startBenchmark(), 500);
            }

            runCustomBenchmark() {
                // Show configuration section
                document.getElementById('configSection').classList.remove('hidden');
                document.getElementById('configSection').scrollIntoView({ behavior: 'smooth' });
            }

            runBasicOperationsTest() {
                // Select only basic operations
                document.querySelectorAll('input[id^="suite-"]').forEach(cb => {
                    cb.checked = cb.id.includes('basic_operations');
                });
                this.startBenchmark();
            }

            runEditOperationsTest() {
                // Select edit operations and basic operations
                document.querySelectorAll('input[id^="suite-"]').forEach(cb => {
                    cb.checked = cb.id.includes('basic_operations') || 
                                cb.id.includes('edit_operations') ||
                                cb.id.includes('parameter_handling');
                });
                this.startBenchmark();
            }

            async startBenchmark() {
                if (this.isRunning || !this.benchmarkManager) {
                    return;
                }

                try {
                    this.isRunning = true;
                    this.startTime = Date.now();
                    
                    // Update UI
                    this.updateUI('running');
                    this.updateSystemStatus('running', 'Benchmark Running');
                    
                    // Get configuration
                    const options = this.getBenchmarkOptions();
                    
                    console.log('üß™ Starting benchmark with options:', options);
                    
                    // Run benchmark
                    const results = await this.benchmarkManager.framework.runAllBenchmarks(options);
                    
                    this.currentResults = results;
                    this.displayResults(results);
                    this.updateSystemStatus('ready', 'Benchmark Completed');
                    
                } catch (error) {
                    console.error('‚ùå Benchmark failed:', error);
                    this.updateSystemStatus('error', 'Benchmark Failed');
                    alert('Benchmark failed: ' + error.message);
                } finally {
                    this.isRunning = false;
                    this.updateUI('stopped');
                }
            }

            stopBenchmark() {
                if (!this.isRunning) return;
                
                this.isRunning = false;
                if (this.benchmarkManager && this.benchmarkManager.framework) {
                    this.benchmarkManager.framework.stopBenchmark();
                }
                
                this.updateUI('stopped');
                this.updateSystemStatus('ready', 'Benchmark Stopped');
                console.log('‚èπÔ∏è Benchmark stopped by user');
            }

            pauseBenchmark() {
                if (!this.isRunning) return;
                
                if (this.benchmarkManager && this.benchmarkManager.framework) {
                    this.benchmarkManager.framework.pauseBenchmark();
                }
                
                this.updateSystemStatus('warning', 'Benchmark Paused');
                console.log('‚è∏Ô∏è Benchmark paused');
            }

            getBenchmarkOptions() {
                const selectedSuites = [];
                document.querySelectorAll('input[id^="suite-"]:checked').forEach(cb => {
                    selectedSuites.push(cb.id.replace('suite-', ''));
                });

                return {
                    suites: selectedSuites,
                    generateReport: document.getElementById('generateReport').checked,
                    includeCharts: document.getElementById('includeCharts').checked,
                    includeRawData: document.getElementById('includeRawData').checked,
                    stopOnError: document.getElementById('stopOnError').checked,
                    timeout: parseInt(document.getElementById('testTimeout').value),
                    verboseLogging: document.getElementById('verboseLogging').checked,
                    onProgress: (progress, suiteId, suiteResult) => {
                        this.updateProgress(progress, suiteId, suiteResult);
                    },
                    onTestProgress: (progress, testId, testResult, suiteId) => {
                        this.updateTestProgress(progress, testId, testResult, suiteId);
                    }
                };
            }

            updateUI(state) {
                const startBtn = document.getElementById('startBtn');
                const stopBtn = document.getElementById('stopBtn');
                const exportBtn = document.getElementById('exportBtn');
                const stopMenuBtn = document.getElementById('stopBenchmarkMenu');
                const pauseMenuBtn = document.getElementById('pauseBenchmarkMenu');

                switch (state) {
                    case 'running':
                        startBtn.disabled = true;
                        stopBtn.disabled = false;
                        stopMenuBtn.classList.remove('disabled');
                        pauseMenuBtn.classList.remove('disabled');
                        document.getElementById('progressSection').classList.remove('hidden');
                        break;
                    case 'stopped':
                        startBtn.disabled = false;
                        stopBtn.disabled = true;
                        stopMenuBtn.classList.add('disabled');
                        pauseMenuBtn.classList.add('disabled');
                        exportBtn.disabled = !this.currentResults;
                        break;
                }
            }

            updateSystemStatus(type, message) {
                const indicator = document.getElementById('systemStatus');
                const text = document.getElementById('systemStatusText');
                
                indicator.className = \`status-indicator \${type}\`;
                text.textContent = message;
            }

            updateTestCount() {
                if (this.benchmarkManager && this.benchmarkManager.framework) {
                    const count = this.benchmarkManager.framework.getTotalTestCount();
                    document.getElementById('testCount').textContent = \`\${count} tests loaded\`;
                }
            }

            updateTimeStamp() {
                document.getElementById('timeStamp').textContent = new Date().toLocaleTimeString();
            }

            updateProgress(progress, suiteId, suiteResult) {
                const progressFill = document.getElementById('progressFill');
                const currentSuite = document.getElementById('currentSuite');
                
                progressFill.style.width = (progress * 100) + '%';
                currentSuite.textContent = suiteId || '-';
                
                if (suiteResult) {
                    const completed = parseInt(document.getElementById('completedTests').textContent) + suiteResult.stats.totalTests;
                    const passed = parseInt(document.getElementById('passedTests').textContent) + suiteResult.stats.passedTests;
                    const failed = parseInt(document.getElementById('failedTests').textContent) + suiteResult.stats.failedTests;
                    
                    document.getElementById('completedTests').textContent = completed;
                    document.getElementById('passedTests').textContent = passed;
                    document.getElementById('failedTests').textContent = failed;
                }
            }

            updateTestProgress(progress, testId, testResult, suiteId) {
                document.getElementById('currentTest').textContent = testId || '-';
                
                // Update elapsed time
                if (this.startTime) {
                    const elapsed = Date.now() - this.startTime;
                    const minutes = Math.floor(elapsed / 60000);
                    const seconds = Math.floor((elapsed % 60000) / 1000);
                    document.getElementById('elapsedTime').textContent = 
                        \`\${minutes.toString().padStart(2, '0')}:\${seconds.toString().padStart(2, '0')}\`;
                }
            }

            displayResults(results) {
                this.currentResults = results;
                document.getElementById('resultsSection').classList.remove('hidden');
                
                // Display in different tabs
                this.displayOverviewTab(results);
                this.displaySuitesTab(results);
                this.displayOperationsTab(results);
                this.displayStatisticsTab(results);
                this.displayErrorsTab(results);
                
                // Enable export button
                document.getElementById('exportBtn').disabled = false;
            }

            displayOverviewTab(results) {
                const tab = document.getElementById('tab-overview');
                const stats = results.overallStats;
                
                tab.innerHTML = \`
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                        <div style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                            <h3 style="margin-bottom: 10px; opacity: 0.9;">Success Rate</h3>
                            <div style="font-size: 24px; font-weight: bold;">\${stats.overallSuccessRate.toFixed(1)}%</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                            <h3 style="margin-bottom: 10px; opacity: 0.9;">Tests Passed</h3>
                            <div style="font-size: 24px; font-weight: bold;">\${stats.passedTests}/\${stats.totalTests}</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                            <h3 style="margin-bottom: 10px; opacity: 0.9;">Average Score</h3>
                            <div style="font-size: 24px; font-weight: bold;">\${stats.scoreStats.percentage.mean.toFixed(1)}%</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                            <h3 style="margin-bottom: 10px; opacity: 0.9;">Duration</h3>
                            <div style="font-size: 24px; font-weight: bold;">\${Math.round(results.duration / 1000)}s</div>
                        </div>
                    </div>
                    <h3>Summary</h3>
                    <p><strong>Total Test Suites:</strong> \${stats.totalSuites}</p>
                    <p><strong>Total Tests:</strong> \${stats.totalTests}</p>
                    <p><strong>Quality Score:</strong> \${stats.qualityMetrics.excellence.toFixed(1)}%</p>
                    <p><strong>Reliability:</strong> \${stats.reliabilityMetrics.scoreReliability.toFixed(1)}%</p>
                \`;
            }

            displaySuitesTab(results) {
                const tab = document.getElementById('tab-suites');
                let html = '<h3>Test Suite Results</h3>';
                
                results.testSuiteResults.forEach(suite => {
                    const passRate = (suite.stats.passedTests / suite.stats.totalTests * 100).toFixed(1);
                    html += \`
                        <div style="border: 1px solid #ddd; border-radius: 6px; margin-bottom: 15px; overflow: hidden;">
                            <div style="background: #f8f9fa; padding: 15px; cursor: pointer;" onclick="this.nextElementSibling.classList.toggle('hidden')">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <strong>\${suite.suiteName}</strong>
                                    <span>Pass Rate: \${passRate}% | Duration: \${Math.round(suite.duration / 1000)}s</span>
                                </div>
                            </div>
                            <div class="hidden" style="padding: 15px;">
                                \${suite.testResults.map(test => \`
                                    <div style="padding: 8px; margin: 5px 0; border-radius: 4px; border-left: 4px solid \${test.success ? '#28a745' : (test.status === 'error' ? '#ffc107' : '#dc3545')}; background: \${test.success ? '#d4edda' : (test.status === 'error' ? '#fff3cd' : '#f8d7da')};">
                                        <strong>\${test.testName}</strong><br>
                                        <small>Score: \${test.score}/\${test.maxScore} | Duration: \${test.duration}ms | Status: \${test.status}</small>
                                    </div>
                                \`).join('')}
                            </div>
                        </div>
                    \`;
                });
                
                tab.innerHTML = html;
            }

            displayOperationsTab(results) {
                const tab = document.getElementById('tab-operations');
                
                // Find basic operations results
                const operationsSuite = results.testSuiteResults.find(suite => 
                    suite.suiteId === 'basic_operations'
                );
                
                if (operationsSuite) {
                    const copyTests = operationsSuite.testResults.filter(test => test.testId.includes('copy'));
                    const pasteTests = operationsSuite.testResults.filter(test => test.testId.includes('paste'));
                    const cutTests = operationsSuite.testResults.filter(test => test.testId.includes('cut'));
                    const selectTests = operationsSuite.testResults.filter(test => test.testId.includes('select'));
                    
                    tab.innerHTML = \`
                        <h3>Edit Operations Analysis</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div style="background: #e8f5e8; padding: 15px; border-radius: 6px;">
                                <h4>Copy Operations</h4>
                                <p>Tests: \${copyTests.length}</p>
                                <p>Passed: \${copyTests.filter(t => t.success).length}</p>
                            </div>
                            <div style="background: #fff3cd; padding: 15px; border-radius: 6px;">
                                <h4>Paste Operations</h4>
                                <p>Tests: \${pasteTests.length}</p>
                                <p>Passed: \${pasteTests.filter(t => t.success).length}</p>
                            </div>
                            <div style="background: #f8d7da; padding: 15px; border-radius: 6px;">
                                <h4>Cut Operations</h4>
                                <p>Tests: \${cutTests.length}</p>
                                <p>Passed: \${cutTests.filter(t => t.success).length}</p>
                            </div>
                            <div style="background: #d1ecf1; padding: 15px; border-radius: 6px;">
                                <h4>Select Operations</h4>
                                <p>Tests: \${selectTests.length}</p>
                                <p>Passed: \${selectTests.filter(t => t.success).length}</p>
                            </div>
                        </div>
                        <h4>Detailed Results</h4>
                        \${operationsSuite.testResults.map(test => \`
                            <div style="padding: 10px; margin: 8px 0; border-radius: 4px; border-left: 4px solid \${test.success ? '#28a745' : '#dc3545'}; background: \${test.success ? '#d4edda' : '#f8d7da'};">
                                <strong>\${test.testName}</strong><br>
                                <small>Score: \${test.score}/\${test.maxScore} | Duration: \${test.duration}ms</small>
                                \${test.errors.length > 0 ? \`<br><small style="color: #dc3545;">Errors: \${test.errors.join(', ')}</small>\` : ''}
                            </div>
                        \`).join('')}
                    \`;
                } else {
                    tab.innerHTML = '<p>No basic operations tests were run in this benchmark.</p>';
                }
            }

            displayStatisticsTab(results) {
                const tab = document.getElementById('tab-statistics');
                const stats = results.overallStats;
                
                tab.innerHTML = \`
                    <h3>Statistical Analysis</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>Score Statistics</h4>
                            <p><strong>Mean:</strong> \${stats.scoreStats.percentage.mean.toFixed(2)}%</p>
                            <p><strong>Median:</strong> \${stats.scoreStats.percentage.median.toFixed(2)}%</p>
                            <p><strong>Standard Deviation:</strong> \${stats.scoreStats.percentage.standardDeviation.toFixed(2)}%</p>
                            <p><strong>95th Percentile:</strong> \${stats.scoreStats.percentage.percentiles.p95.toFixed(2)}%</p>
                        </div>
                        <div>
                            <h4>Performance Statistics</h4>
                            <p><strong>Average Duration:</strong> \${stats.performanceStats.duration.mean.toFixed(0)}ms</p>
                            <p><strong>Fastest Test:</strong> \${stats.performanceStats.duration.min}ms</p>
                            <p><strong>Slowest Test:</strong> \${stats.performanceStats.duration.max}ms</p>
                            <p><strong>Throughput:</strong> \${stats.performanceStats.throughput.testsPerSecond.toFixed(2)} tests/sec</p>
                        </div>
                    </div>
                \`;
            }

            displayErrorsTab(results) {
                const tab = document.getElementById('tab-errors');
                const errorStats = results.overallStats.errorAnalysis;
                
                let html = '<h3>Error Analysis</h3>';
                html += \`<p><strong>Total Errors:</strong> \${errorStats.totalErrors}</p>\`;
                html += \`<p><strong>Error Rate:</strong> \${errorStats.errorRate.toFixed(1)}%</p>\`;
                
                if (Object.keys(errorStats.errorCategories).length > 0) {
                    html += '<h4>Error Categories</h4><ul>';
                    for (const [category, count] of Object.entries(errorStats.errorCategories)) {
                        html += \`<li>\${category}: \${count}</li>\`;
                    }
                    html += '</ul>';
                }
                
                tab.innerHTML = html;
            }

            switchTab(tabName) {
                // Update tab buttons
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelector(\`[data-tab="\${tabName}"]\`).classList.add('active');
                
                // Update tab panes
                document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
                document.getElementById(\`tab-\${tabName}\`).classList.add('active');
            }

            // Tools Menu
            validateConfiguration() {
                if (!this.benchmarkManager) {
                    alert('Benchmark system not initialized');
                    return;
                }
                
                const status = this.benchmarkManager.getSystemStatus();
                const message = \`
Configuration Status:
‚Ä¢ Initialized: \${status.initialized}
‚Ä¢ Framework Ready: \${status.frameworkReady}
‚Ä¢ ChatManager Available: \${status.chatManagerAvailable}
‚Ä¢ Test Suites Loaded: \${status.testSuitesLoaded}
                \`.trim();
                
                alert(message);
            }

            testLLMConnection() {
                if (!this.benchmarkManager || !this.benchmarkManager.chatManager) {
                    alert('ChatManager not available');
                    return;
                }
                
                const isConfigured = this.benchmarkManager.chatManager.llmConfigManager.isConfigured();
                if (isConfigured) {
                    alert('‚úÖ LLM is configured and ready for testing');
                } else {
                    alert('‚ùå LLM not configured. Please configure an LLM provider first.');
                }
            }

            clearHistory() {
                if (confirm('Are you sure you want to clear the benchmark history?')) {
                    if (this.benchmarkManager && this.benchmarkManager.framework) {
                        this.benchmarkManager.framework.clearBenchmarkHistory();
                        this.refreshHistory();
                        alert('History cleared successfully');
                    }
                }
            }

            resetSettings() {
                if (confirm('Reset all benchmark settings to default?')) {
                    // Reset checkboxes
                    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                        cb.checked = cb.id.includes('basic_operations') || 
                                    cb.id.includes('basic_functions') || 
                                    cb.id === 'generateReport' ||
                                    cb.id === 'includeCharts';
                    });
                    
                    // Reset selects
                    document.getElementById('testTimeout').value = '30000';
                    document.getElementById('concurrency').value = '1';
                    
                    alert('Settings reset to default');
                }
            }

            openDebugConsole() {
                // Open browser dev tools
                if (typeof require !== 'undefined') {
                    const { remote } = require('electron');
                    remote.getCurrentWindow().webContents.openDevTools();
                } else {
                    alert('Debug console: Open browser developer tools (F12)');
                }
            }

            // Help Menu
            showDocumentation() {
                const docWindow = window.open('', 'BenchmarkDocs', 'width=800,height=600');
                docWindow.document.write(\`
                    <html>
                    <head><title>Benchmark Documentation</title></head>
                    <body style="font-family: Arial, sans-serif; padding: 20px;">
                        <h1>LLM Instruction Following Benchmark</h1>
                        <h2>Test Suites</h2>
                        <ul>
                            <li><strong>Basic Operations:</strong> Tests Copy, Paste, Select All, Undo, Redo operations</li>
                            <li><strong>Basic Functions:</strong> Tests fundamental function calling capabilities</li>
                            <li><strong>Complex Analysis:</strong> Tests multi-step analysis workflows</li>
                            <li><strong>Plugin Integration:</strong> Tests AI integration with plugin functions</li>
                            <li><strong>Parameter Handling:</strong> Tests parameter parsing and validation</li>
                            <li><strong>Error Recovery:</strong> Tests error handling capabilities</li>
                            <li><strong>Performance:</strong> Tests response time and efficiency</li>
                            <li><strong>Consistency:</strong> Tests repeatability across similar tasks</li>
                        </ul>
                        <h2>Usage</h2>
                        <p>1. Select test suites to run</p>
                        <p>2. Configure options and timeout</p>
                        <p>3. Click Start Benchmark</p>
                        <p>4. View results in different tabs</p>
                        <p>5. Export results for analysis</p>
                    </body>
                    </html>
                \`);
            }

            showTestGuide() {
                alert('Test Guide: Detailed testing instructions and best practices');
            }

            showAbout() {
                alert(\`
LLM Instruction Following Benchmark v1.0.0
Genome AI Studio

A comprehensive testing framework for evaluating LLM instruction following capabilities in bioinformatics applications.

Features:
‚Ä¢ 11 test suites with 120+ individual tests
‚Ä¢ Advanced statistical analysis
‚Ä¢ Professional reporting
‚Ä¢ Real-time progress monitoring
‚Ä¢ Export capabilities

¬© 2024 Genome AI Studio
                \`.trim());
            }

            // Utility methods
            downloadJSON(data, filename) {
                const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
                this.downloadBlob(blob, filename + '.json');
            }

            downloadCSV(csvData, filename) {
                const blob = new Blob([csvData], {type: 'text/csv'});
                this.downloadBlob(blob, filename + '.csv');
            }

            downloadHTML(htmlData, filename) {
                const blob = new Blob([htmlData], {type: 'text/html'});
                this.downloadBlob(blob, filename + '.html');
            }

            downloadBlob(blob, filename) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
            }

            generateCSV(results) {
                // Generate CSV from benchmark results
                let csv = 'Suite,Test,Success,Score,MaxScore,Duration,Errors\\n';
                
                results.testSuiteResults.forEach(suite => {
                    suite.testResults.forEach(test => {
                        csv += \`"\${suite.suiteName}","\${test.testName}",\${test.success},\${test.score},\${test.maxScore},\${test.duration},\${test.errors.length}\\n\`;
                    });
                });
                
                return csv;
            }

            generateHTMLReport(results) {
                // Generate HTML report
                return \`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Benchmark Report</title>
                    <style>body{font-family:Arial,sans-serif;padding:20px;}</style>
                </head>
                <body>
                    <h1>LLM Instruction Following Benchmark Report</h1>
                    <p>Generated: \${new Date().toLocaleString()}</p>
                    <h2>Summary</h2>
                    <p>Success Rate: \${results.overallStats.overallSuccessRate.toFixed(1)}%</p>
                    <p>Tests: \${results.overallStats.passedTests}/\${results.overallStats.totalTests}</p>
                    <p>Duration: \${Math.round(results.duration / 1000)} seconds</p>
                </body>
                </html>
                \`;
            }

            refreshHistory() {
                // Refresh history display
                console.log('üîÑ Refreshing benchmark history');
            }

            exportHistory() {
                if (this.benchmarkManager && this.benchmarkManager.framework) {
                    const history = this.benchmarkManager.framework.getBenchmarkHistory();
                    this.downloadJSON(history, 'benchmark-history');
                }
            }
        }

        // Initialize the application
        const benchmarkApp = new BenchmarkApp();
        
        // Make available globally for menu actions
        window.benchmarkApp = benchmarkApp;
    </script>
</body>
</html>
