<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plugin Documentation System - CodeXomics</title>
    <link rel="stylesheet" href="renderer/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e0e0e0;
            overflow: hidden;
        }
        
        #app {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 24px 32px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .app-title {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .app-title h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .app-title .icon-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .app-title .icon-badge i {
            font-size: 32px;
        }
        
        .header-stats {
            display: flex;
            gap: 24px;
            align-items: center;
        }
        
        .stat-item {
            text-align: center;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .stat-item .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            display: block;
        }
        
        .stat-item .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            display: block;
            margin-top: 4px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px #4ade80;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.9); }
        }
        
        .status-text {
            color: #fff;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Sidebar */
        .sidebar {
            width: 280px;
            background: #252525;
            border-right: 1px solid #3a3a3a;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .nav-section {
            padding: 24px 16px;
            border-bottom: 1px solid #3a3a3a;
        }
        
        .nav-section h3 {
            margin: 0 0 16px 0;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: #888;
            letter-spacing: 1px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #ccc;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            position: relative;
        }
        
        .nav-item i {
            width: 20px;
            font-size: 16px;
        }
        
        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .nav-item .badge {
            margin-left: auto;
            background: #667eea;
            color: #fff;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .nav-item.active .badge {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Content Area */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: #1e1e1e;
        }
        
        .content-header {
            padding: 24px 32px;
            border-bottom: 1px solid #3a3a3a;
            background: #252525;
        }
        
        .content-header h2 {
            margin: 0 0 8px 0;
            font-size: 24px;
            font-weight: 600;
            color: #fff;
        }
        
        .content-header p {
            margin: 0;
            color: #999;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .content-toolbar {
            padding: 16px 32px;
            border-bottom: 1px solid #3a3a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #252525;
        }
        
        .toolbar-left, .toolbar-right {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }
        
        .btn-primary:disabled {
            background: #555;
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: #3a3a3a;
            color: #ccc;
            border: 1px solid #555;
        }
        
        .btn-secondary:hover {
            background: #4a4a4a;
            color: #fff;
            border-color: #667eea;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(74, 222, 128, 0.3);
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(74, 222, 128, 0.4);
        }
        
        /* Content Body */
        .content-body {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
        }
        
        /* Cards */
        .card {
            background: #252525;
            border: 1px solid #3a3a3a;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            border-color: #667eea;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .card-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #fff;
        }
        
        .card-title .icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
        }
        
        .card-meta {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .meta-badge {
            padding: 4px 12px;
            background: #3a3a3a;
            border-radius: 6px;
            font-size: 12px;
            color: #ccc;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .meta-badge.priority-high { background: #dc2626; color: #fff; }
        .meta-badge.priority-medium { background: #f59e0b; color: #fff; }
        .meta-badge.priority-low { background: #3b82f6; color: #fff; }
        
        .card-body {
            color: #ccc;
            line-height: 1.6;
        }
        
        .card-footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #3a3a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 40px;
            color: #666;
        }
        
        .empty-state .icon {
            font-size: 72px;
            margin-bottom: 24px;
            color: #444;
            opacity: 0.5;
        }
        
        .empty-state h3 {
            margin: 0 0 12px 0;
            font-size: 24px;
            color: #888;
        }
        
        .empty-state p {
            margin: 0 0 24px 0;
            font-size: 14px;
            line-height: 1.6;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Documentation Prompt Display */
        .doc-prompt-container {
            background: #1a1a1a;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 16px;
        }
        
        .doc-prompt-header {
            background: #2a2a2a;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #3a3a3a;
        }
        
        .doc-prompt-header h4 {
            margin: 0;
            font-size: 14px;
            color: #ccc;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .doc-prompt-body {
            padding: 16px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .doc-prompt-body pre {
            margin: 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: #e0e0e0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
        }
        
        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);
            border: 1px solid #3a3a3a;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            border-color: #667eea;
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
        }
        
        .stat-card .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-card .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
        }
        
        .stat-card .stat-label {
            font-size: 14px;
            color: #888;
            font-weight: 500;
        }
        
        /* Loading Spinner */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 80px 20px;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #3a3a3a;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 24px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: #888;
            font-size: 16px;
        }
        
        /* Copy Button */
        .copy-btn {
            padding: 6px 12px;
            background: #667eea;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
        }
        
        .copy-btn:hover {
            background: #764ba2;
        }
        
        .copy-btn.copied {
            background: #4ade80;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #3a3a3a;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #4a4a4a;
        }
        
        /* Complexity Badge */
        .complexity-badge {
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .complexity-simple { background: #4ade80; color: #fff; }
        .complexity-moderate { background: #f59e0b; color: #fff; }
        .complexity-complex { background: #dc2626; color: #fff; }
        
        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #3a3a3a;
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 24px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 2px solid #1e1e1e;
        }
        
        .timeline-content {
            background: #252525;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 16px;
        }
        
        .timeline-content h4 {
            margin: 0 0 8px 0;
            color: #fff;
            font-size: 16px;
        }
        
        .timeline-content p {
            margin: 0;
            color: #ccc;
            font-size: 14px;
        }
        
        .timeline-content .time {
            color: #888;
            font-size: 12px;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="app-header">
            <div class="header-content">
                <div class="app-title">
                    <div class="icon-badge">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div>
                        <h1>Plugin Documentation System</h1>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="docCount">0</span>
                        <span class="stat-label">Documentation</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="conversationCount">0</span>
                        <span class="stat-label">Conversations</span>
                    </div>
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span class="status-text">Active</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="nav-section">
                    <h3>Main</h3>
                    <div class="nav-item active" onclick="switchView('dashboard')">
                        <i class="fas fa-th-large"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="nav-item" onclick="switchView('documentation')">
                        <i class="fas fa-book"></i>
                        <span>Documentation</span>
                        <span class="badge" id="docBadge">0</span>
                    </div>
                    <div class="nav-item" onclick="switchView('missing-features')">
                        <i class="fas fa-lightbulb"></i>
                        <span>Missing Features</span>
                        <span class="badge" id="missingBadge">0</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <h3>Analysis</h3>
                    <div class="nav-item" onclick="switchView('conversations')">
                        <i class="fas fa-comments"></i>
                        <span>Conversations</span>
                    </div>
                    <div class="nav-item" onclick="switchView('analytics')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </div>
                </div>
                
                <div class="nav-section">
                    <h3>Settings</h3>
                    <div class="nav-item" onclick="switchView('history')">
                        <i class="fas fa-history"></i>
                        <span>History Manager</span>
                    </div>
                    <div class="nav-item" onclick="exportData()">
                        <i class="fas fa-download"></i>
                        <span>Export Data</span>
                    </div>
                </div>
            </div>
            
            <div class="content-area">
                <div id="viewContainer">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Load required modules -->
    <script src="renderer/modules/ConfigManager.js"></script>
    <script src="renderer/modules/LLMConfigManager.js"></script>
    <script src="renderer/modules/ConversationEvolutionStorageManager.js"></script>
    <script src="renderer/modules/ConversationAnalysisEngine.js"></script>
    <script src="renderer/modules/AutoPluginGenerator.js"></script>
    <script src="renderer/modules/ConversationEvolutionManager.js"></script>
    
    <script>
        const { ipcRenderer } = require('electron');
        
        // Global state
        let currentView = 'dashboard';
        let evolutionManager = null;
        let isAnalyzing = false;
        
        // Initialize the system
        async function initializeSystem() {
            try {
                console.log('ðŸš€ Initializing Plugin Documentation System...');
                
                // Create config manager
                const configManager = new ConfigManager();
                await configManager.waitForInitialization();
                
                // Create evolution manager
                evolutionManager = new ConversationEvolutionManager(null, configManager, null);
                
                // Make globally available
                window.evolutionManager = evolutionManager;
                
                // Load initial view
                switchView('dashboard');
                updateHeaderStats();
                
                console.log('âœ… System initialized successfully');
                
            } catch (error) {
                console.error('âŒ Failed to initialize system:', error);
                showError('Failed to initialize system: ' + error.message);
            }
        }
        
        // Switch between views
        function switchView(viewName) {
            currentView = viewName;
            
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event?.target?.closest('.nav-item')?.classList.add('active');
            
            // Render view
            renderView(viewName);
        }
        
        // Render different views
        function renderView(viewName) {
            const container = document.getElementById('viewContainer');
            
            switch (viewName) {
                case 'dashboard':
                    renderDashboard(container);
                    break;
                case 'documentation':
                    renderDocumentation(container);
                    break;
                case 'missing-features':
                    renderMissingFeatures(container);
                    break;
                case 'conversations':
                    renderConversations(container);
                    break;
                case 'analytics':
                    renderAnalytics(container);
                    break;
                case 'history':
                    renderHistory(container);
                    break;
                default:
                    container.innerHTML = '<div class="empty-state"><div class="icon"><i class="fas fa-question-circle"></i></div><h3>Unknown View</h3></div>';
            }
        }
        
        // Dashboard View
        function renderDashboard(container) {
            const docs = evolutionManager?.evolutionData?.pluginDocumentation || [];
            const conversations = evolutionManager?.evolutionData?.conversations || [];
            const missingFeatures = evolutionManager?.evolutionData?.missingFunctions || [];
            
            container.innerHTML = `
                <div class="content-header">
                    <h2>Dashboard</h2>
                    <p>Overview of the Plugin Documentation System and analysis insights</p>
                </div>
                
                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" onclick="startAnalysis()" ${isAnalyzing ? 'disabled' : ''}>
                            <i class="fas fa-magic"></i>
                            ${isAnalyzing ? 'Analyzing...' : 'Analyze Conversations'}
                        </button>
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <i class="fas fa-sync"></i>
                            Refresh
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-secondary" onclick="switchView('history')">
                            <i class="fas fa-history"></i>
                            History
                        </button>
                    </div>
                </div>
                
                <div class="content-body">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-book"></i></div>
                            <div class="stat-number">${docs.length}</div>
                            <div class="stat-label">Plugin Documentation</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-comments"></i></div>
                            <div class="stat-number">${conversations.length}</div>
                            <div class="stat-label">Analyzed Conversations</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-lightbulb"></i></div>
                            <div class="stat-number">${missingFeatures.length}</div>
                            <div class="stat-label">Missing Features</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-number">${docs.filter(d => d.metadata?.generated).length}</div>
                            <div class="stat-label">Generated Guides</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="icon"><i class="fas fa-info-circle"></i></div>
                                <h3>About Plugin Documentation System</h3>
                            </div>
                        </div>
                        <div class="card-body">
                            <p>The Plugin Documentation System analyzes your conversations with the AI to identify missing features and capabilities. Instead of automatically generating plugin code, it creates comprehensive documentation prompts that guide you through building plugins yourself.</p>
                            <br>
                            <p><strong>How it works:</strong></p>
                            <ul style="margin: 12px 0; padding-left: 20px; color: #ccc;">
                                <li>Monitors AI conversations for feature requests and limitations</li>
                                <li>Analyzes patterns to identify missing functionality</li>
                                <li>Generates detailed documentation prompts with implementation guides</li>
                                <li>Provides code examples, best practices, and testing strategies</li>
                            </ul>
                            <br>
                            <p>Start by clicking <strong>"Analyze Conversations"</strong> to begin the analysis process.</p>
                        </div>
                    </div>
                    
                    ${docs.length > 0 ? `
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <div class="icon"><i class="fas fa-book"></i></div>
                                    <h3>Recent Documentation</h3>
                                </div>
                                <button class="btn btn-secondary" onclick="switchView('documentation')">
                                    View All
                                </button>
                            </div>
                            <div class="card-body">
                                ${docs.slice(0, 3).map(doc => `
                                    <div style="padding: 16px; background: #1e1e1e; border: 1px solid #3a3a3a; border-radius: 8px; margin-bottom: 12px;">
                                        <h4 style="margin: 0 0 8px 0; color: #fff;">${doc.specification?.name || 'Unnamed Documentation'}</h4>
                                        <p style="margin: 0; color: #999; font-size: 14px;">${(doc.specification?.description || '').substring(0, 150)}...</p>
                                        <div style="margin-top: 12px; display: flex; gap: 8px;">
                                            <span class="meta-badge priority-${doc.metadata?.priority || 'low'}">${doc.metadata?.priority || 'low'} priority</span>
                                            <span class="complexity-badge complexity-${doc.metadata?.complexity || 'simple'}">${doc.metadata?.complexity || 'simple'}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }
        
        // Documentation View
        function renderDocumentation(container) {
            const docs = evolutionManager?.evolutionData?.pluginDocumentation || [];
            
            container.innerHTML = `
                <div class="content-header">
                    <h2>Plugin Documentation</h2>
                    <p>Comprehensive guides and prompts for creating plugins to address missing features</p>
                </div>
                
                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-success" onclick="generateNewDoc()">
                            <i class="fas fa-plus"></i>
                            Generate New Documentation
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <i class="fas fa-sync"></i>
                            Refresh
                        </button>
                    </div>
                </div>
                
                <div class="content-body">
                    ${docs.length > 0 ? `
                        <div class="grid">
                            ${docs.map(doc => renderDocCard(doc)).join('')}
                        </div>
                    ` : `
                        <div class="empty-state">
                            <div class="icon"><i class="fas fa-book-open"></i></div>
                            <h3>No Documentation Generated Yet</h3>
                            <p>Start by analyzing conversations to identify missing features, then generate documentation prompts.</p>
                            <button class="btn btn-primary" onclick="startAnalysis()">
                                <i class="fas fa-magic"></i>
                                Start Analysis
                            </button>
                        </div>
                    `}
                </div>
            `;
        }
        
        // Render Documentation Card
        function renderDocCard(doc) {
            const spec = doc.specification || {};
            const meta = doc.metadata || {};
            
            return `
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="icon"><i class="fas fa-puzzle-piece"></i></div>
                            <h3>${spec.name || 'Unnamed Plugin'}</h3>
                        </div>
                    </div>
                    <div class="card-body">
                        <p>${spec.description || 'No description available'}</p>
                        <div class="card-meta">
                            <span class="meta-badge priority-${meta.priority || 'low'}">
                                <i class="fas fa-flag"></i>
                                ${meta.priority || 'low'} priority
                            </span>
                            <span class="complexity-badge complexity-${meta.complexity || 'simple'}">
                                ${meta.complexity || 'simple'}
                            </span>
                            <span class="meta-badge">
                                <i class="fas fa-clock"></i>
                                ${meta.estimatedTime || 'N/A'}
                            </span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-secondary" onclick="viewDocumentation('${doc.id}')">
                            <i class="fas fa-eye"></i>
                            View Details
                        </button>
                        <button class="btn btn-primary" onclick="copyDocumentation('${doc.id}')">
                            <i class="fas fa-copy"></i>
                            Copy Prompt
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Missing Features View
        function renderMissingFeatures(container) {
            const features = evolutionManager?.evolutionData?.missingFunctions || [];
            
            container.innerHTML = `
                <div class="content-header">
                    <h2>Missing Features</h2>
                    <p>Identified capabilities and features that are currently unavailable in the system</p>
                </div>
                
                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" onclick="startAnalysis()">
                            <i class="fas fa-search"></i>
                            Analyze Conversations
                        </button>
                    </div>
                </div>
                
                <div class="content-body">
                    ${features.length > 0 ? `
                        ${features.map((feature, index) => `
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <div class="icon"><i class="fas fa-lightbulb"></i></div>
                                        <h3>Feature ${index + 1}</h3>
                                    </div>
                                    <div class="card-meta">
                                        <span class="meta-badge priority-${feature.priority || 'low'}">
                                            ${feature.priority || 'low'} priority
                                        </span>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <p><strong>Description:</strong> ${feature.missingFunctionDescription || 'No description'}</p>
                                    <p><strong>Category:</strong> ${feature.category || 'Unknown'}</p>
                                    <p><strong>Domain:</strong> ${feature.domain || 'General'}</p>
                                </div>
                                <div class="card-footer">
                                    <button class="btn btn-success" onclick="generateDocForFeature('${feature.id}')">
                                        <i class="fas fa-book"></i>
                                        Generate Documentation
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    ` : `
                        <div class="empty-state">
                            <div class="icon"><i class="fas fa-check-circle"></i></div>
                            <h3>No Missing Features Identified</h3>
                            <p>All requested features appear to be available, or no analysis has been performed yet.</p>
                            <button class="btn btn-primary" onclick="startAnalysis()">
                                <i class="fas fa-search"></i>
                                Analyze Conversations
                            </button>
                        </div>
                    `}
                </div>
            `;
        }
        
        // Conversations View
        function renderConversations(container) {
            const conversations = evolutionManager?.evolutionData?.conversations || [];
            
            container.innerHTML = `
                <div class="content-header">
                    <h2>Conversation History</h2>
                    <p>Analyzed conversations used to identify patterns and missing features</p>
                </div>
                
                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-secondary" onclick="refreshData()">
                            <i class="fas fa-sync"></i>
                            Refresh
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-secondary" onclick="switchView('history')">
                            <i class="fas fa-cog"></i>
                            Manage History
                        </button>
                    </div>
                </div>
                
                <div class="content-body">
                    ${conversations.length > 0 ? `
                        ${conversations.map((conv, index) => `
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <div class="icon"><i class="fas fa-comment"></i></div>
                                        <h3>Conversation ${index + 1}</h3>
                                    </div>
                                    <div class="card-meta">
                                        <span class="meta-badge">
                                            <i class="fas fa-calendar"></i>
                                            ${new Date(conv.startTime).toLocaleDateString()}
                                        </span>
                                        <span class="meta-badge">
                                            <i class="fas fa-message"></i>
                                            ${conv.stats?.messageCount || 0} messages
                                        </span>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <p><strong>Status:</strong> ${conv.completed ? 'Completed' : 'In Progress'}</p>
                                    <p><strong>Errors:</strong> ${conv.stats?.errorCount || 0}</p>
                                    <p><strong>Category:</strong> ${conv.metadata?.category || 'standard'}</p>
                                </div>
                            </div>
                        `).join('')}
                    ` : `
                        <div class="empty-state">
                            <div class="icon"><i class="fas fa-comments"></i></div>
                            <h3>No Conversations Recorded</h3>
                            <p>Conversations will appear here as you interact with the AI system.</p>
                        </div>
                    `}
                </div>
            `;
        }
        
        // Analytics View
        function renderAnalytics(container) {
            container.innerHTML = `
                <div class="content-header">
                    <h2>Analytics</h2>
                    <p>Insights and statistics about conversation patterns and documentation generation</p>
                </div>
                
                <div class="content-body">
                    <div class="empty-state">
                        <div class="icon"><i class="fas fa-chart-bar"></i></div>
                        <h3>Analytics Coming Soon</h3>
                        <p>Detailed analytics and visualizations will be available in a future update.</p>
                    </div>
                </div>
            `;
        }
        
        // History Manager View
        function renderHistory(container) {
            container.innerHTML = `
                <div class="content-header">
                    <h2>History Manager</h2>
                    <p>Manage conversation history and system data</p>
                </div>
                
                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-secondary" onclick="exportData()">
                            <i class="fas fa-download"></i>
                            Export Data
                        </button>
                        <button class="btn btn-secondary" onclick="importData()">
                            <i class="fas fa-upload"></i>
                            Import Data
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-secondary" style="background: #dc2626; color: white;" onclick="clearAllData()">
                            <i class="fas fa-trash"></i>
                            Clear All Data
                        </button>
                    </div>
                </div>
                
                <div class="content-body">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <div class="icon"><i class="fas fa-database"></i></div>
                                <h3>Storage Information</h3>
                            </div>
                        </div>
                        <div class="card-body">
                            <p>Manage your conversation history and system data. You can export data for backup or import previously saved data.</p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Helper Functions
        function updateHeaderStats() {
            const docs = evolutionManager?.evolutionData?.pluginDocumentation || [];
            const conversations = evolutionManager?.evolutionData?.conversations || [];
            
            document.getElementById('docCount').textContent = docs.length;
            document.getElementById('conversationCount').textContent = conversations.length;
            document.getElementById('docBadge').textContent = docs.length;
            document.getElementById('missingBadge').textContent = (evolutionManager?.evolutionData?.missingFunctions || []).length;
        }
        
        async function startAnalysis() {
            if (isAnalyzing) return;
            
            isAnalyzing = true;
            try {
                console.log('ðŸ” Starting conversation analysis...');
                // TODO: Implement actual analysis logic
                await new Promise(resolve => setTimeout(resolve, 2000)); // Simulated delay
                
                refreshData();
                console.log('âœ… Analysis complete');
            } catch (error) {
                console.error('âŒ Analysis failed:', error);
                showError('Analysis failed: ' + error.message);
            } finally {
                isAnalyzing = false;
            }
        }
        
        function refreshData() {
            console.log('ðŸ”„ Refreshing data...');
            updateHeaderStats();
            renderView(currentView);
        }
        
        function generateNewDoc() {
            console.log('ðŸ“ Generating new documentation...');
            alert('Generate new documentation - Feature coming soon!');
        }
        
        function generateDocForFeature(featureId) {
            console.log('ðŸ“ Generating documentation for feature:', featureId);
            alert('Generate documentation for feature - Feature coming soon!');
        }
        
        function viewDocumentation(docId) {
            console.log('ðŸ‘ï¸ Viewing documentation:', docId);
            const doc = evolutionManager?.evolutionData?.pluginDocumentation?.find(d => d.id === docId);
            if (doc) {
                // TODO: Show detailed documentation view
                alert('View documentation details - Feature coming soon!');
            }
        }
        
        function copyDocumentation(docId) {
            console.log('ðŸ“‹ Copying documentation:', docId);
            const doc = evolutionManager?.evolutionData?.pluginDocumentation?.find(d => d.id === docId);
            if (doc) {
                const prompt = JSON.stringify(doc, null, 2);
                navigator.clipboard.writeText(prompt).then(() => {
                    alert('Documentation prompt copied to clipboard!');
                }).catch(err => {
                    console.error('Failed to copy:', err);
                });
            }
        }
        
        function exportData() {
            console.log('ðŸ“¤ Exporting data...');
            if (evolutionManager?.storageManager?.exportConversationHistory) {
                evolutionManager.storageManager.exportConversationHistory('json');
            } else {
                alert('Export functionality not available');
            }
        }
        
        function importData() {
            console.log('ðŸ“¥ Importing data...');
            alert('Import data - Feature coming soon!');
        }
        
        function clearAllData() {
            if (confirm('âš ï¸ This will permanently delete ALL data. This action cannot be undone. Continue?')) {
                console.log('ðŸ—‘ï¸ Clearing all data...');
                if (evolutionManager?.storageManager) {
                    evolutionManager.storageManager.historyData.conversations = [];
                    evolutionManager.storageManager.historyData.analysisRecords = [];
                    evolutionManager.storageManager.historyData.pluginGenerationHistory = [];
                    evolutionManager.storageManager.saveHistoryData();
                    refreshData();
                    alert('All data has been cleared.');
                }
            }
        }
        
        function showError(message) {
            alert('Error: ' + message);
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            initializeSystem();
        });
    </script>
</body>
</html>
