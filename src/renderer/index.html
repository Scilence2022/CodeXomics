<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genome Browser</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="app-title">
                    <i class="fas fa-dna"></i>
                    Genome Browser
                </h1>
            </div>
            <div class="header-center">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search sequence or gene..." class="search-input">
                    <button id="searchBtn" class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div class="position-container">
                    <input type="text" id="positionInput" placeholder="Chr:start-end" class="position-input">
                    <button id="goToBtn" class="goto-btn">Go</button>
                </div>
            </div>
            <div class="header-right">
                <div class="file-menu-container">
                    <button id="openFileBtn" class="btn btn-primary dropdown-toggle">
                        <i class="fas fa-folder-open"></i>
                        Load File
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="fileDropdownMenu">
                        <button class="dropdown-item" id="openGenomeBtn">
                            <i class="fas fa-dna"></i>
                            Genome File (FASTA, GenBank)
                        </button>
                        <button class="dropdown-item" id="openAnnotationBtn">
                            <i class="fas fa-tags"></i>
                            Annotation File (GFF, BED)
                        </button>
                        <button class="dropdown-item" id="openVariantBtn">
                            <i class="fas fa-exclamation-triangle"></i>
                            Variant File (VCF)
                        </button>
                        <button class="dropdown-item" id="openReadsBtn">
                            <i class="fas fa-align-left"></i>
                            Reads File (SAM/BAM)
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="openAnyBtn">
                            <i class="fas fa-file"></i>
                            Any Supported File
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Toolbar -->
        <div class="toolbar">
            <div class="toolbar-section">
                <label for="chromosomeSelect">Chromosome:</label>
                <select id="chromosomeSelect" class="select">
                    <option value="">Select chromosome...</option>
                </select>
            </div>
            <div class="toolbar-section">
                <label>Zoom:</label>
                <button id="zoomInBtn" class="btn btn-sm">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button id="zoomOutBtn" class="btn btn-sm">
                    <i class="fas fa-search-minus"></i>
                </button>
                <button id="resetZoomBtn" class="btn btn-sm">Reset</button>
            </div>
            <div class="toolbar-section">
                <label>Tracks:</label>
                <button id="toggleTracks" class="btn btn-sm toggle-btn">
                    <i class="fas fa-eye"></i>
                </button>
                <div class="track-checkboxes" id="trackCheckboxes" style="display: none;">
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackGenes" value="genes" checked> Genes & Features
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackSequence" value="sequence" checked> Sequence (Top)
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackGC" value="gc" checked> GC Content
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackVariants" value="variants"> VCF Variants
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackReads" value="reads"> Aligned Reads
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackProteins" value="proteins"> Proteins
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackBottomSequence" value="bottomSequence" checked> Sequence (Bottom)
                    </label>
                </div>
            </div>
            <div class="toolbar-section">
                <label>Show Features:</label>
                <button id="toggleFeatureFilters" class="btn btn-sm toggle-btn">
                    <i class="fas fa-filter"></i>
                </button>
                <div class="feature-filter-checkboxes" id="featureFilterCheckboxes" style="display: none;">
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showGenes" checked> Genes
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showCDS" checked> CDS
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showMRNA" checked> mRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showTRNA" checked> tRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showRRNA" checked> rRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showPromoter" checked> Promoters
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showTerminator" checked> Terminators
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showRegulatory" checked> Regulatory
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showOther" checked> Other
                    </label>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-section" id="fileInfoSection">
                    <div class="section-header">
                        <h3>File Information</h3>
                        <button class="close-panel-btn" data-panel="fileInfoSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="fileInfo" class="file-info">
                        <p class="no-file">No file loaded</p>
                    </div>
                </div>
                
                <div class="sidebar-section" id="navigationSection">
                    <div class="section-header">
                        <h3>Navigation</h3>
                        <button class="close-panel-btn" data-panel="navigationSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="navigation-controls">
                        <button id="prevBtn" class="btn btn-block">
                            <i class="fas fa-chevron-left"></i>
                            Previous
                        </button>
                        <button id="nextBtn" class="btn btn-block">
                            Next
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="sidebar-section" id="statisticsSection">
                    <div class="section-header">
                        <h3>Statistics</h3>
                        <button class="close-panel-btn" data-panel="statisticsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="stats" class="stats">
                        <div class="stat-item">
                            <span class="stat-label">Length:</span>
                            <span class="stat-value" id="sequenceLength">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">GC Content:</span>
                            <span class="stat-value" id="gcContent">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Current Position:</span>
                            <span class="stat-value" id="currentPosition">-</span>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section" id="tracksSection">
                    <div class="section-header">
                        <h3>Tracks</h3>
                        <button class="close-panel-btn" data-panel="tracksSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="track-controls">
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackGenes" value="genes" checked>
                            <span>Genes & Features Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackSequence" value="sequence" checked>
                            <span>Sequence Track (Top)</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackGC" value="gc" checked>
                            <span>GC Content Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackVariants" value="variants">
                            <span>VCF Variants Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackReads" value="reads">
                            <span>Aligned Reads Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackProteins" value="proteins">
                            <span>Protein Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackBottomSequence" value="bottomSequence" checked>
                            <span>Sequence Track (Bottom)</span>
                        </label>
                    </div>
                </div>

                <div class="sidebar-section" id="featuresSection">
                    <div class="section-header">
                        <h3>Show Features</h3>
                        <button class="close-panel-btn" data-panel="featuresSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="feature-controls">
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowGenes" checked>
                            <span>Genes</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowCDS" checked>
                            <span>CDS</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowMRNA" checked>
                            <span>mRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowTRNA" checked>
                            <span>tRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowRRNA" checked>
                            <span>rRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowPromoter" checked>
                            <span>Promoters</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowTerminator" checked>
                            <span>Terminators</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowRegulatory" checked>
                            <span>Regulatory Sites</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowOther" checked>
                            <span>Other Features</span>
                        </label>
                    </div>
                </div>
            </aside>

            <!-- Viewer Area -->
            <div class="viewer-container" id="viewerContainer">
                <!-- Navigation Controls for Genome View -->
                <div class="genome-navigation" id="genomeNavigation" style="display: none;">
                    <button id="prevBtnGenome" class="nav-btn nav-btn-left">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button id="nextBtnGenome" class="nav-btn nav-btn-right">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <!-- Main Genome Viewer Section -->
                <div class="genome-viewer-section" id="genomeViewerSection">
                    <div id="genomeViewer" class="genome-viewer">
                        <div class="welcome-screen">
                            <div class="welcome-content">
                                <i class="fas fa-dna welcome-icon"></i>
                                <h2>Welcome to Genome Browser</h2>
                                <p>Choose a file type to start exploring</p>
                                <div class="welcome-buttons">
                                    <button id="welcomeOpenGenomeBtn" class="btn btn-primary btn-lg">
                                        <i class="fas fa-dna"></i>
                                        Genome File
                                    </button>
                                    <button id="welcomeOpenAnnotationBtn" class="btn btn-secondary btn-lg">
                                        <i class="fas fa-tags"></i>
                                        Annotation File
                                    </button>
                                    <button id="welcomeOpenVariantBtn" class="btn btn-secondary btn-lg">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        Variant File
                                    </button>
                                    <button id="welcomeOpenReadsBtn" class="btn btn-secondary btn-lg">
                                        <i class="fas fa-align-left"></i>
                                        Reads File
                                    </button>
                                </div>
                                <p class="welcome-note">
                                    <small>Supported formats: FASTA, GenBank, GFF, BED, VCF, SAM/BAM</small>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Resizable Splitter -->
                <div class="splitter" id="splitter" style="display: none;"></div>
                
                <!-- Bottom Sequence Display Section -->
                <div class="sequence-display-section" id="sequenceDisplaySection" style="display: none;">
                    <div id="sequenceDisplay" class="sequence-display">
                        <div class="sequence-header">
                            <h4 id="sequenceTitle">Sequence View</h4>
                            <div class="sequence-controls">
                                <button id="copySequenceBtn" class="btn btn-sm">
                                    <i class="fas fa-copy"></i>
                                    Copy
                                </button>
                                <button id="exportBtn" class="btn btn-sm">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                        <div id="sequenceContent" class="sequence-content"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="statusText">Ready</span>
            </div>
            <div class="status-right">
                <span id="coordinateDisplay">Position: -</span>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search Sequence</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="modalSearchInput" placeholder="Enter sequence to search..." class="input-full">
                <div class="search-options">
                    <label>
                        <input type="checkbox" id="caseSensitive"> Case sensitive
                    </label>
                    <label>
                        <input type="checkbox" id="reverseComplement"> Include reverse complement
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modalSearchBtn" class="btn btn-primary">Search</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <div id="gotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Go to Position</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="modalPositionInput" placeholder="Chr:start-end or position" class="input-full">
                <p class="help-text">Examples: chr1:1000-2000, 1500, chr2:500000</p>
            </div>
            <div class="modal-footer">
                <button id="modalGotoBtn" class="btn btn-primary">Go</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Loading genome data...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/igv@2.15.8/dist/igv.min.js"></script>
    <script src="renderer.js"></script>
</body>
</html> 