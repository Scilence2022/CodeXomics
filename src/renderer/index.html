<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: file: https: http:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https: http: data: blob:; style-src 'self' 'unsafe-inline' https: http: data:; img-src 'self' data: blob: https: http: file:; font-src 'self' https: http: data:; connect-src 'self' https: http: ws: wss: data: blob:;">
    <title>Genome AI Studio</title>
    <!-- Modular CSS Architecture -->
    <link rel="stylesheet" href="css/base.css">
    <!-- <link rel="stylesheet" href="css/main-legacy.css"> -->
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/actions.css">
    <link rel="stylesheet" href="css/buttons.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/genome-browser.css">
    <link rel="stylesheet" href="css/gene-tracks.css">
    <link rel="stylesheet" href="css/sequence-tracks.css">
    <link rel="stylesheet" href="css/canvas-sequence-optimization.css">
    <link rel="stylesheet" href="css/canvas-reads-optimization.css">
    <link rel="stylesheet" href="css/track-drag-drop.css">
    <link rel="stylesheet" href="css/wheel-zoom.css">
    <!-- <link rel="stylesheet" href="css/main-legacy.css"> -->
    <link rel="stylesheet" href="css/chatbox-enhancements.css">
    <link rel="stylesheet" href="css/llm-config.css">
    <link rel="stylesheet" href="styles.css">

    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="app-title">
                    <i class="fas fa-dna"></i>
                    Genome AI Studio
                    <span class="version-tag" id="version-tag">v0.3 beta</span>
                </h1>
            </div>
            <div class="header-center">
                <button id="blastBtn" class="btn btn-primary" title="Open BLAST Search">
                    <i class="fas fa-search"></i>
                    BLAST
                </button>
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search gene names or sequences..." class="search-input">
                    <button id="searchBtn" class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div class="position-container">
                    <input type="text" id="positionInput" placeholder="Chr:start-end" class="position-input">
                    <button id="goToBtn" class="goto-btn">Go</button>
                </div>
            </div>
            <div class="header-right">
                <div class="mcp-server-controls">
                    <button id="mcpServerBtn" class="btn btn-sm" title="Start/Stop MCP Server">
                        <i class="fas fa-server"></i>
                        <span id="mcpServerStatus">Start</span>
                    </button>
                    <div class="mcp-status-indicator" id="mcpStatusIndicator">
                        <span class="status-dot status-stopped"></span>
                        <span class="status-text">Stopped</span>
                    </div>
                </div>
                

                <div class="file-menu-container">
                    <button id="optionsBtn" class="btn btn-secondary dropdown-toggle">
                        <i class="fas fa-cog"></i>
                        Options
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="optionsDropdownMenu">
                        <button class="dropdown-item" id="configureLLMBtn">
                            <i class="fas fa-robot"></i>
                            Configure LLMs
                        </button>
                        <button class="dropdown-item" id="multiAgentSettingsBtn">
                            <i class="fas fa-users-cog"></i>
                            Multi-Agent Settings
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="mcpSettingsBtn">
                            <i class="fas fa-server"></i>
                            MCP Server Settings
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="settingsBtn">
                            <i class="fas fa-sliders-h"></i>
                            General Settings
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="debugToolsBtn">
                            <i class="fas fa-bug"></i>
                            Debug Tools
                        </button>
                    </div>
                </div>
                
                <div class="file-menu-container">
                    <button id="openFileBtn" class="btn btn-primary dropdown-toggle">
                        <i class="fas fa-folder-open"></i>
                        Load File
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="fileDropdownMenu">
                        <button class="dropdown-item" id="openGenomeBtn">
                            <i class="fas fa-dna"></i>
                            Genome File (FASTA, GenBank)
                        </button>
                        <button class="dropdown-item" id="openAnnotationBtn">
                            <i class="fas fa-tags"></i>
                            Annotation File (GFF, BED)
                        </button>
                        <button class="dropdown-item" id="openVariantBtn">
                            <i class="fas fa-exclamation-triangle"></i>
                            Variant File (VCF)
                        </button>
                        <button class="dropdown-item" id="openReadsBtn">
                            <i class="fas fa-align-left"></i>
                            Reads File (SAM/BAM)
                        </button>
                        <button class="dropdown-item" id="openWIGBtn">
                            <i class="fas fa-chart-line"></i>
                            WIG Tracks (Multiple Files Supported)
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="openAnyBtn">
                            <i class="fas fa-file"></i>
                            Any Supported File
                        </button>
                    </div>
                </div>
                
                <div class="file-menu-container">
                    <button id="exportFileBtn" class="btn btn-secondary dropdown-toggle" disabled>
                        <i class="fas fa-download"></i>
                        Export As
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="exportDropdownMenu">
                        <button class="dropdown-item" id="exportFastaBtn">
                            <i class="fas fa-dna"></i>
                            FASTA Sequence
                        </button>
                        <button class="dropdown-item" id="exportGenbankBtn">
                            <i class="fas fa-file-alt"></i>
                            GenBank Format
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="exportCDSFastaBtn">
                            <i class="fas fa-code"></i>
                            CDS FASTA
                        </button>
                        <button class="dropdown-item" id="exportProteinFastaBtn">
                            <i class="fas fa-shapes"></i>
                            Protein FASTA
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="exportGFFBtn">
                            <i class="fas fa-tags"></i>
                            GFF Annotations
                        </button>
                        <button class="dropdown-item" id="exportBEDBtn">
                            <i class="fas fa-bed"></i>
                            BED Format
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="exportCurrentViewBtn">
                            <i class="fas fa-eye"></i>
                            Current View (FASTA)
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tab Bar -->
        <div class="tab-bar" id="tabBar">
            <div class="tab-container" id="tabContainer">
                <!-- Tabs will be dynamically added here -->
            </div>
            <button class="new-tab-button" id="newTabButton" title="New Genome Analysis">
                <i class="fas fa-plus"></i>
            </button>
            <button class="tab-settings-button" id="tabSettingsButton" title="Tab Settings">
                <i class="fas fa-cog"></i>
            </button>
        </div>

        <!-- Toolbar -->
        <div class="toolbar">
            <div class="toolbar-section">
                <label>Sidebar:</label>
                <button id="toggleSidebar" class="btn btn-sm toggle-btn">
                    <i class="fas fa-sidebar"></i>
                </button>
            </div>
            <div class="toolbar-section">
                <label for="chromosomeSelect">Chromosome:</label>
                <select id="chromosomeSelect" class="select">
                    <option value="">Select chromosome...</option>
                </select>
            </div>
            <div class="toolbar-section">
                <label>Zoom:</label>
                <button id="zoomInBtn" class="btn btn-sm">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button id="zoomOutBtn" class="btn btn-sm">
                    <i class="fas fa-search-minus"></i>
                </button>
                <button id="resetZoomBtn" class="btn btn-sm">Reset</button>
            </div>

            <div class="toolbar-section">
                <button id="actionsMenuBtn" class="btn btn-sm toggle-btn" title="Sequence Actions">
                    <i class="fas fa-cut"></i>
                    <span>Actions</span>
                </button>
                <div class="actions-dropdown" id="actionsDropdown" style="display: none;">
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-clipboard"></i>
                            Sequence Operations
                        </div>
                        <button id="copySequenceBtn" class="dropdown-feature-btn" title="Copy Sequence">
                            <i class="fas fa-copy"></i>
                            Copy
                        </button>
                        <button id="cutSequenceBtn" class="dropdown-feature-btn" title="Cut Sequence">
                            <i class="fas fa-cut"></i>
                            Cut
                        </button>
                        <button id="pasteSequenceBtn" class="dropdown-feature-btn" title="Paste Sequence">
                            <i class="fas fa-paste"></i>
                            Paste
                        </button>
                        <button id="deleteSequenceBtn" class="dropdown-feature-btn" title="Delete Sequence">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                    </div>
                    
                    <div class="dropdown-divider"></div>
                    
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-list"></i>
                            Action Management
                        </div>
                        <button id="showActionListBtn" class="dropdown-feature-btn" title="Show Action List">
                            <i class="fas fa-list"></i>
                            Action List
                        </button>
                        <button id="executeActionsBtn" class="dropdown-feature-btn" title="Execute Actions">
                            <i class="fas fa-play"></i>
                            Execute All
                        </button>
                    </div>
                    
                    <div class="dropdown-divider"></div>
                    
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-save"></i>
                            Checkpoint System
                        </div>
                        <button id="createCheckpointBtn" class="dropdown-feature-btn" title="Create Checkpoint">
                            <i class="fas fa-save"></i>
                            Create Checkpoint
                        </button>
                        <button id="rollbackBtn" class="dropdown-feature-btn" title="Rollback">
                            <i class="fas fa-undo"></i>
                            Rollback
                        </button>
                    </div>
                </div>
            </div>

            <div class="toolbar-section">
                <!-- <label>Tracks:</label> -->
                <button id="toggleTracks" class="btn btn-sm toggle-btn">
                    <i class="fas fa-eye"></i>
                    <span>Tracks</span>
                </button>
                <div class="track-checkboxes" id="trackCheckboxes" style="display: none;">
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackGenes" value="genes" checked> Genes & Features
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackGC" value="gc" checked> GC Content
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackVariants" value="variants"> VCF Variants
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackReads" value="reads"> Aligned Reads
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackWIG" value="wigTracks"> WIG Tracks
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackProteins" value="proteins"> Proteins
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackSequence" value="sequence" checked> Bottom Sequence Panel
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackSequenceLine" value="sequenceLine"> Single-line Sequence Track
                    </label>
                    <label class="track-checkbox">
                        <input type="checkbox" id="trackActions" value="actions"> Actions
                    </label>
                </div>
            </div>
          
            
            <div class="toolbar-section">
                <button id="toggleFeatureFilters" class="btn btn-sm toggle-btn">
                    <i class="fas fa-filter"></i>
                    <span>Features</span>
                </button>
               
                <div class="feature-filter-checkboxes" id="featureFilterCheckboxes" style="display: none;">
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showGenes"> Genes
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showCDS" checked> CDS
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showMRNA" checked> mRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showTRNA" checked> tRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showRRNA" checked> rRNA
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showPromoter" checked> Promoters
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showTerminator" checked> Terminators
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showRegulatory" checked> Regulatory
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showSource"> Source
                    </label>
                    <label class="feature-checkbox">
                        <input type="checkbox" id="showOther" checked> Other Features
                    </label>
                </div>
            </div>
            
            <div class="toolbar-section">
                <button id="addFeaturesBtn" class="btn btn-sm toggle-btn" title="Add Features">
                    <i class="fas fa-plus"></i>
                    <span>Add Features</span>
                </button>
                <div class="add-features-dropdown" id="addFeaturesDropdown" style="display: none;">
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-dna"></i>
                            Gene Elements
                        </div>
                        <button class="dropdown-feature-btn" data-type="gene" title="Add Gene">
                            <i class="fas fa-dna"></i>
                            Gene
                        </button>
                        <button class="dropdown-feature-btn" data-type="CDS" title="Add Coding Sequence">
                            <i class="fas fa-code"></i>
                            CDS (Coding Sequence)
                        </button>
                        <button class="dropdown-feature-btn" data-type="mRNA" title="Add mRNA">
                            <i class="fas fa-share"></i>
                            mRNA
                        </button>
                    </div>
                    
                    <div class="dropdown-divider"></div>
                    
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-cog"></i>
                            RNA Elements
                        </div>
                        <button class="dropdown-feature-btn" data-type="rRNA" title="Add Ribosomal RNA">
                            <i class="fas fa-cog"></i>
                            rRNA (Ribosomal RNA)
                        </button>
                        <button class="dropdown-feature-btn" data-type="tRNA" title="Add Transfer RNA">
                            <i class="fas fa-exchange-alt"></i>
                            tRNA (Transfer RNA)
                        </button>
                    </div>
                    
                    <div class="dropdown-divider"></div>
                    
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-sliders-h"></i>
                            Regulatory Elements
                        </div>
                        <button class="dropdown-feature-btn" data-type="promoter" title="Add Promoter">
                            <i class="fas fa-play"></i>
                            Promoter
                        </button>
                        <button class="dropdown-feature-btn" data-type="terminator" title="Add Terminator">
                            <i class="fas fa-stop"></i>
                            Terminator
                        </button>
                        <button class="dropdown-feature-btn" data-type="regulatory" title="Add Regulatory Element">
                            <i class="fas fa-sliders-h"></i>
                            Regulatory Element
                        </button>
                    </div>
                    
                    <div class="dropdown-divider"></div>
                    
                    <div class="dropdown-section">
                        <div class="dropdown-section-title">
                            <i class="fas fa-tags"></i>
                            Other Features
                        </div>
                        <button class="dropdown-feature-btn" data-type="misc_feature" title="Add Miscellaneous Feature">
                            <i class="fas fa-tag"></i>
                            Miscellaneous Feature
                        </button>
                        <button class="dropdown-feature-btn" data-type="repeat_region" title="Add Repeat Region">
                            <i class="fas fa-sync"></i>
                            Repeat Region
                        </button>
                        <button class="dropdown-feature-btn" data-type="comment" title="Add Comment/Note">
                            <i class="fas fa-comment"></i>
                            Comment/Note
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-section" id="geneDetailsSection" style="display: none;">
                    <div class="section-header">
                        <h3>Gene Details</h3>
                        <button class="close-panel-btn" data-panel="geneDetailsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="geneDetailsContent" class="gene-details-content">
                        <div class="no-gene-selected">
                            <i class="fas fa-dna gene-icon"></i>
                            <p>Click on a gene in the Genes & Features track to view details</p>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section" id="readDetailsSection" style="display: none;">
                    <div class="section-header">
                        <h3>Read Details</h3>
                        <button class="close-panel-btn" data-panel="readDetailsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="readDetailsContent" class="read-details-content">
                        <div class="no-read-selected">
                            <i class="fas fa-align-left read-icon"></i>
                            <p>Click on a read in the Aligned Reads track to view details</p>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section" id="variantDetailsSection" style="display: none;">
                    <div class="section-header">
                        <h3>Variant Details</h3>
                        <button class="close-panel-btn" data-panel="variantDetailsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="variantDetailsContent" class="variant-details-content">
                        <div class="no-variant-selected">
                            <i class="fas fa-dna variant-icon"></i>
                            <p>Click on a variant in the VCF track to view detailed analysis</p>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section" id="searchResultsSection" style="display: none;">
                    <div class="section-header">
                        <h3>Search Results</h3>
                        <button class="close-panel-btn" data-panel="searchResultsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="searchResultsList" class="search-results-list">
                        <p class="no-results">No search results</p>
                    </div>
                </div>

                <div class="sidebar-section" id="operonsSection">
                    <div class="section-header">
                        <h3>Operons in View</h3>
                        <button class="close-panel-btn" data-panel="operonsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="operonsList" class="operons-list">
                        <p class="no-operons">No operons detected in current view</p>
                    </div>
                </div>

                <div class="sidebar-section" id="tracksSection">
                    <div class="section-header">
                        <h3>Tracks</h3>
                        <button class="close-panel-btn" data-panel="tracksSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="track-controls">
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackGenes" value="genes" checked>
                            <span>Genes & Features Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackGC" value="gc" checked>
                            <span>GC Content Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackVariants" value="variants">
                            <span>VCF Variants Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackReads" value="reads">
                            <span>Aligned Reads Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackWIG" value="wigTracks">
                            <span>WIG Tracks</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackProteins" value="proteins">
                            <span>Protein Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackSequence" value="sequence" checked>
                            <span>Bottom Sequence Panel</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackSequenceLine" value="sequenceLine">
                            <span>Single-line Sequence Track</span>
                        </label>
                        <label class="track-control-item">
                            <input type="checkbox" id="sidebarTrackActions" value="actions">
                            <span>Actions Track</span>
                        </label>
                    </div>
                </div>

                <div class="sidebar-section" id="featuresSection">
                    <div class="section-header">
                        <h3>Show Features</h3>
                        <button class="close-panel-btn" data-panel="featuresSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="feature-controls">
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowGenes">
                            <span>Genes</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowCDS" checked>
                            <span>CDS</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowMRNA" checked>
                            <span>mRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowTRNA" checked>
                            <span>tRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowRRNA" checked>
                            <span>rRNA</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowPromoter" checked>
                            <span>Promoters</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowTerminator" checked>
                            <span>Terminators</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowRegulatory" checked>
                            <span>Regulatory Sites</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowSource">
                            <span>Source Features</span>
                        </label>
                        <label class="feature-control-item">
                            <input type="checkbox" id="sidebarShowOther" checked>
                            <span>Other Features</span>
                        </label>
                    </div>
                </div>
                
                <div class="sidebar-section" id="fileInfoSection">
                    <div class="section-header">
                        <h3>File Information</h3>
                        <button class="close-panel-btn" data-panel="fileInfoSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="fileInfo" class="file-info">
                        <p class="no-file">No file loaded</p>
                    </div>
                </div>
                
                <div class="sidebar-section" id="navigationSection">
                    <div class="section-header">
                        <h3>Navigation</h3>
                        <button class="close-panel-btn" data-panel="navigationSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="navigation-controls">
                        <button id="prevBtn" class="btn btn-block">
                            <i class="fas fa-chevron-left"></i>
                            Previous
                        </button>
                        <button id="nextBtn" class="btn btn-block">
                            Next
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>

                <div class="sidebar-section" id="statisticsSection">
                    <div class="section-header">
                        <h3>Statistics</h3>
                        <button class="close-panel-btn" data-panel="statisticsSection">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="stats" class="stats">
                        <div class="stat-item">
                            <span class="stat-label">Length:</span>
                            <span class="stat-value" id="sequenceLength">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">GC Content:</span>
                            <span class="stat-value" id="gcContent">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Current Position:</span>
                            <span class="stat-value" id="currentPosition">-</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Vertical Splitter for Sidebar Resizing -->
            <div class="sidebar-splitter" id="sidebarSplitter">
                <div class="sidebar-splitter-handle">â‹®</div>
            </div>
            <!-- Horizontal Splitter -->
            <div class="horizontal-splitter" id="horizontalSplitter" style="display: flex;">
                <button class="splitter-toggle-btn" id="splitterToggleBtn" title="Toggle Sidebar">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <!-- Viewer Area -->
            <div class="viewer-container" id="viewerContainer">
                <!-- Navigation Controls for Genome View -->
                <div class="genome-navigation" id="genomeNavigation" style="display: none;">
                    <button id="prevBtnGenome" class="nav-btn nav-btn-left">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button id="nextBtnGenome" class="nav-btn nav-btn-right">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <!-- Main Genome Viewer Section -->
                <div class="genome-viewer-section" id="genomeViewerSection">
                    <div id="genomeViewer" class="genome-viewer"> 
                        
                    </div>
                </div>
            
            <div class="welcome-screen">
                <div class="welcome-content">
                    <i class="fas fa-dna welcome-icon"></i>
                    <h2>Welcome to Genome AI Studio</h2>
                    <p>Choose a file type to start exploring</p>
                    <div class="welcome-buttons">
                        <button id="welcomeOpenGenomeBtn" class="btn btn-primary btn-lg">
                            <i class="fas fa-dna"></i>
                            Genome File
                        </button>
                        <button id="welcomeOpenAnnotationBtn" class="btn btn-secondary btn-lg">
                            <i class="fas fa-tags"></i>
                            Annotation File
                        </button>
                        <button id="welcomeOpenVariantBtn" class="btn btn-secondary btn-lg">
                            <i class="fas fa-exclamation-triangle"></i>
                            Variant File
                        </button>
                        <button id="welcomeOpenReadsBtn" class="btn btn-secondary btn-lg">
                            <i class="fas fa-align-left"></i>
                            Reads File
                        </button>
                        <button id="welcomeOpenWIGBtn" class="btn btn-secondary btn-lg">
                            <i class="fas fa-chart-line"></i>
                            WIG Tracks
                        </button>
                    </div>
                    <p class="welcome-note">
                        <small>Supported formats: FASTA, GenBank, GFF, BED, VCF, SAM/BAM, WIG</small>
                    </p>
                </div>
            </div>
                


                
                <!-- Resizable Splitter -->
                <div class="splitter" id="splitter" style="display: none;"></div>
                
                <!-- Bottom Sequence Display Section -->
                <div class="sequence-display-section" id="sequenceDisplaySection" style="display: none;">
                    <div id="sequenceDisplay" class="sequence-display">
                        <div class="sequence-header">
                            <h4 id="sequenceTitle">Sequence View</h4>
                            <div class="sequence-controls">
                                <button id="sequenceSettingsBtn" class="btn btn-sm" title="Sequence Settings">
                                    <i class="fas fa-cog"></i>
                                    Settings
                                </button>
                                <button id="copySequenceHeaderBtn" class="btn btn-sm">
                                    <i class="fas fa-copy"></i>
                                    Copy
                                </button>
                                <button id="exportBtn" class="btn btn-sm">
                                    <i class="fas fa-download"></i>
                                    Export
                                </button>
                            </div>
                        </div>
                        <div id="sequenceContent" class="sequence-content"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div class="status-left">
                <span id="statusText">Ready</span>
            </div>
            <div class="status-center">
                <span id="cursorStatus">Cursor: Click on sequence to position</span>
            </div>
            <div class="status-right">
                <span id="coordinateDisplay">Position: -</span>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search Sequence</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="modalSearchInput" placeholder="Enter gene name or DNA sequence..." class="input-full">
                <div class="search-options">
                    <label>
                        <input type="checkbox" id="caseSensitive"> Case sensitive
                    </label>
                    <label>
                        <input type="checkbox" id="reverseComplement"> Include reverse complement
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modalSearchBtn" class="btn btn-primary">Search</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <div id="gotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Go to Position</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="modalPositionInput" placeholder="Chr:start-end or position" class="input-full">
                <p class="help-text">Examples: chr1:1000-2000, 1500, chr2:500000</p>
            </div>
            <div class="modal-footer">
                <button id="modalGotoBtn" class="btn btn-primary">Go</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Feature Modal -->
    <div id="addFeatureModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="addFeatureModalTitle">Add Feature</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="featureType">Feature Type:</label>
                    <select id="featureType" class="select">
                        <option value="gene">Gene</option>
                        <option value="CDS">CDS (Coding Sequence)</option>
                        <option value="mRNA">mRNA</option>
                        <option value="rRNA">rRNA (Ribosomal RNA)</option>
                        <option value="tRNA">tRNA (Transfer RNA)</option>
                        <option value="promoter">Promoter</option>
                        <option value="terminator">Terminator</option>
                        <option value="regulatory">Regulatory Element</option>
                        <option value="misc_feature">Miscellaneous Feature</option>
                        <option value="repeat_region">Repeat Region</option>
                        <option value="comment">Comment/Note</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="featureName">Name/Label:</label>
                    <input type="text" id="featureName" placeholder="Enter feature name..." class="input-full">
                </div>
                <div class="form-group">
                    <label for="featureChromosome">Chromosome:</label>
                    <select id="featureChromosome" class="select"></select>
                </div>
                <div class="form-group">
                    <label for="featureStart">Start Position:</label>
                    <input type="number" id="featureStart" min="1" class="input-full">
                </div>
                <div class="form-group">
                    <label for="featureEnd">End Position:</label>
                    <input type="number" id="featureEnd" min="1" class="input-full">
                </div>
                <div class="form-group">
                    <label for="featureStrand">Strand:</label>
                    <select id="featureStrand" class="select">
                        <option value="1">Forward (+)</option>
                        <option value="-1">Reverse (-)</option>
                        <option value="0">Both/Unknown</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="featureDescription">Description (optional):</label>
                    <textarea id="featureDescription" placeholder="Enter feature description..." class="input-full" rows="3"></textarea>
                </div>
                <div class="form-group" id="sequenceSelectionInfo" style="display: none;">
                    <div class="selection-info">
                        <i class="fas fa-info-circle"></i>
                        <span id="selectionText">Using selected sequence region</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="addFeatureBtn" class="btn btn-primary">Add Feature</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- LLM Configuration Modal -->
    <div id="llmConfigModal" class="modal">
        <div class="modal-content llm-config-modal">
            <div class="modal-header">
                <h3>Configure LLMs</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="llm-provider-tabs">
                    <button class="tab-button active" data-provider="openai">OpenAI</button>
                    <button class="tab-button" data-provider="anthropic">Anthropic</button>
                    <button class="tab-button" data-provider="google">Google</button>
                    <button class="tab-button" data-provider="deepseek">DeepSeek</button>
                    <button class="tab-button" data-provider="siliconflow">SiliconFlow</button>
                    <button class="tab-button" data-provider="local">Local LLM</button>
                    <button class="tab-button" data-provider="custom">Custom</button>
                </div>
                
                <div class="llm-provider-config">
                    <!-- OpenAI Configuration -->
                    <div id="openai-config" class="provider-config active">
                        <div class="form-group">
                            <label for="openaiApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="password" id="openaiApiKey" placeholder="sk-..." class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteOpenaiApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a></small>
                        </div>
                        <div class="form-group">
                            <label for="openaiModel">Model:</label>
                            <select id="openaiModel" class="select">
                                <option value="gpt-4o">GPT-4o</option>
                                <option value="gpt-4o-mini">GPT-4o Mini</option>
                                <option value="gpt-4">GPT-4</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="openaiBaseUrl">Base URL (optional):</label>
                            <input type="text" id="openaiBaseUrl" placeholder="https://api.openai.com/v1" class="input-full">
                        </div>
                    </div>
                    
                    <!-- Anthropic Configuration -->
                    <div id="anthropic-config" class="provider-config">
                        <div class="form-group">
                            <label for="anthropicApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="password" id="anthropicApiKey" placeholder="sk-ant-..." class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteAnthropicApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">Get your API key from <a href="https://console.anthropic.com/" target="_blank">Anthropic Console</a></small>
                        </div>
                        <div class="form-group">
                            <label for="anthropicModel">Model:</label>
                            <select id="anthropicModel" class="select">
                                <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet</option>
                                <option value="claude-3-opus-20240229">Claude 3 Opus</option>
                                <option value="claude-3-haiku-20240307">Claude 3 Haiku</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="anthropicBaseUrl">Base URL (optional):</label>
                            <input type="text" id="anthropicBaseUrl" placeholder="https://api.anthropic.com" class="input-full">
                        </div>
                    </div>
                    
                    <!-- Google Configuration -->
                    <div id="google-config" class="provider-config">
                        <div class="form-group">
                            <label for="googleApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="text" id="googleApiKey" placeholder="AI..." class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteGoogleApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">Get your API key from <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></small>
                        </div>
                        <div class="form-group">
                            <label for="googleModel">Model:</label>
                            <select id="googleModel" class="select">
                                <option value="gemini-2.0-flash">Gemini 2.0 Flash (New)</option>
                                <option value="gemini-1.5-pro-latest">Gemini 1.5 Pro (Latest)</option>
                                <option value="gemini-1.5-flash-latest">Gemini 1.5 Flash (Latest)</option>
                                <option value="gemini-pro">Gemini 1.0 Pro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="googleBaseUrl">Base URL (optional):</label>
                            <input type="text" id="googleBaseUrl" placeholder="https://generativelanguage.googleapis.com" class="input-full">
                        </div>
                    </div>
                    
                    <!-- DeepSeek Configuration -->
                    <div id="deepseek-config" class="provider-config">
                        <div class="form-group">
                            <label for="deepseekApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="password" id="deepseekApiKey" placeholder="sk-..." class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteDeepseekApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">Get your API key from <a href="https://platform.deepseek.com/" target="_blank">DeepSeek Platform</a></small>
                        </div>
                        <div class="form-group">
                            <label for="deepseekModel">Model:</label>
                            <select id="deepseekModel" class="select">
                                <option value="deepseek-chat">DeepSeek Chat</option>
                                <option value="deepseek-coder">DeepSeek Coder</option>
                                <option value="deepseek-reasoner">DeepSeek Reasoner</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="deepseekBaseUrl">Base URL (optional):</label>
                            <input type="text" id="deepseekBaseUrl" placeholder="https://api.deepseek.com/v1" class="input-full">
                        </div>
                    </div>
                    
                    <!-- SiliconFlow Configuration -->
                    <div id="siliconflow-config" class="provider-config">
                        <div class="form-group">
                            <label for="siliconflowApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="password" id="siliconflowApiKey" placeholder="sk-..." class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteSiliconflowApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">Get your API key from <a href="https://siliconflow.cn/" target="_blank">SiliconFlow Platform</a></small>
                        </div>
                        <div class="form-group">
                            <label for="siliconflowModel">Model:</label>
                            <select id="siliconflowModel" class="select">
                                <!-- DeepSeek Models -->
                                <optgroup label="DeepSeek Models">
                                    <option value="Pro/deepseek-ai/DeepSeek-R1">DeepSeek-R1 (Pro)</option>
                                    <option value="Pro/deepseek-ai/DeepSeek-V3">DeepSeek-V3 (Pro)</option>
                                    <option value="deepseek-ai/DeepSeek-R1">DeepSeek-R1</option>
                                    <option value="deepseek-ai/DeepSeek-V3">DeepSeek-V3</option>
                                    <option value="deepseek-ai/DeepSeek-R1-0528-Qwen3-8B">DeepSeek-R1-0528-Qwen3-8B</option>
                                    <option value="deepseek-ai/DeepSeek-R1-Distill-Qwen-32B">DeepSeek-R1-Distill-Qwen-32B</option>
                                    <option value="deepseek-ai/DeepSeek-R1-Distill-Qwen-14B">DeepSeek-R1-Distill-Qwen-14B</option>
                                    <option value="deepseek-ai/DeepSeek-R1-Distill-Qwen-7B">DeepSeek-R1-Distill-Qwen-7B</option>
                                    <option value="Pro/deepseek-ai/DeepSeek-R1-Distill-Qwen-7B">DeepSeek-R1-Distill-Qwen-7B (Pro)</option>
                                    <option value="deepseek-ai/DeepSeek-V2.5">DeepSeek-V2.5</option>
                                </optgroup>
                                
                                <!-- Qwen Models -->
                                <optgroup label="Qwen Models">
                                    <option value="Qwen/Qwen3-235B-A22B-Thinking-2507">Qwen3-235B-A22B-Thinking-2507</option>
                                    <option value="Qwen/Qwen3-235B-A22B-Instruct-2507">Qwen3-235B-A22B-Instruct-2507</option>
                                    <option value="Qwen/Qwen3-32B">Qwen3-32B</option>
                                    <option value="Qwen/Qwen3-14B">Qwen3-14B</option>
                                    <option value="Qwen/Qwen3-8B">Qwen3-8B</option>
                                    <option value="Qwen/QwQ-32B">QwQ-32B</option>
                                    <option value="Qwen/QwQ-32B-Preview">QwQ-32B-Preview</option>
                                    <option value="Qwen/Qwen2.5-72B-Instruct-128K">Qwen2.5-72B-Instruct-128K</option>
                                    <option value="Qwen/Qwen2.5-72B-Instruct" selected>Qwen2.5-72B-Instruct</option>
                                    <option value="Qwen/Qwen2.5-32B-Instruct">Qwen2.5-32B-Instruct</option>
                                    <option value="Qwen/Qwen2.5-14B-Instruct">Qwen2.5-14B-Instruct</option>
                                    <option value="Qwen/Qwen2.5-7B-Instruct">Qwen2.5-7B-Instruct</option>
                                    <option value="Qwen/Qwen2.5-Coder-32B-Instruct">Qwen2.5-Coder-32B-Instruct</option>
                                    <option value="Qwen/Qwen2.5-Coder-7B-Instruct">Qwen2.5-Coder-7B-Instruct</option>
                                    <option value="Qwen/Qwen2-7B-Instruct">Qwen2-7B-Instruct</option>
                                    <option value="Qwen/Qwen2-1.5B-Instruct">Qwen2-1.5B-Instruct</option>
                                    <option value="Pro/Qwen/Qwen2.5-7B-Instruct">Qwen2.5-7B-Instruct (Pro)</option>
                                    <option value="Pro/Qwen/Qwen2-7B-Instruct">Qwen2-7B-Instruct (Pro)</option>
                                    <option value="Pro/Qwen/Qwen2-1.5B-Instruct">Qwen2-1.5B-Instruct (Pro)</option>
                                    <option value="Vendor-A/Qwen/Qwen2.5-72B-Instruct">Qwen2.5-72B-Instruct (Vendor-A)</option>
                                </optgroup>
                                
                                <!-- GLM Models -->
                                <optgroup label="GLM Models">
                                    <option value="THUDM/GLM-Z1-32B-0414">GLM-Z1-32B-0414</option>
                                    <option value="THUDM/GLM-4-32B-0414">GLM-4-32B-0414</option>
                                    <option value="THUDM/GLM-Z1-Rumination-32B-0414">GLM-Z1-Rumination-32B-0414</option>
                                    <option value="THUDM/GLM-4-9B-0414">GLM-4-9B-0414</option>
                                    <option value="THUDM/glm-4-9b-chat">GLM-4-9B-Chat</option>
                                    <option value="Pro/THUDM/chatglm3-6b">ChatGLM3-6B (Pro)</option>
                                    <option value="Pro/THUDM/glm-4-9b-chat">GLM-4-9B-Chat (Pro)</option>
                                </optgroup>
                                
                                <!-- Other Models -->
                                <optgroup label="Other Models">
                                    <option value="baidu/ERNIE-4.5-300B-A47B">ERNIE-4.5-300B-A47B</option>
                                    <option value="moonshotai/Kimi-K2-Instruct">Kimi-K2-Instruct</option>
                                    <option value="ascend-tribe/pangu-pro-moe">pangu-pro-moe</option>
                                    <option value="tencent/Hunyuan-A13B-Instruct">Hunyuan-A13B-Instruct</option>
                                    <option value="MiniMaxAI/MiniMax-M1-80k">MiniMax-M1-80k</option>
                                    <option value="Tongyi-Zhiwen/QwenLong-L1-32B">QwenLong-L1-32B</option>
                                    <option value="TeleAI/TeleChat2">TeleChat2</option>
                                    <option value="internlm/internlm2_5-7b-chat">InternLM2.5-7B-Chat</option>
                                    <option value="internlm/internlm2_5-20b-chat">InternLM2.5-20B-Chat</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="siliconflowBaseUrl">Base URL:</label>
                            <input type="text" id="siliconflowBaseUrl" value="https://api.siliconflow.cn/v1" class="input-full" readonly>
                            <small class="help-text">SiliconFlow API endpoint (read-only)</small>
                        </div>
                    </div>
                    
                    <!-- Local LLM Configuration -->
                    <div id="local-config" class="provider-config">
                        <div class="form-group">
                            <label for="localEndpoint">API Endpoint:</label>
                            <input type="text" id="localEndpoint" placeholder="http://localhost:11434/v1" class="input-full">
                            <small class="help-text">Local LLM endpoint (Ollama, LMStudio, etc.)</small>
                        </div>
                        <div class="form-group">
                            <label for="localModel">Model Name:</label>
                            <select id="localModel" class="select input-full">
                                <!-- Qwen3 Series (Latest Generation) -->
                                <optgroup label="Qwen3 Series (Latest)">
                                    <option value="qwen3:8b">qwen3:8b (Latest - 5.2GB)</option>
                                    <option value="qwen3:4b">qwen3:4b (2.6GB)</option>
                                    <option value="qwen3:1.7b">qwen3:1.7b (1.4GB)</option>
                                    <option value="qwen3:0.6b">qwen3:0.6b (523MB)</option>
                                    <option value="qwen3:14b">qwen3:14b (9.3GB)</option>
                                    <option value="qwen3:32b">qwen3:32b (20GB)</option>
                                    <option value="qwen3:30b">qwen3:30b-a3b (MoE 19GB)</option>
                                    <option value="qwen3:235b">qwen3:235b-a22b (MoE 142GB)</option>
                                </optgroup>
                                
                                <!-- DeepSeek-R1 Series (Latest Generation) -->
                                <optgroup label="DeepSeek-R1 Series (Latest)">
                                    <option value="deepseek-r1:8b">deepseek-r1:8b (Latest - 5.2GB)</option>
                                    <option value="deepseek-r1:7b">deepseek-r1:7b (4.7GB)</option>
                                    <option value="deepseek-r1:1.5b">deepseek-r1:1.5b (1.1GB)</option>
                                    <option value="deepseek-r1:14b">deepseek-r1:14b (9.0GB)</option>
                                    <option value="deepseek-r1:32b">deepseek-r1:32b (20GB)</option>
                                    <option value="deepseek-r1:70b">deepseek-r1:70b (43GB)</option>
                                    <option value="deepseek-r1:671b">deepseek-r1:671b (404GB)</option>
                                </optgroup>
                                
                                <!-- Legacy Models -->
                                <optgroup label="Legacy Models">
                                    <option value="qwen2:latest">qwen2:latest</option>
                                    <option value="mistral-large:latest">mistral-large:latest</option>
                                    <option value="llama3.1:70b">llama3.1:70b</option>
                                    <option value="llama3.1:latest">llama3.1:latest</option>
                                    <option value="llama3:latest">llama3:latest</option>
                                    <option value="gemma3:27b">gemma3:27b</option>
                                </optgroup>
                                
                                <option value="other">Other (specify below)</option>
                            </select>
                        </div>
                        <div class="form-group" id="localModelOtherGroup" style="display: none;">
                            <label for="localModelOther">Custom Model Name:</label>
                            <input type="text" id="localModelOther" placeholder="Enter custom model name" class="input-full">
                        </div>
                        <div class="form-group">
                            <label for="localApiKey">API Key (if required):</label>
                            <div class="input-with-button">
                                <input type="password" id="localApiKey" placeholder="Optional API key" class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteLocalApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="localStreamingSupport"> Streaming Support
                            </label>
                        </div>
                    </div>
                    
                    <!-- Custom LLM Configuration -->
                    <div id="custom-config" class="provider-config">
                        <div class="form-group">
                            <label for="customProviderName">Provider Name:</label>
                            <input type="text" id="customProviderName" placeholder="My Custom Provider" class="input-full">
                            <small class="help-text">A friendly name for your custom LLM provider</small>
                        </div>
                        <div class="form-group">
                            <label for="customApiKey">API Key:</label>
                            <div class="input-with-button">
                                <input type="password" id="customApiKey" placeholder="Enter your API key" class="input-full">
                                <button type="button" class="btn btn-sm btn-paste" id="pasteCustomApiKeyBtn" title="Paste API Key">
                                    <i class="fas fa-paste"></i>
                                </button>
                            </div>
                            <small class="help-text">API key for your custom provider</small>
                        </div>
                        <div class="form-group">
                            <label for="customModel">Model Name:</label>
                            <input type="text" id="customModel" placeholder="gpt-4" class="input-full">
                            <small class="help-text">Model identifier for your custom provider</small>
                        </div>
                        <div class="form-group">
                            <label for="customBaseUrl">Base URL:</label>
                            <input type="text" id="customBaseUrl" placeholder="https://api.example.com/v1" class="input-full">
                            <small class="help-text">Base URL for your custom provider's API</small>
                        </div>
                        <div class="form-group">
                            <label for="customApiFormat">API Format:</label>
                            <select id="customApiFormat" class="select">
                                <option value="openai">OpenAI Compatible</option>
                                <option value="anthropic">Anthropic Compatible</option>
                                <option value="google">Google Compatible</option>
                                <option value="custom">Custom Format</option>
                            </select>
                            <small class="help-text">Choose the API format your custom provider uses</small>
                        </div>
                        <div class="form-group">
                            <label for="customHeaders">Custom Headers (JSON):</label>
                            <textarea id="customHeaders" placeholder='{"Authorization": "Bearer token", "Content-Type": "application/json"}' class="input-full" rows="3"></textarea>
                            <small class="help-text">Optional: Custom HTTP headers as JSON object</small>
                        </div>
                        <div class="form-group">
                            <label for="customMaxTokens">Max Tokens:</label>
                            <input type="number" id="customMaxTokens" placeholder="4096" min="1" max="200000" class="input-full">
                            <small class="help-text">Maximum number of tokens for responses</small>
                        </div>
                        <div class="form-group">
                            <label for="customTemperature">Temperature:</label>
                            <input type="range" id="customTemperature" min="0" max="2" step="0.1" value="0.7" class="slider">
                            <div class="slider-value">
                                <span id="customTemperatureValue">0.7</span>
                                <small>(0.0 = Deterministic, 2.0 = Very creative)</small>
                            </div>
                            <small class="help-text">Controls randomness in responses</small>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="customStreamingSupport"> Streaming Support
                            </label>
                            <small class="help-text">Enable if your provider supports streaming responses</small>
                        </div>
                    </div>
                </div>
                
                <!-- System Prompt Configuration -->
                <div class="system-prompt-settings">
                    <h4><i class="fas fa-robot"></i> System Prompt Configuration</h4>
                    <div class="form-group">
                        <label for="systemPrompt">Custom System Prompt:</label>
                        <textarea id="systemPrompt" placeholder="Enter your custom system prompt here... Leave empty to use the default system prompt." class="input-full" rows="8"></textarea>
                        <small class="help-text">
                            <strong>Advanced Feature:</strong> Override the default system prompt with your custom instructions. This will replace the built-in genomics-focused system prompt.
                            <br><strong>Variables available:</strong> {{CURRENT_CHROMOSOME}}, {{CURRENT_POSITION}}, {{ANNOTATIONS_COUNT}}, {{USER_FEATURES_COUNT}}
                            <br><strong>Leave empty</strong> to use the default system prompt with genomics tools and context.
                        </small>
                    </div>
                    <div class="form-group">
                        <div class="system-prompt-controls">
                            <button type="button" id="resetSystemPrompt" class="btn btn-secondary btn-sm">
                                <i class="fas fa-undo"></i> Reset to Default
                            </button>
                            <button type="button" id="previewSystemPrompt" class="btn btn-secondary btn-sm">
                                <i class="fas fa-eye"></i> Preview Processed
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Function Call Settings -->
                <div class="function-call-settings">
                    <h4><i class="fas fa-cogs"></i> Function Call Settings</h4>
                    <div class="form-group">
                        <label for="functionCallRounds">Maximum Function Call Rounds:</label>
                        <input type="number" id="functionCallRounds" min="1" max="10" value="3" class="input-full">
                        <small class="help-text">Maximum number of consecutive function calls the AI can make (1-10). Higher values allow more complex multi-step operations but may take longer.</small>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="enableEarlyCompletion" checked>
                            Enable Early Task Completion
                        </label>
                        <small class="help-text">Allow the AI to end the function call loop early when it determines the task is complete, instead of using all available rounds.</small>
                    </div>
                    <div class="form-group">
                        <label for="completionThreshold">Task Completion Confidence Threshold:</label>
                        <input type="range" id="completionThreshold" min="0.5" max="1.0" step="0.05" value="0.7" class="slider">
                        <div class="slider-value">
                            <span id="completionThresholdValue">0.7</span>
                            <small>(50% = Low confidence, 100% = High confidence)</small>
                        </div>
                        <small class="help-text">Minimum confidence level required for the AI to consider a task complete. Higher values reduce false positives but may miss valid completions.</small>
                    </div>
                </div>
                
                <div class="llm-config-status">
                    <div class="status-info">
                        <i class="fas fa-info-circle"></i>
                        <span>Current Provider: <strong id="currentProvider">None</strong></span>
                    </div>
                    <button id="testConnectionBtn" class="btn btn-secondary">
                        <i class="fas fa-plug"></i>
                        Test Connection
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveLLMConfigBtn" class="btn btn-primary">Save Configuration</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- MCP Server Settings Modal -->
    <div id="mcpSettingsModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>MCP Server Management</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Server List Section -->
                <div class="mcp-servers-section">
                    <div class="section-header">
                        <h4><i class="fas fa-server"></i> MCP Servers</h4>
                        <button id="addMcpServerBtn" class="btn btn-primary btn-sm">
                            <i class="fas fa-plus"></i> Add Server
                        </button>
                    </div>
                    
                    <div class="servers-list" id="mcpServersList">
                        <!-- Server items will be populated dynamically -->
                    </div>
                </div>

                <!-- Global Settings Section -->
                <div class="mcp-global-settings">
                    <h4><i class="fas fa-cogs"></i> Global Settings</h4>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="mcpAllowAutoActivation"> 
                            Allow automatic MCP server activation
                        </label>
                        <small class="help-text">When enabled, MCP servers can be automatically started/connected when needed by chat or other features. When disabled, servers must be manually started/connected.</small>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="mcpAutoConnect" checked> 
                            Auto-connect to enabled servers on startup
                        </label>
                        <small class="help-text">When enabled, all servers marked as "auto-connect" will connect automatically when the application starts. (Requires automatic activation to be enabled)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="mcpGlobalReconnectDelay">Global Reconnection Delay (seconds):</label>
                        <input type="number" id="mcpGlobalReconnectDelay" value="5" min="1" max="60" class="input-full">
                        <small class="help-text">Default delay between reconnection attempts for all servers.</small>
                    </div>
                </div>

                <!-- Connection Status Section -->
                <div class="mcp-connection-status">
                    <h4><i class="fas fa-wifi"></i> Connection Status</h4>
                    <div class="status-info">
                        <i class="fas fa-circle" id="mcpStatusIcon"></i>
                        <span id="mcpStatusText">Disconnected</span>
                    </div>
                    <div class="mcp-connection-controls">
                        <button id="mcpConnectAllBtn" class="btn btn-primary">
                            <i class="fas fa-plug"></i>
                            Connect All
                        </button>
                        <button id="mcpDisconnectAllBtn" class="btn btn-secondary">
                            <i class="fas fa-unlink"></i>
                            Disconnect All
                        </button>
                        <button id="mcpRefreshServersBtn" class="btn btn-secondary">
                            <i class="fas fa-sync"></i>
                            Refresh
                        </button>
                    </div>
                </div>

                <!-- Available Tools Section -->
                <div class="mcp-tools-section">
                    <h4><i class="fas fa-tools"></i> Available Tools</h4>
                    <div id="mcpToolsList" class="tools-list">
                        <!-- Tools will be populated dynamically -->
                    </div>
                </div>
                
                <!-- Legacy Single Server Settings (for backward compatibility) -->
                <div class="mcp-legacy-settings" style="border-top: 1px solid #e0e0e0; margin-top: 20px; padding-top: 20px;">
                    <h4><i class="fas fa-history"></i> Legacy Single Server Settings</h4>
                    <small class="help-text">These settings are for backward compatibility with the old single-server configuration.</small>
                    
                    <div class="form-group">
                        <label for="mcpServerUrl">Legacy Server URL:</label>
                        <input type="text" id="mcpServerUrl" value="ws://localhost:3001" class="input-full" placeholder="ws://localhost:3001">
                        <small class="help-text">WebSocket URL for the legacy MCP server connection.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="mcpReconnectDelay">Legacy Reconnection Delay (seconds):</label>
                        <input type="number" id="mcpReconnectDelay" value="5" min="1" max="60" class="input-full">
                        <small class="help-text">Delay between reconnection attempts for legacy server.</small>
                    </div>
                    
                    <div class="mcp-connection-controls">
                        <button id="mcpConnectBtn" class="btn btn-primary">
                            <i class="fas fa-plug"></i>
                            Connect Legacy
                        </button>
                        <button id="mcpDisconnectBtn" class="btn btn-secondary" disabled>
                            <i class="fas fa-unlink"></i>
                            Disconnect Legacy
                        </button>
                    </div>
                </div>
                
                <div class="mcp-info">
                    <h4><i class="fas fa-info-circle"></i> About MCP Servers</h4>
                    <p>The Model Context Protocol (MCP) enables advanced AI integration with external tools and data sources. When connected, MCP servers allow LLMs to:</p>
                    <ul>
                        <li>Access real-time genome data and annotations</li>
                        <li>Perform advanced analysis operations</li>
                        <li>Interact with external bioinformatics tools</li>
                        <li>Provide more contextual and accurate responses</li>
                        <li>Access specialized databases and APIs</li>
                    </ul>
                    <p><strong>Note:</strong> MCP servers are optional. The application works fully without them.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveMCPSettingsBtn" class="btn btn-primary">Save Settings</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit MCP Server Modal -->
    <div id="mcpServerEditModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="mcpServerEditTitle">Add MCP Server</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="mcpServerForm">
                    <input type="hidden" id="editingServerId" value="">
                    
                    <div class="form-group">
                        <label for="serverName">Server Name:</label>
                        <input type="text" id="serverName" class="input-full" placeholder="My MCP Server" required>
                        <small class="help-text">A friendly name to identify this server.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverDescription">Description:</label>
                        <textarea id="serverDescription" class="input-full" rows="3" placeholder="Description of server capabilities..."></textarea>
                        <small class="help-text">Optional description of what this server provides.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverUrl">WebSocket URL:</label>
                        <input type="text" id="serverUrl" class="input-full" placeholder="ws://localhost:3001" required>
                        <small class="help-text">WebSocket endpoint for the MCP server.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverCategory">Category:</label>
                        <select id="serverCategory" class="select input-full">
                            <option value="genomics">Genomics</option>
                            <option value="bioinformatics">Bioinformatics</option>
                            <option value="database">Database</option>
                            <option value="analysis">Analysis</option>
                            <option value="general">General</option>
                            <option value="custom">Custom</option>
                        </select>
                        <small class="help-text">Category helps organize and filter tools.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverApiKey">API Key (if required):</label>
                        <input type="password" id="serverApiKey" class="input-full" placeholder="Optional API key">
                        <small class="help-text">Some servers may require authentication.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverReconnectDelay">Reconnection Delay (seconds):</label>
                        <input type="number" id="serverReconnectDelay" value="5" min="1" max="60" class="input-full">
                        <small class="help-text">Delay between reconnection attempts.</small>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="serverEnabled" checked> 
                            Enable this server
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="serverAutoConnect" checked> 
                            Auto-connect on startup
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="serverCapabilities">Capabilities (comma-separated):</label>
                        <input type="text" id="serverCapabilities" class="input-full" placeholder="genome-analysis, sequence-search, annotation">
                        <small class="help-text">List of capabilities this server provides.</small>
                    </div>
                </form>
                
                <div class="server-test-section">
                    <button id="testServerConnectionBtn" class="btn btn-secondary">
                        <i class="fas fa-plug"></i>
                        Test Connection
                    </button>
                    <span id="testConnectionStatus" class="test-status"></span>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveServerBtn" class="btn btn-primary">Save Server</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Loading genome data...</p>
        </div>
    </div>

    <!-- BLAST Search Modal -->
    <div id="blastSearchModal" class="modal">
        <div class="modal-content blast-modal-content resizable">
            <div class="modal-header">
                <h3><i class="fas fa-search"></i> BLAST Search</h3>
                <button class="modal-close" type="button">&times;</button>
            </div>
            <div class="modal-tabs">
                <button class="tab-button active" data-tab="blast-search">BLAST Search</button>
                <button class="tab-button" data-tab="db-management">Database Management</button>
            </div>
            <div class="modal-body blast-modal-body">
                <!-- BLAST Search Tab Content -->
                <div id="blast-search-tab" class="tab-content active">
                    <div class="blast-search-container">
                        <!-- BLAST Type Selection -->
                        <div class="blast-type-section">
                            <h4><i class="fas fa-dna"></i> Search Type</h4>
                            <div class="blast-type-tabs">
                                <button class="tab-button active" data-blast-type="blastn">
                                    <i class="fas fa-dna"></i>
                                    BLASTN
                                    <span class="tab-description">Nucleotide-Nucleotide</span>
                                </button>
                                <button class="tab-button" data-blast-type="blastp">
                                    <i class="fas fa-circle"></i>
                                    BLASTP
                                    <span class="tab-description">Protein-Protein</span>
                                </button>
                                <button class="tab-button" data-blast-type="blastx">
                                    <i class="fas fa-exchange-alt"></i>
                                    BLASTX
                                    <span class="tab-description">Nucleotide-Protein</span>
                                </button>
                                <button class="tab-button" data-blast-type="tblastn">
                                    <i class="fas fa-code"></i>
                                    TBLASTN
                                    <span class="tab-description">Protein-Nucleotide</span>
                                </button>
                            </div>
                        </div>

                        <!-- Query Sequence Input -->
                        <div class="blast-query-section">
                            <h4><i class="fas fa-file-text"></i> Query Sequence</h4>
                            <div class="query-input-container">
                                <div class="input-source-tabs">
                                    <button class="source-tab active" data-source="manual">Manual Input</button>
                                    <button class="source-tab" data-source="current">Current Region</button>
                                    <button class="source-tab" data-source="file">Upload File</button>
                                </div>
                                
                                <div class="query-input-content">
                                    <!-- Manual Input -->
                                    <div class="input-source-panel active" data-source="manual">
                                        <div class="query-input-wrapper">
                                            <textarea id="blastQuerySequence" 
                                                      placeholder="Enter your DNA, RNA, or protein sequence here (FASTA format optional)..." 
                                                      rows="8"></textarea>
                                            <button id="pasteSequenceInputBtn" class="btn btn-secondary" title="Paste from clipboard">
                                                <i class="fas fa-paste"></i>
                                            </button>
                                        </div>
                                        <div class="sequence-info">
                                            <span id="sequenceLength">Length: 0 bp</span>
                                            <span id="sequenceType">Type: Not detected</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Current Region -->
                                    <div class="input-source-panel" data-source="current">
                                        <div class="current-region-info">
                                            <p><i class="fas fa-info-circle"></i> Use sequence from current genome viewer region</p>
                                            <div class="region-details">
                                                <span>Chromosome: <span id="currentChromDisplay">-</span></span>
                                                <span>Start: <span id="currentStartDisplay">-</span></span>
                                                <span>End: <span id="currentEndDisplay">-</span></span>
                                                <span>Length: <span id="currentLengthDisplay">-</span> bp</span>
                                            </div>
                                            <button id="loadCurrentRegionBtn" class="btn btn-primary">
                                                <i class="fas fa-download"></i>
                                                Load Current Region
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- File Upload -->
                                    <div class="input-source-panel" data-source="file">
                                        <div class="file-upload-area">
                                            <input type="file" id="blastFileInput" accept=".fasta,.fa,.fas,.txt" style="display: none;">
                                            <div class="upload-zone" id="blastUploadZone">
                                                <i class="fas fa-cloud-upload-alt"></i>
                                                <p>Click to upload or drag and drop</p>
                                                <p class="upload-formats">Supported: FASTA (.fasta, .fa, .fas, .txt)</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- BLAST Parameters -->
                        <div class="blast-parameters-section">
                            <h4><i class="fas fa-cog"></i> Search Parameters</h4>
                            <div class="parameters-grid">
                                <div class="parameter-group">
                                    <label for="blastDatabase">Database:</label>
                                    <select id="blastDatabase">
                                        <option value="nt">Nucleotide collection (nt)</option>
                                        <option value="nr">Non-redundant protein sequences (nr)</option>
                                        <option value="refseq_rna">RefSeq RNA sequences</option>
                                        <option value="refseq_genomic">RefSeq Genome sequences</option>
                                        <option value="swissprot">UniProtKB/Swiss-Prot</option>
                                        <option value="pdb">Protein Data Bank proteins</option>
                                    </select>
                                </div>
                                
                                <div class="parameter-group">
                                    <label for="blastEvalue">E-value threshold:</label>
                                    <select id="blastEvalue">
                                        <option value="10">10</option>
                                        <option value="1">1</option>
                                        <option value="0.1">0.1</option>
                                        <option value="0.01" selected>0.01</option>
                                        <option value="0.001">0.001</option>
                                        <option value="1e-10">1e-10</option>
                                        <option value="1e-50">1e-50</option>
                                    </select>
                                </div>
                                
                                <div class="parameter-group">
                                    <label for="blastMaxTargets">Max target sequences:</label>
                                    <select id="blastMaxTargets">
                                        <option value="10">10</option>
                                        <option value="50" selected>50</option>
                                        <option value="100">100</option>
                                        <option value="250">250</option>
                                        <option value="500">500</option>
                                    </select>
                                </div>
                                
                                <div class="parameter-group">
                                    <label for="blastWordSize">Word size:</label>
                                    <select id="blastWordSize">
                                        <option value="7">7</option>
                                        <option value="11" selected>11 (default)</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>
                                        <option value="28">28</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="advanced-parameters">
                                <details>
                                    <summary><i class="fas fa-chevron-right"></i> Advanced Parameters</summary>
                                    <div class="advanced-grid">
                                        <div class="parameter-group">
                                            <label for="blastMatrix">Scoring matrix:</label>
                                            <select id="blastMatrix">
                                                <option value="BLOSUM62" selected>BLOSUM62</option>
                                                <option value="BLOSUM45">BLOSUM45</option>
                                                <option value="BLOSUM80">BLOSUM80</option>
                                                <option value="PAM30">PAM30</option>
                                                <option value="PAM70">PAM70</option>
                                            </select>
                                        </div>
                                        
                                        <div class="parameter-group">
                                            <label for="blastGapOpen">Gap open penalty:</label>
                                            <input type="number" id="blastGapOpen" value="11" min="1" max="50">
                                        </div>
                                        
                                        <div class="parameter-group">
                                            <label for="blastGapExtend">Gap extend penalty:</label>
                                            <input type="number" id="blastGapExtend" value="1" min="1" max="10">
                                        </div>
                                        
                                        <div class="parameter-group">
                                            <label>
                                                <input type="checkbox" id="blastLowComplexity" checked>
                                                Filter low complexity regions
                                            </label>
                                        </div>
                                    </div>
                                </details>
                            </div>
                        </div>

                        <!-- Search Service Selection -->
                        <div class="blast-service-section">
                            <h4><i class="fas fa-server"></i> Search Service</h4>
                            <div class="service-tabs">
                                <button class="service-tab active" data-service="ncbi">
                                    <i class="fas fa-cloud"></i>
                                    NCBI BLAST
                                    <span class="service-description">Remote search using NCBI servers</span>
                                </button>
                                <button class="service-tab" data-service="local" disabled>
                                    <i class="fas fa-desktop"></i>
                                    Local BLAST
                                    <span class="service-description">Local database search (coming soon)</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Database Management Tab Content -->
                <div id="db-management-tab" class="tab-content">
                    <!-- Custom File Database Creation -->
                    <div class="blast-db-management-section custom-db-section">
                        <h4><i class="fas fa-file-upload"></i> Custom File Database</h4>
                        <p class="help-text">Create BLAST database from a custom FASTA file (automatically opens in Project directory).</p>
                        
                        <div class="form-group">
                            <label for="customFilePath">File Path:</label>
                            <div class="file-input-group">
                                <input type="text" id="customFilePath" class="form-control" placeholder="Select a FASTA file..." readonly>
                                <button id="browseCustomFileBtn" class="btn btn-secondary">
                                    <i class="fas fa-folder-open"></i> Browse
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="customDbName">Database Name:</label>
                            <input type="text" id="customDbName" class="form-control" placeholder="Enter database name...">
                        </div>
                        
                        <div class="form-group">
                            <label for="customDbType">Database Type:</label>
                            <select id="customDbType" class="form-control">
                                <option value="nucl">Nucleotide</option>
                                <option value="prot">Protein</option>
                            </select>
                        </div>
                        
                        <button id="createCustomDbBtn" class="btn btn-primary">
                            <i class="fas fa-database"></i> Create Custom Database
                        </button>
                    </div>
                    
                    <!-- Quick Database Creation for Current Genome -->
                    <div class="blast-db-management-section quick-db-section">
                        <h4><i class="fas fa-bolt"></i> Quick Database Creation</h4>
                        <p class="help-text">Create BLAST databases for the currently loaded genome data.</p>
                        
                        <div class="quick-db-buttons">
                            <button id="createNuclDbBtn" class="btn btn-success">
                                <i class="fas fa-dna"></i> Create Nucleotide Database
                            </button>
                            <button id="createProtDbBtn" class="btn btn-info">
                                <i class="fas fa-circle"></i> Create Protein Database
                            </button>
                        </div>
                        
                        <div id="quickDbStatus" class="quick-db-status" style="display: none;">
                            <div id="quickDbStatusContent"></div>
                        </div>
                    </div>
                    
                    <!-- Available Databases Status -->
                    <div class="blast-db-management-section">
                        <h4><i class="fas fa-list"></i> Available Databases</h4>
                        <div id="availableDatabasesList" class="database-list">
                            <!-- Available databases will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Database Operations Log -->
                    <div id="dbOperationLog" class="db-operation-log" style="display: none;">
                        <h5><i class="fas fa-terminal"></i> Operation Log</h5>
                        <div id="dbLogContent" class="log-content">
                            <!-- Log messages will appear here -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="keyboard-shortcut-hint">
                    <i class="fas fa-keyboard"></i>
                    <span>Ctrl+Enter to run</span>
                </div>
                <div class="modal-footer-buttons">
                    <button class="btn btn-secondary modal-close">Cancel</button>
                    <button id="runBlastBtn" class="btn btn-primary">
                        <i class="fas fa-play"></i>
                        Run BLAST Search
                    </button>
                </div>
            </div>
            
            <!-- Resize handles -->
            <div class="resize-handle resize-handle-n"></div>
            <div class="resize-handle resize-handle-s"></div>
            <div class="resize-handle resize-handle-e"></div>
            <div class="resize-handle resize-handle-w"></div>
            <div class="resize-handle resize-handle-ne"></div>
            <div class="resize-handle resize-handle-nw"></div>
            <div class="resize-handle resize-handle-se"></div>
            <div class="resize-handle resize-handle-sw"></div>
        </div>
    </div>

    <!-- BLAST Results Modal -->
    <div id="blastResultsModal" class="modal">
        <div class="modal-content blast-results-content">
            <div class="modal-header">
                <h3><i class="fas fa-chart-line"></i> BLAST Results</h3>
                <div class="results-controls">
                    <button id="exportBlastBtn" class="btn btn-secondary">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                    <button class="modal-close" type="button">&times;</button>
                </div>
            </div>
            <div class="modal-body blast-results-body">
                <div id="blastResultsContainer">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>
    </div>



    <!-- Plugin Management Modal -->
    <div id="pluginManagementModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3><i class="fas fa-puzzle-piece"></i> Plugin Management</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="plugin-management-tabs">
                    <div class="tab-header">
                        <button class="tab-btn active" data-tab="installed">
                            <i class="fas fa-check-circle"></i>
                            Installed Plugins
                        </button>
                        <button class="tab-btn" data-tab="available">
                            <i class="fas fa-plus-circle"></i>
                            Available Plugins
                        </button>
                        <button class="tab-btn" data-tab="settings">
                            <i class="fas fa-cog"></i>
                            Plugin Settings
                        </button>
                    </div>
                    
                    <!-- Installed Plugins Tab -->
                    <div id="installed-plugins-tab" class="tab-content active">
                        <div class="plugin-section">
                            <h4><i class="fas fa-code"></i> Function Plugins</h4>
                            <div id="functionPluginsList" class="plugins-list">
                                <!-- Function plugins will be populated here -->
                            </div>
                        </div>
                        
                        <div class="plugin-section">
                            <h4><i class="fas fa-chart-bar"></i> Visualization Plugins</h4>
                            <div id="visualizationPluginsList" class="plugins-list">
                                <!-- Visualization plugins will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Available Plugins Tab -->
                    <div id="available-plugins-tab" class="tab-content">
                        <div class="plugin-actions">
                            <button id="loadPluginBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i>
                                Load Plugin from File
                            </button>
                            <button id="refreshPluginsBtn" class="btn btn-secondary">
                                <i class="fas fa-sync"></i>
                                Refresh Plugin Directory
                            </button>
                        </div>
                        
                        <div class="plugin-directory">
                            <h4><i class="fas fa-folder"></i> Plugin Directory</h4>
                            <div id="pluginDirectoryList" class="plugins-list">
                                <!-- Available plugins will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Plugin Settings Tab -->
                    <div id="settings-plugins-tab" class="tab-content">
                        <div class="settings-section">
                            <h4><i class="fas fa-folder-open"></i> Plugin Directories</h4>
                            <div class="form-group">
                                <label for="pluginDirectory">Default Plugin Directory:</label>
                                <div class="input-group">
                                    <input type="text" id="pluginDirectory" class="input-full" value="src/renderer/modules/Plugins" readonly>
                                    <button id="browsePluginDir" class="btn btn-secondary">
                                        <i class="fas fa-folder-open"></i>
                                        Browse
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-shield-alt"></i> Security Settings</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enablePluginSandbox" checked>
                                    Enable Plugin Sandbox (Recommended)
                                </label>
                                <small class="help-text">Restricts plugin access to system resources for security</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-bug"></i> Debug Settings</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enablePluginDebug">
                                    Enable Plugin Debug Mode
                                </label>
                                <small class="help-text">Shows detailed plugin execution information in console</small>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h4><i class="fas fa-database"></i> Storage Management</h4>
                            <div class="form-group">
                                <div class="storage-info-grid">
                                    <div class="storage-stat">
                                        <span class="stat-label">Settings Status:</span>
                                        <span class="stat-value" id="storage-status">
                                            <i class="fas fa-spinner fa-spin"></i> Loading...
                                        </span>
                                    </div>
                                    <div class="storage-stat">
                                        <span class="stat-label">Storage Size:</span>
                                        <span class="stat-value" id="storage-size">0 Bytes</span>
                                    </div>
                                    <div class="storage-stat">
                                        <span class="stat-label">Last Saved:</span>
                                        <span class="stat-value" id="last-saved">Never</span>
                                    </div>
                                    <div class="storage-stat">
                                        <span class="stat-label">Tracked Plugins:</span>
                                        <span class="stat-value" id="tracked-plugins">0</span>
                                    </div>
                                </div>
                                <small class="help-text">Plugin settings are automatically saved to local storage every 30 seconds and when the app closes</small>
                            </div>
                            
                            <div class="form-group">
                                <label>Storage Actions:</label>
                                <div class="button-group">
                                    <button id="exportPluginSettingsBtn" class="btn btn-info btn-sm">
                                        <i class="fas fa-download"></i>
                                        Export Settings
                                    </button>
                                    <button id="importPluginSettingsBtn" class="btn btn-secondary btn-sm">
                                        <i class="fas fa-upload"></i>
                                        Import Settings
                                    </button>
                                    <button id="resetPluginSettingsBtn" class="btn btn-warning btn-sm">
                                        <i class="fas fa-undo"></i>
                                        Reset to Defaults
                                    </button>
                                    <button id="viewStorageDetailsBtn" class="btn btn-primary btn-sm">
                                        <i class="fas fa-info-circle"></i>
                                        View Details
                                    </button>
                                </div>
                                <small class="help-text">Export settings to backup, import from backup file, or reset to factory defaults</small>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h4><i class="fas fa-cog"></i> Auto-Save Settings</h4>
                            <div class="form-group">
                                <div class="auto-save-status">
                                    <div class="status-indicator">
                                        <i class="fas fa-check-circle text-success"></i>
                                        <span>Auto-save is enabled</span>
                                    </div>
                                    <div class="status-details">
                                        <ul>
                                            <li>Settings saved every 30 seconds</li>
                                            <li>Settings saved when app closes</li>
                                            <li>Settings saved when tab becomes inactive</li>
                                            <li>Plugin states saved when toggled</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="savePluginSettings" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Settings
                </button>
                <button class="btn modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- General Settings Modal -->
    <div id="generalSettingsModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> General Settings</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <div class="tab-header">
                        <button class="tab-btn active" data-tab="appearance">
                            <i class="fas fa-palette"></i>
                            Appearance
                        </button>
                        <button class="tab-btn" data-tab="performance">
                            <i class="fas fa-tachometer-alt"></i>
                            Performance
                        </button>
                        <button class="tab-btn" data-tab="features">
                            <i class="fas fa-toggle-on"></i>
                            Features
                        </button>
                        <button class="tab-btn" data-tab="export">
                            <i class="fas fa-file-export"></i>
                            Export/Import
                        </button>
                        <button class="tab-btn" data-tab="about">
                            <i class="fas fa-info-circle"></i>
                            About
                        </button>
                    </div>
                    
                    <!-- Appearance Tab -->
                    <div id="appearance-tab" class="tab-content active">
                        <div class="settings-section">
                            <h4><i class="fas fa-moon"></i> Theme Settings</h4>
                            <div class="form-group">
                                <label for="themeMode">Color Scheme:</label>
                                <select id="themeMode" class="input-full">
                                    <option value="auto">Auto (System)</option>
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                </select>
                                <small class="help-text">Choose your preferred color scheme</small>
                            </div>
                            <div class="form-group">
                                <label for="accentColor">Accent Color:</label>
                                <div class="color-picker-group">
                                    <input type="color" id="accentColor" value="#667eea">
                                    <button id="resetAccentColor" class="btn btn-sm">Reset</button>
                                </div>
                                <small class="help-text">Customize the primary accent color</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-text-height"></i> Typography</h4>
                            <div class="form-group">
                                <label for="fontSize">Base Font Size:</label>
                                <select id="fontSize" class="input-full">
                                    <option value="small">Small (13px)</option>
                                    <option value="medium" selected>Medium (14px)</option>
                                    <option value="large">Large (16px)</option>
                                    <option value="extra-large">Extra Large (18px)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="fontFamily">Interface Font:</label>
                                <select id="fontFamily" class="input-full">
                                    <option value="system">System Default</option>
                                    <option value="inter">Inter (Recommended)</option>
                                    <option value="roboto">Roboto</option>
                                    <option value="open-sans">Open Sans</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="sequenceFont">Sequence Font:</label>
                                <select id="sequenceFont" class="input-full">
                                    <option value="courier">Courier New</option>
                                    <option value="monaco">Monaco</option>
                                    <option value="menlo">Menlo</option>
                                    <option value="consolas">Consolas</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-expand-arrows-alt"></i> Layout</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="compactMode">
                                    Compact Mode
                                </label>
                                <small class="help-text">Reduce spacing and padding for more content visibility</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="showWelcomeScreen" checked>
                                    Show Welcome Screen
                                </label>
                                <small class="help-text">Display welcome screen when no file is loaded</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-align-justify"></i> Sequence Display</h4>
                            <div class="form-group">
                                <label for="minLineSpacing">Minimum Line Spacing (px):</label>
                                <input type="number" id="minLineSpacing" value="12" min="2" max="20" step="1" class="input-full">
                                <small class="help-text">Minimum spacing between sequence lines to ensure readability (default: 12px)</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Tab -->
                    <div id="performance-tab" class="tab-content">
                        <div class="settings-section">
                            <h4><i class="fas fa-memory"></i> Memory Management</h4>
                            <div class="form-group">
                                <label for="maxSequenceLength">Maximum Sequence Length (bp):</label>
                                <select id="maxSequenceLength" class="input-full">
                                    <option value="1000000">1 Million</option>
                                    <option value="5000000" selected>5 Million</option>
                                    <option value="10000000">10 Million</option>
                                    <option value="50000000">50 Million</option>
                                    <option value="unlimited">Unlimited (Use with caution)</option>
                                </select>
                                <small class="help-text">Limit sequence length to prevent memory issues</small>
                            </div>
                            <div class="form-group">
                                <label for="renderingMode">Rendering Mode:</label>
                                <select id="renderingMode" class="input-full">
                                    <option value="adaptive" selected>Adaptive (Recommended)</option>
                                    <option value="performance">Performance (Lower Quality)</option>
                                    <option value="quality">Quality (Higher Memory)</option>
                                </select>
                                <small class="help-text">Balance between visual quality and performance</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-chart-line"></i> Visualization</h4>
                            <div class="form-group">
                                <label for="maxGenesDisplay">Maximum Genes to Display:</label>
                                <input type="number" id="maxGenesDisplay" value="1000" min="100" max="10000" class="input-full">
                                <small class="help-text">Limit gene display to improve performance</small>
                            </div>
                            <div class="form-group">
                                <label for="trackHeight">Default Track Height:</label>
                                <select id="trackHeight" class="input-full">
                                    <option value="compact">Compact (60px)</option>
                                    <option value="normal" selected>Normal (80px)</option>
                                    <option value="expanded">Expanded (120px)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableAnimations" checked>
                                    Enable Animations
                                </label>
                                <small class="help-text">Disable for better performance on slower devices</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableGlobalDragging" checked>
                                    Enable Global Track Dragging
                                </label>
                                <small class="help-text">All tracks update dynamically during drag operations (like Genes & Features track)</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-database"></i> Caching</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableFileCache" checked>
                                    Enable File Caching
                                </label>
                                <small class="help-text">Cache processed files for faster loading</small>
                            </div>
                            <div class="form-group">
                                <label for="cacheSize">Cache Size Limit (MB):</label>
                                <input type="number" id="cacheSize" value="500" min="100" max="2000" class="input-full">
                            </div>
                            <div class="form-group">
                                <button id="clearCacheBtn" class="btn btn-secondary">
                                    <i class="fas fa-trash"></i>
                                    Clear Cache
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Features Tab -->
                    <div id="features-tab" class="tab-content">
                        <div class="settings-section">
                            <h4><i class="fas fa-dna"></i> Sequence Features</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableGCContent" checked>
                                    Enable GC Content Analysis
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableProteinTranslation" checked>
                                    Enable Protein Translation
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableOperonPrediction" checked>
                                    Enable Operon Prediction
                                </label>
                                <small class="help-text">Automatically predict and group genes into operons</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-search"></i> Search & Navigation</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableFuzzySearch" checked>
                                    Enable Fuzzy Search
                                </label>
                                <small class="help-text">Allow approximate matches in search</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableAutoComplete" checked>
                                    Enable Search Auto-complete
                                </label>
                            </div>
                            <div class="form-group">
                                <label for="searchHistorySize">Search History Size:</label>
                                <input type="number" id="searchHistorySize" value="50" min="10" max="200" class="input-full">
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-mouse"></i> Mouse & Navigation</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableWheelZoom" checked>
                                    Enable Mouse Wheel Zoom
                                </label>
                                <small class="help-text">Use mouse wheel to zoom in/out on the genome browser</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="wheelZoomToCursor" checked>
                                    Zoom to Cursor Position
                                </label>
                                <small class="help-text">Zoom centered on cursor position instead of viewport center</small>
                            </div>
                            <div class="form-group">
                                <label for="wheelZoomSensitivity">Zoom Sensitivity:</label>
                                <input type="range" id="wheelZoomSensitivity" min="0.05" max="0.5" step="0.05" value="0.1" class="input-full">
                                <small class="help-text">Adjust mouse wheel zoom sensitivity (0.05 = slow, 0.5 = fast)</small>
                                <div class="range-display">Current: <span id="wheelZoomSensitivityValue">0.1</span></div>
                            </div>
                            <div class="form-group">
                                <label for="wheelZoomMinRange">Minimum Zoom Range (bp):</label>
                                <input type="number" id="wheelZoomMinRange" value="100" min="10" max="10000" class="input-full">
                                <small class="help-text">Minimum genomic range when fully zoomed in</small>
                            </div>
                            <div class="form-group">
                                <label for="wheelZoomMaxRange">Maximum Zoom Range (bp):</label>
                                <input type="number" id="wheelZoomMaxRange" value="1000000" min="1000" max="10000000" class="input-full">
                                <small class="help-text">Maximum genomic range when fully zoomed out</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-robot"></i> AI Features</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableLLMIntegration" checked>
                                    Enable LLM Integration
                                </label>
                                <small class="help-text">Allow AI assistance for genomic analysis</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="enableContextualSuggestions" checked>
                                    Enable Contextual Suggestions
                                </label>
                                <small class="help-text">Show relevant suggestions based on current context</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Export/Import Tab -->
                    <div id="export-tab" class="tab-content">
                        <div class="settings-section">
                            <h4><i class="fas fa-file-export"></i> Export Settings</h4>
                            <div class="form-group">
                                <label for="defaultExportFormat">Default Export Format:</label>
                                <select id="defaultExportFormat" class="input-full">
                                    <option value="png">PNG Image</option>
                                    <option value="svg" selected>SVG Vector</option>
                                    <option value="pdf">PDF Document</option>
                                    <option value="json">JSON Data</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="exportResolution">Export Resolution (DPI):</label>
                                <input type="number" id="exportResolution" value="300" min="72" max="600" class="input-full">
                                <small class="help-text">Higher values produce better quality but larger files</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="includeMetadata" checked>
                                    Include Metadata in Exports
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-file-import"></i> Import Settings</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="validateFileFormat" checked>
                                    Validate File Format on Import
                                </label>
                                <small class="help-text">Check file integrity before processing</small>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="autoDetectFormat" checked>
                                    Auto-detect File Format
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-save"></i> Backup & Restore</h4>
                            <div class="form-group">
                                <button id="exportSettingsBtn" class="btn btn-primary">
                                    <i class="fas fa-download"></i>
                                    Export All Settings
                                </button>
                                <small class="help-text">Save all settings to a file</small>
                            </div>
                            <div class="form-group">
                                <input type="file" id="importSettingsFile" accept=".json" style="display: none;">
                                <button id="importSettingsBtn" class="btn btn-secondary">
                                    <i class="fas fa-upload"></i>
                                    Import Settings
                                </button>
                                <small class="help-text">Load settings from a file</small>
                            </div>
                            <div class="form-group">
                                <button id="resetAllSettingsBtn" class="btn btn-warning">
                                    <i class="fas fa-undo"></i>
                                    Reset All Settings
                                </button>
                                <small class="help-text">Restore all settings to default values</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- About Tab -->
                    <div id="about-tab" class="tab-content">
                        <div class="settings-section">
                            <h4><i class="fas fa-info-circle"></i> Application Information</h4>
                            <div class="about-info">
                                <div class="app-logo">
                                    <i class="fas fa-dna"></i>
                                </div>
                                <h3>Genome AI Studio</h3>
                                <p class="version" id="about-version">Version 0.3.0-beta</p>
                                <p class="description">
                                    An advanced genome visualization and analysis platform with integrated AI capabilities.
                                </p>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-users"></i> Credits</h4>
                            <div class="credits-list">
                                <div class="credit-item">
                                    <strong>Development:</strong> Genome AI Studio Team
                                </div>
                                <div class="credit-item">
                                    <strong>Libraries:</strong> D3.js, Font Awesome, Inter Font
                                </div>
                                <div class="credit-item">
                                    <strong>AI Integration:</strong> OpenAI, Anthropic, Google
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-book"></i> Documentation & Support</h4>
                            <div class="support-links">
                                <button class="btn btn-secondary" onclick="window.open('#', '_blank')">
                                    <i class="fas fa-book-open"></i>
                                    User Guide
                                </button>
                                <button class="btn btn-secondary" onclick="window.open('#', '_blank')">
                                    <i class="fas fa-question-circle"></i>
                                    FAQ
                                </button>
                                <button class="btn btn-secondary" onclick="window.open('#', '_blank')">
                                    <i class="fas fa-bug"></i>
                                    Report Issues
                                </button>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4><i class="fas fa-chart-bar"></i> System Information</h4>
                            <div class="system-info">
                                <div class="info-row">
                                    <span class="info-label">Platform:</span>
                                    <span class="info-value" id="platformInfo">Loading...</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Browser:</span>
                                    <span class="info-value" id="browserInfo">Loading...</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Memory Usage:</span>
                                    <span class="info-value" id="memoryInfo">Loading...</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Performance:</span>
                                    <span class="info-value" id="performanceInfo">Good</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveGeneralSettings" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Settings
                </button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Action List Management Modal -->
    <div id="actionListModal" class="modal">
        <div class="modal-content action-list-modal">
            <div class="modal-header">
                <h3><i class="fas fa-list"></i> Action List Manager</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="action-list-controls">
                    <div class="control-group">
                        <button id="executeAllActionsBtn" class="btn btn-primary">
                            <i class="fas fa-play"></i>
                            Execute All Actions
                        </button>
                        <button id="clearAllActionsBtn" class="btn btn-warning">
                            <i class="fas fa-trash"></i>
                            Clear All Actions
                        </button>
                        <button id="exportActionsBtn" class="btn btn-secondary">
                            <i class="fas fa-download"></i>
                            Export Actions
                        </button>
                        <button id="importActionsBtn" class="btn btn-secondary">
                            <i class="fas fa-upload"></i>
                            Import Actions
                        </button>
                    </div>
                    <div class="action-stats">
                        <span class="stat-item">
                            <i class="fas fa-list-ul"></i>
                            <span id="actionCount">0</span> Actions
                        </span>
                        <span class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span id="estimatedTime">0s</span> Est. Time
                        </span>
                    </div>
                </div>
                
                <div class="action-list-container">
                    <div class="action-list-header">
                        <div class="header-col action-order">#</div>
                        <div class="header-col action-type">Type</div>
                        <div class="header-col action-target">Target</div>
                        <div class="header-col action-details">Details</div>
                        <div class="header-col action-status">Status</div>
                        <div class="header-col action-controls">Controls</div>
                    </div>
                    <div id="actionListContent" class="action-list-content">
                        <div class="empty-actions-message">
                            <i class="fas fa-inbox"></i>
                            <p>No actions queued</p>
                            <small>Use the Action menu to add sequence operations</small>
                        </div>
                    </div>
                </div>
                
                <div class="checkpoint-controls">
                    <h4><i class="fas fa-save"></i> Checkpoint Management</h4>
                    <div class="checkpoint-section">
                        <div class="checkpoint-create">
                            <input type="text" id="checkpointNameInput" placeholder="Checkpoint name..." class="checkpoint-name-input">
                            <button id="createCheckpointBtnModal" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Create Checkpoint
                            </button>
                        </div>
                        <div class="checkpoint-list">
                            <div id="checkpointListContent" class="checkpoint-items">
                                <div class="empty-checkpoints-message">
                                    <i class="fas fa-bookmark"></i>
                                    <p>No checkpoints created</p>
                                    <small>Create checkpoints to save current state</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn modal-close">Close</button>
            </div>
        </div>
    </div>

    <!-- Sequence Selection Dialog -->
    <div id="sequenceSelectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="sequenceSelectionTitle">Select Sequence Range</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sequence-selection-form">
                    <div class="form-group">
                        <label for="chromosomeSelectSeq">Chromosome:</label>
                        <select id="chromosomeSelectSeq" class="form-control">
                            <option value="">Select chromosome...</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startPositionSeq">Start Position:</label>
                            <input type="number" id="startPositionSeq" class="form-control" min="1">
                        </div>
                        <div class="form-group">
                            <label for="endPositionSeq">End Position:</label>
                            <input type="number" id="endPositionSeq" class="form-control" min="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="strandSelectSeq">Strand:</label>
                        <select id="strandSelectSeq" class="form-control">
                            <option value="+" selected>Forward (+)</option>
                            <option value="-">Reverse (-)</option>
                        </select>
                    </div>
                    <div class="sequence-preview">
                        <label>Sequence Preview:</label>
                        <div id="sequencePreview" class="sequence-preview-content">
                            Select chromosome and positions to preview sequence
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="confirmSequenceSelection" class="btn btn-primary">Confirm</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Insert Sequence Modal -->
    <div id="sequenceInsertModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Insert Sequence</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sequence-insert-form">
                    <div class="form-group">
                        <label for="chromosomeSelectInsert">Chromosome:</label>
                        <select id="chromosomeSelectInsert" class="form-control">
                            <option value="">Select chromosome...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="insertPositionSeq">Insert Position:</label>
                        <input type="number" id="insertPositionSeq" class="form-control" min="1" placeholder="Position to insert sequence">
                    </div>
                    <div class="form-group">
                        <label for="insertSequenceText">Sequence to Insert:</label>
                        <textarea id="insertSequenceText" class="form-control" rows="4" placeholder="Enter DNA sequence (A, T, G, C)..."></textarea>
                        <small class="form-help">Only valid DNA nucleotides (A, T, G, C) are allowed</small>
                    </div>
                    <div class="sequence-validation">
                        <span id="sequenceValidation" class="validation-message"></span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="confirmSequenceInsert" class="btn btn-primary">Insert Sequence</button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Gene Annotation Modal -->
    <div id="editGeneModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Gene Annotation</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="gene-edit-form">
                    <div class="form-group">
                        <label for="editGeneName">Gene Name:</label>
                        <input type="text" id="editGeneName" class="input-full" placeholder="Enter gene name">
                    </div>
                    <div class="form-group">
                        <label for="editGeneType">Feature Type:</label>
                        <select id="editGeneType" class="select input-full">
                            <option value="gene">Gene</option>
                            <option value="CDS">CDS (Coding Sequence)</option>
                            <option value="mRNA">mRNA</option>
                            <option value="rRNA">rRNA (Ribosomal RNA)</option>
                            <option value="tRNA">tRNA (Transfer RNA)</option>
                            <option value="promoter">Promoter</option>
                            <option value="terminator">Terminator</option>
                            <option value="regulatory">Regulatory Element</option>
                            <option value="misc_feature">Miscellaneous Feature</option>
                            <option value="repeat_region">Repeat Region</option>
                            <option value="comment">Comment/Note</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editGeneStart">Start Position:</label>
                            <input type="number" id="editGeneStart" class="input-full" min="1">
                        </div>
                        <div class="form-group">
                            <label for="editGeneEnd">End Position:</label>
                            <input type="number" id="editGeneEnd" class="input-full" min="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editGeneStrand">Strand:</label>
                        <select id="editGeneStrand" class="select input-full">
                            <option value="1">Forward (+)</option>
                            <option value="-1">Reverse (-)</option>
                            <option value="0">Both/Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editGeneProduct">Product:</label>
                        <input type="text" id="editGeneProduct" class="input-full" placeholder="Enter gene product">
                    </div>
                    <div class="form-group">
                        <label for="editGeneLocusTag">Locus Tag:</label>
                        <input type="text" id="editGeneLocusTag" class="input-full" placeholder="Enter locus tag">
                    </div>
                    <div class="form-group">
                        <label for="editGeneNote">Note/Description:</label>
                        <textarea id="editGeneNote" class="input-full" rows="3" placeholder="Enter additional notes or description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Additional Qualifiers:</label>
                        <div id="editGeneQualifiers" class="qualifiers-list">
                            <!-- Dynamic qualifiers will be added here -->
                        </div>
                        <button type="button" id="addQualifierBtn" class="btn btn-secondary btn-sm">
                            <i class="fas fa-plus"></i> Add Qualifier
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveGeneEditBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Changes
                </button>
                <button class="btn modal-close">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Tab Settings Modal -->
    <div id="tabSettingsModal" class="modal">
        <div class="modal-content resizable">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Tab Behavior Settings</h3>
                <div class="modal-controls">
                    <button class="reset-position-btn" title="Reset Position">
                        <i class="fas fa-crosshairs"></i>
                    </button>
                    <button class="modal-close">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4><i class="fas fa-memory"></i> Tab Rendering Cache</h4>
                    <p class="help-text">Cache tab content to improve switching performance. When enabled, tab content is cached in memory to avoid re-rendering when switching between tabs.</p>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="tabCacheEnabled">Enable Tab Caching</label>
                            <p class="setting-description">Cache tab content for faster switching</p>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="tabCacheEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="setting-item" id="cacheSettingsGroup">
                        <div class="setting-label">
                            <label for="maxCacheSize">Maximum Cached Tabs</label>
                            <p class="setting-description">Number of tabs to keep in cache</p>
                        </div>
                        <div class="setting-control">
                            <input type="number" id="maxCacheSize" min="1" max="20" value="10" class="form-control number-input">
                        </div>
                    </div>
                    
                    <div class="setting-item" id="cacheTimeoutGroup">
                        <div class="setting-label">
                            <label for="cacheTimeout">Cache Timeout (minutes)</label>
                            <p class="setting-description">How long to keep cached content</p>
                        </div>
                        <div class="setting-control">
                            <input type="number" id="cacheTimeout" min="1" max="120" value="30" class="form-control number-input">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label>Cache Statistics</label>
                            <p class="setting-description">Current cache usage information</p>
                        </div>
                        <div class="setting-control">
                            <div id="cacheStats" class="cache-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Cached Tabs:</span>
                                    <span class="stat-value" id="cachedTabsCount">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Cache Size:</span>
                                    <span class="stat-value" id="cacheSizeInfo">0/10</span>
                                </div>
                                <button id="clearCacheBtn" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-trash"></i> Clear Cache
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Position Indicator Settings Section -->
                <div class="settings-section">
                    <h4><i class="fas fa-map-marker-alt"></i> Position Indicator Appearance</h4>
                    <p class="help-text">Customize the appearance of position indicators on tab buttons that show current browsing location.</p>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="indicatorHeight">Indicator Height (px)</label>
                            <p class="setting-description">Height of the position visualization bar</p>
                        </div>
                        <div class="setting-control">
                            <input type="range" id="indicatorHeight" min="2" max="8" value="3" class="range-slider">
                            <span class="range-value" id="indicatorHeightValue">3px</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="indicatorColor">Default Indicator Color</label>
                            <p class="setting-description">Default color for position indicators</p>
                        </div>
                        <div class="setting-control">
                            <input type="color" id="indicatorColor" value="#1a73e8" class="color-picker">
                            <button id="resetIndicatorColor" class="btn btn-sm btn-secondary">Reset</button>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="indicatorOpacity">Indicator Opacity</label>
                            <p class="setting-description">Transparency level of position indicators</p>
                        </div>
                        <div class="setting-control">
                            <input type="range" id="indicatorOpacity" min="0.3" max="1.0" step="0.1" value="0.8" class="range-slider">
                            <span class="range-value" id="indicatorOpacityValue">0.8</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="indicatorBorderWidth">Border Width (px)</label>
                            <p class="setting-description">Thickness of indicator border</p>
                        </div>
                        <div class="setting-control">
                            <input type="range" id="indicatorBorderWidth" min="0" max="4" value="2" class="range-slider">
                            <span class="range-value" id="indicatorBorderWidthValue">2px</span>
                        </div>
                    </div>
                </div>
                
                <!-- Chromosome Track Settings Section -->
                <div class="settings-section">
                    <h4><i class="fas fa-dna"></i> Chromosome Track Styling</h4>
                    <p class="help-text">Customize the appearance of chromosome tracks that contain position indicators.</p>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="trackBackgroundColor">Track Background Color</label>
                            <p class="setting-description">Background color of chromosome tracks</p>
                        </div>
                        <div class="setting-control">
                            <input type="color" id="trackBackgroundColor" value="#e0e0e0" class="color-picker">
                            <button id="resetTrackBackgroundColor" class="btn btn-sm btn-secondary">Reset</button>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="trackBorderColor">Track Border Color</label>
                            <p class="setting-description">Border color of chromosome tracks</p>
                        </div>
                        <div class="setting-control">
                            <input type="color" id="trackBorderColor" value="#cccccc" class="color-picker">
                            <button id="resetTrackBorderColor" class="btn btn-sm btn-secondary">Reset</button>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="trackBorderRadius">Border Radius (px)</label>
                            <p class="setting-description">Roundness of track corners</p>
                        </div>
                        <div class="setting-control">
                            <input type="range" id="trackBorderRadius" min="0" max="6" value="2" class="range-slider">
                            <span class="range-value" id="trackBorderRadiusValue">2px</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="enableChromosomeColors">Enable Chromosome-Specific Colors</label>
                            <p class="setting-description">Use different colors for different chromosomes</p>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="enableChromosomeColors" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <label for="enableAnimations">Enable Hover Animations</label>
                            <p class="setting-description">Animate indicators on hover</p>
                        </div>
                        <div class="setting-control">
                            <label class="switch">
                                <input type="checkbox" id="enableAnimations" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Preview Section -->
                <div class="settings-section">
                    <h4><i class="fas fa-eye"></i> Live Preview</h4>
                    <p class="help-text">Preview how your position indicator settings will look.</p>
                    
                    <div class="preview-container">
                        <div class="preview-tab">
                            <i class="tab-icon fas fa-dna"></i>
                            <span class="tab-title">chr1:1,000-50,000</span>
                            <div class="tab-position-visualization" id="previewVisualization">
                                <div class="chromosome-track" id="previewTrack">
                                    <div class="position-indicator" id="previewIndicator"></div>
                                </div>
                            </div>
                            <button class="tab-close-button">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveTabSettingsBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Settings
                </button>
                <button id="resetTabSettingsBtn" class="btn btn-warning">
                    <i class="fas fa-undo"></i> Reset to Defaults
                </button>
                <button class="btn modal-close">Cancel</button>
            </div>
            
            <!-- Resize handles -->
            <div class="resize-handle resize-handle-n"></div>
            <div class="resize-handle resize-handle-s"></div>
            <div class="resize-handle resize-handle-e"></div>
            <div class="resize-handle resize-handle-w"></div>
            <div class="resize-handle resize-handle-ne"></div>
            <div class="resize-handle resize-handle-nw"></div>
            <div class="resize-handle resize-handle-se"></div>
            <div class="resize-handle resize-handle-sw"></div>
        </div>
    </div>

    <!-- Multi-Agent Settings Modal -->
    <div id="multiAgentSettingsModal" class="modal">
        <div class="modal-content multi-agent-settings-modal resizable">
            <div class="modal-header">
                <h3><i class="fas fa-users-cog"></i> Multi-Agent System Settings</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="multi-agent-tabs">
                    <button class="tab-button active" data-tab="system">System</button>
                    <button class="tab-button" data-tab="llm">LLM Configuration</button>
                    <button class="tab-button" data-tab="agents">Agent Management</button>
                    <button class="tab-button" data-tab="memory">Memory System</button>
                    <button class="tab-button" data-tab="performance">Performance</button>
                </div>
                
                <div class="multi-agent-content">
                    <!-- System Tab -->
                    <div id="system-tab" class="tab-content active">
                        <div class="form-section">
                            <h4>ðŸ¤– Multi-Agent System</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentSystemEnabled" class="setting-checkbox">
                                    Enable Multi-Agent System
                                </label>
                                <small class="help-text">Enable intelligent agent-based tool execution and coordination</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentAutoOptimize" class="setting-checkbox" checked>
                                    Auto-optimize execution paths
                                </label>
                                <small class="help-text">Automatically optimize tool execution based on memory and performance data</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentShowInfo" class="setting-checkbox" checked>
                                    Show agent information
                                </label>
                                <small class="help-text">Display which agent is handling each tool execution</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentMemoryEnabled" class="setting-checkbox" checked>
                                    Enable agent memory integration
                                </label>
                                <small class="help-text">Enable memory system integration for agents</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentCacheEnabled" class="setting-checkbox" checked>
                                    Enable agent execution caching
                                </label>
                                <small class="help-text">Cache successful agent executions for faster future execution</small>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ðŸŽ¯ Agent Coordination</h4>
                            <div class="form-group">
                                <label for="multiAgentMaxConcurrent">Maximum Concurrent Agents:</label>
                                <input type="number" id="multiAgentMaxConcurrent" class="input-full" min="1" max="10" value="3">
                                <small class="help-text">Maximum number of agents that can execute simultaneously</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentTimeout">Agent Execution Timeout (seconds):</label>
                                <input type="number" id="multiAgentTimeout" class="input-full" min="5" max="300" value="30">
                                <small class="help-text">Timeout for individual agent executions</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentRetryAttempts">Retry Attempts:</label>
                                <input type="number" id="multiAgentRetryAttempts" class="input-full" min="1" max="5" value="3">
                                <small class="help-text">Number of retry attempts for failed agent executions</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- LLM Configuration Tab -->
                    <div id="llm-tab" class="tab-content">
                        <div class="form-section">
                            <h4>ðŸ§  Agent LLM Configuration</h4>
                            <div class="form-group">
                                <label for="multiAgentLLMProvider">LLM Provider:</label>
                                <select id="multiAgentLLMProvider" class="input-full">
                                    <option value="auto">Auto (Use main LLM)</option>
                                    <option value="openai">OpenAI</option>
                                    <option value="anthropic">Anthropic (Claude)</option>
                                    <option value="google">Google (Gemini)</option>
                                    <option value="deepseek">DeepSeek</option>
                                    <option value="siliconflow">SiliconFlow</option>
                                    <option value="mistral">Mistral AI</option>
                                    <option value="cohere">Cohere</option>
                                    <option value="perplexity">Perplexity</option>
                                    <option value="local">Local LLM</option>
                                    <option value="custom">Custom Provider</option>
                                </select>
                                <small class="help-text">Choose LLM provider for agent decision making</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentLLMModel">LLM Model:</label>
                                <select id="multiAgentLLMModel" class="input-full">
                                    <option value="auto">Auto (Use provider default)</option>
                                </select>
                                <small class="help-text">Choose specific model for agent operations</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentLLMTemperature">Temperature:</label>
                                <input type="range" id="multiAgentLLMTemperature" class="input-full" min="0" max="2" step="0.1" value="0.7">
                                <div class="range-value" id="multiAgentLLMTemperatureValue">0.7</div>
                                <small class="help-text">Control creativity vs consistency (0 = deterministic, 2 = very creative)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentLLMMaxTokens">Max Tokens:</label>
                                <input type="number" id="multiAgentLLMMaxTokens" class="input-full" min="1000" max="32000" step="1000" value="4000">
                                <small class="help-text">Maximum tokens for agent LLM responses</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentLLMTimeout">Timeout (seconds):</label>
                                <input type="number" id="multiAgentLLMTimeout" class="input-full" min="5" max="300" step="5" value="30">
                                <small class="help-text">Timeout for agent LLM requests</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentLLMUseSystemPrompt" class="setting-checkbox" checked>
                                    Use system prompt for agents
                                </label>
                                <small class="help-text">Enable system prompts for better agent behavior</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentLLMEnableFunctionCalling" class="setting-checkbox" checked>
                                    Enable function calling for agents
                                </label>
                                <small class="help-text">Allow agents to use function calling capabilities</small>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ðŸ”‘ API Configuration</h4>
                            <div class="form-group">
                                <label for="multiAgentApiKey">API Key:</label>
                                <div class="input-with-button">
                                    <input type="password" id="multiAgentApiKey" placeholder="Enter API key..." class="input-full">
                                    <button type="button" class="btn btn-sm btn-paste" id="pasteMultiAgentApiKeyBtn" title="Paste API Key">
                                        <i class="fas fa-paste"></i>
                                    </button>
                                </div>
                                <small class="help-text">API key for the selected LLM provider</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentBaseUrl">Base URL (optional):</label>
                                <input type="text" id="multiAgentBaseUrl" placeholder="https://api.provider.com/v1" class="input-full">
                                <small class="help-text">Custom base URL for the LLM provider</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Agent Management Tab -->
                    <div id="agents-tab" class="tab-content">
                        <div class="form-section">
                            <h4>ðŸ¤– Agent Configuration</h4>
                            <div class="agent-list">
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-route"></i> Navigation Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentNavigationEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Handles navigation, positioning, and spatial operations
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-chart-line"></i> Analysis Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentAnalysisEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Performs data analysis, statistics, and pattern recognition
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-database"></i> Data Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentDataEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Manages data retrieval, storage, and export operations
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-dna"></i> Sequence Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentSequenceEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Handles DNA/RNA sequence analysis and manipulation
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-atom"></i> Protein Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentProteinEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Manages protein structure and function analysis
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-network-wired"></i> Network Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentNetworkEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Handles network analysis and pathway visualization
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-globe"></i> External Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentExternalEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Manages external API calls and data integration
                                    </div>
                                </div>
                                
                                <div class="agent-item">
                                    <div class="agent-header">
                                        <h5><i class="fas fa-puzzle-piece"></i> Plugin Agent</h5>
                                        <label class="switch">
                                            <input type="checkbox" id="agentPluginEnabled" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="agent-description">
                                        Handles plugin system integration and management
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Memory System Tab -->
                    <div id="memory-tab" class="tab-content">
                        <div class="form-section">
                            <h4>ðŸ§  Memory System</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentMemorySystemEnabled" class="setting-checkbox" checked>
                                    Enable Memory System
                                </label>
                                <small class="help-text">Enable intelligent memory caching and context management</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentMemoryCacheEnabled" class="setting-checkbox" checked>
                                    Enable memory caching
                                </label>
                                <small class="help-text">Cache memory operations for improved performance</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentMemoryOptimizationEnabled" class="setting-checkbox" checked>
                                    Enable memory optimization
                                </label>
                                <small class="help-text">Automatically optimize memory usage and cleanup</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentMemoryCleanupInterval">Memory cleanup interval (minutes):</label>
                                <input type="number" id="multiAgentMemoryCleanupInterval" class="input-full" min="1" max="60" step="1" value="5">
                                <small class="help-text">How often to perform memory cleanup operations</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentMemoryMaxEntries">Maximum memory entries:</label>
                                <input type="number" id="multiAgentMemoryMaxEntries" class="input-full" min="100" max="100000" step="100" value="10000">
                                <small class="help-text">Maximum number of entries to keep in memory</small>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ðŸ“Š Memory Layers</h4>
                            <div class="memory-layer">
                                <h6>Short-term Memory</h6>
                                <div class="form-group">
                                    <label for="multiAgentShortTermMaxSize">Max size:</label>
                                    <input type="number" id="multiAgentShortTermMaxSize" class="input-full" min="100" max="10000" step="100" value="1000">
                                </div>
                                <div class="form-group">
                                    <label for="multiAgentShortTermTTL">TTL (minutes):</label>
                                    <input type="number" id="multiAgentShortTermTTL" class="input-full" min="1" max="60" step="1" value="30">
                                </div>
                            </div>
                            
                            <div class="memory-layer">
                                <h6>Medium-term Memory</h6>
                                <div class="form-group">
                                    <label for="multiAgentMediumTermMaxSize">Max size:</label>
                                    <input type="number" id="multiAgentMediumTermMaxSize" class="input-full" min="500" max="50000" step="500" value="5000">
                                </div>
                                <div class="form-group">
                                    <label for="multiAgentMediumTermTTL">TTL (hours):</label>
                                    <input type="number" id="multiAgentMediumTermTTL" class="input-full" min="1" max="168" step="1" value="24">
                                </div>
                            </div>
                            
                            <div class="memory-layer">
                                <h6>Long-term Memory</h6>
                                <div class="form-group">
                                    <label for="multiAgentLongTermMaxSize">Max size:</label>
                                    <input type="number" id="multiAgentLongTermMaxSize" class="input-full" min="1000" max="100000" step="1000" value="10000">
                                </div>
                                <div class="form-group">
                                    <label for="multiAgentLongTermTTL">TTL (days):</label>
                                    <input type="number" id="multiAgentLongTermLongTermTTL" class="input-full" min="1" max="365" step="1" value="30">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Performance Tab -->
                    <div id="performance-tab" class="tab-content">
                        <div class="form-section">
                            <h4>âš¡ Performance Optimization</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentPerformanceMonitoring" class="setting-checkbox" checked>
                                    Enable performance monitoring
                                </label>
                                <small class="help-text">Monitor agent performance and execution metrics</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="multiAgentAutoScaling" class="setting-checkbox" checked>
                                    Enable auto-scaling
                                </label>
                                <small class="help-text">Automatically scale agent resources based on workload</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentMaxConcurrentTasks">Max concurrent tasks:</label>
                                <input type="number" id="multiAgentMaxConcurrentTasks" class="input-full" min="1" max="20" value="5">
                                <small class="help-text">Maximum number of concurrent tasks across all agents</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="multiAgentTaskQueueSize">Task queue size:</label>
                                <input type="number" id="multiAgentTaskQueueSize" class="input-full" min="10" max="1000" step="10" value="100">
                                <small class="help-text">Maximum size of the task queue</small>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ðŸ“ˆ Performance Metrics</h4>
                            <div class="performance-metrics">
                                <div class="metric-item">
                                    <span class="metric-label">Average Response Time:</span>
                                    <span class="metric-value" id="avgResponseTime">--</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Success Rate:</span>
                                    <span class="metric-value" id="successRate">--</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Cache Hit Rate:</span>
                                    <span class="metric-value" id="cacheHitRate">--</span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Active Agents:</span>
                                    <span class="metric-value" id="activeAgents">--</span>
                                </div>
                            </div>
                            
                            <button class="btn btn-secondary" id="refreshMetricsBtn">
                                <i class="fas fa-sync"></i> Refresh Metrics
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetMultiAgentSettingsBtn">
                    <i class="fas fa-undo"></i> Reset to Defaults
                </button>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-secondary" id="cancelMultiAgentSettingsBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="saveMultiAgentSettingsBtn">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>
            </div>
            
            <!-- Resize handles -->
            <div class="resize-handle resize-handle-n"></div>
            <div class="resize-handle resize-handle-s"></div>
            <div class="resize-handle resize-handle-e"></div>
            <div class="resize-handle resize-handle-w"></div>
            <div class="resize-handle resize-handle-ne"></div>
            <div class="resize-handle resize-handle-nw"></div>
            <div class="resize-handle resize-handle-se"></div>
            <div class="resize-handle resize-handle-sw"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!--script src="https://cdn.jsdelivr.net/npm/igv@2.15.8/dist/igv.min.js"></script -->
    
    <!-- Application modules -->
    <script src="modules/ConfigManager.js"></script>
    <script src="modules/MultiFileManager.js"></script>
    <script src="modules/FileManager.js"></script>
    <script src="modules/CanvasSequenceRenderer.js"></script>
    <script src="modules/CanvasReadsRenderer.js"></script>
    <script src="modules/TrackRenderer.js"></script>
    <script src="modules/VariantAnalyzer.js"></script>
    <script src="modules/NavigationManager.js"></script>
    <script src="modules/GenomeNavigationBar.js"></script>
    <script src="modules/UIManager.js"></script>
    <script src="modules/VSCodeSequenceEditor.js"></script>
    <script src="modules/SequenceEditor.js"></script>
    <script src="modules/SequenceUtils.js"></script>
    <script src="modules/ExportManager.js"></script>
    <script src="modules/LLMConfigManager.js"></script>
    <script src="modules/MultiAgentSettingsManager.js"></script>
<script src="modules/GeneralSettingsManager.js"></script>
    <script src="modules/MCPServerManager.js"></script>
    <script src="modules/ChatManager.js"></script>
    
    <!-- CrewAI Multi-Agent System -->
    <script src="modules/CrewAI/CrewAIFramework.js"></script>
    <script src="modules/CrewAI/GenomicsCrewAgents.js"></script>
    <script src="modules/CrewAI/CrewAIMultiAgentSystem.js"></script>
    
    <!-- Legacy Multi-Agent System (for compatibility) -->
    <script src="modules/AgentBase.js"></script>
    <script src="modules/Agents/AgentBase.js"></script>
    <script src="modules/Agents/NavigationAgent.js"></script>
    <script src="modules/Agents/AnalysisAgent.js"></script>
    <script src="modules/Agents/DataAgent.js"></script>
    <script src="modules/Agents/ExternalAgent.js"></script>
    <script src="modules/Agents/PluginAgent.js"></script>
    <script src="modules/Agents/CoordinatorAgent.js"></script>
    <script src="modules/MultiAgentSystem.js"></script>
    
    <script src="modules/ReadsManager.js"></script>
    <script src="modules/ProteinStructureViewer.js"></script>
    <script src="modules/BlastManager.js"></script>
    <script src="modules/MicrobeGenomicsFunctions.js"></script>
    
    <!-- Modern Plugin System V2 -->
    <script src="modules/PluginAPI.js"></script>
    <script src="modules/PluginResourceManager.js"></script>
    <script src="modules/PluginMarketplace.js"></script>
    <script src="modules/PluginDependencyResolver.js"></script>
    <script src="modules/PluginSecurityValidator.js"></script>
    <script src="modules/PluginUpdateManager.js"></script>
    <script src="modules/PluginManagerV2.js"></script>
    <script src="modules/PluginMarketplaceConfig.js"></script>
<script src="modules/PluginSubmissionUI.js"></script>
<script src="modules/PluginMarketplaceUI.js"></script>
<script src="modules/PluginManagementUI.js"></script>
<script src="modules/PluginSystemBootstrap.js"></script>
    
    <!-- Plugin Testing and Development -->
    <script src="modules/PluginTestManager.js"></script>
    <script src="modules/PluginTestHelpers.js"></script>
    <script src="modules/CircosPluginTestSuite.js"></script>
    <script src="modules/PluginTestFramework.js"></script>
    <script src="modules/PluginDemoGenerator.js"></script>
    
    <!-- Plugin System Support -->
    <script src="modules/ModalDragManager.js"></script>
    <script src="modules/ResizableModalManager.js"></script>
    <script src="modules/FunctionCallsOrganizer.js"></script>
    <script src="modules/PluginFunctionCallsIntegrator.js"></script>
    <script src="modules/SmartExecutor.js"></script>
    <script src="modules/PluginUtils.js"></script>
    <script src="modules/PluginVisualization.js"></script>
    <script src="modules/PluginImplementations.js"></script>
    <script src="modules/VisualizationToolsManager.js"></script>
    
    <!-- Conversation Evolution System -->
    <script src="modules/ConversationAnalysisEngine.js"></script>
    <script src="modules/AutoPluginGenerator.js"></script>
    <script src="modules/EvolutionPluginTestFramework.js"></script>
    <script src="modules/ConversationEvolutionStorageManager.js"></script>
    <script src="modules/ConversationEvolutionManager.js"></script>
    <script src="modules/EvolutionInterfaceManager.js"></script>
    
    <!-- CRISPR Designer -->
    <script src="modules/CrisprDesigner.js"></script>
    
    <!-- Action Management System -->
    <script src="modules/ActionManager.js"></script>
    <script src="modules/CheckpointManager.js"></script>
    
    <!-- Tab Management System -->
    <script src="modules/TabManager.js"></script>
    
    <!-- Version Management -->
    <script src="../version.js"></script>
    
    <!-- Main application -->
    <script src="renderer-modular.js"></script>
</body>
</html> 