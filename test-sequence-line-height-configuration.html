<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequence Line Height Configuration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-header {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .test-instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        
        .test-step {
            margin: 10px 0;
            padding: 8px 0;
        }
        
        .test-step strong {
            color: #1976d2;
        }
        
        .expected-result {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #4caf50;
            margin: 10px 0;
        }
        
        .test-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .feature-demo {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        .highlight {
            background: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .note {
            background: #fff3e0;
            border: 1px solid #ffcc02;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        
        .note-icon {
            color: #ff9800;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-header">🧬 Sequence Line Height Configuration Test</h1>
        
        <div class="test-instructions">
            <h3>📋 Test Overview</h3>
            <p>This test verifies the new <strong>configurable sequence line height</strong> feature in GenomeExplorer's sequence window. The feature allows users to adjust the height of sequence lines for better readability.</p>
        </div>
        
        <div class="feature-demo">
            <h3>🎯 New Features Added</h3>
            <ul>
                <li><strong>Line Height Property:</strong> Added <code>this.lineHeight = 28</code> (default increased from 24px)</li>
                <li><strong>Line Height Selector:</strong> Dropdown with options: Compact (20px), Normal (24px), Comfortable (28px), Spacious (32px), Extra Large (36px)</li>
                <li><strong>CSS Variable Support:</strong> Dynamic CSS variables <code>--sequence-line-height</code> and <code>--sequence-line-ratio</code></li>
                <li><strong>Unified Styling:</strong> Both DNA and Protein sequences use the same configurable line height</li>
                <li><strong>Cache Management:</strong> Automatic cache clearing when line height changes</li>
            </ul>
        </div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">🧪 Test Procedures</h2>
        
        <div class="test-step">
            <strong>Step 1: Open Sequence Window</strong>
            <div class="expected-result">
                <strong>Expected:</strong> 
                <ul>
                    <li>Default line height should be "Comfortable" (28px) instead of previous 24px</li>
                    <li>Line Height selector should appear next to Display selector</li>
                    <li>CSS variables should be set: <code>--sequence-line-height: 28px</code></li>
                </ul>
            </div>
        </div>
        
        <div class="test-step">
            <strong>Step 2: Test Line Height Options</strong>
            <div class="expected-result">
                <strong>Expected:</strong>
                <ul>
                    <li><strong>Compact (20px):</strong> Tighter spacing, more lines visible</li>
                    <li><strong>Normal (24px):</strong> Previous default spacing</li>
                    <li><strong>Comfortable (28px):</strong> New default, better readability</li>
                    <li><strong>Spacious (32px):</strong> More breathing room</li>
                    <li><strong>Extra Large (36px):</strong> Maximum spacing for accessibility</li>
                </ul>
            </div>
        </div>
        
        <div class="test-step">
            <strong>Step 3: Test Display Mode Compatibility</strong>
            <div class="expected-result">
                <strong>Expected:</strong>
                <ul>
                    <li><strong>DNA Only:</strong> Line height applies to DNA sequences</li>
                    <li><strong>Protein Only:</strong> Line height applies to protein sequences</li>
                    <li><strong>DNA + Protein:</strong> Line height applies to both</li>
                    <li><strong>Auto:</strong> Line height applies to all auto-selected content</li>
                </ul>
            </div>
        </div>
        
        <div class="test-step">
            <strong>Step 4: Test Cache and Performance</strong>
            <div class="expected-result">
                <strong>Expected:</strong>
                <ul>
                    <li>Changing line height should clear render cache</li>
                    <li>Sequence should re-render immediately with new height</li>
                    <li>No visual glitches or compression</li>
                    <li>Position labels remain aligned</li>
                </ul>
            </div>
        </div>
        
        <div class="test-step">
            <strong>Step 5: Test Mode Switching</strong>
            <div class="expected-result">
                <strong>Expected:</strong>
                <ul>
                    <li>Line height selector should disappear in Edit Mode</li>
                    <li>Line height selector should reappear when returning to View Mode</li>
                    <li>Line height setting should be preserved across mode switches</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">🔧 Technical Implementation Details</h2>
        
        <div class="feature-demo">
            <h3>JavaScript Changes</h3>
            <div class="code-block">
// Constructor - Added line height property
this.lineHeight = 28; // Default increased from 24px to 28px

// Added line height selector method
addLineHeightSelector(sequenceControls) {
    // Creates dropdown with 5 height options
    // Handles change events and cache clearing
}

// Updated rendering methods
renderSequenceLine() {
    const lineHeightRatio = Math.max(1.2, this.lineHeight / 16);
    sequenceLine.style.cssText = `...min-height: ${this.lineHeight}px; line-height: ${lineHeightRatio};...`;
}

// CSS variable management
updateSequenceLineHeightCSS() {
    root.style.setProperty('--sequence-line-height', `${this.lineHeight}px`);
    root.style.setProperty('--sequence-line-ratio', lineHeightRatio.toString());
}
            </div>
        </div>
        
        <div class="feature-demo">
            <h3>CSS Enhancements</h3>
            <div class="code-block">
/* Enhanced sequence line height support */
.sequence-line {
    min-height: var(--sequence-line-height, 28px) !important;
    line-height: var(--sequence-line-ratio, 1.8) !important;
    flex-shrink: 0 !important;
}

/* Prevents compression at all zoom levels */
.detailed-sequence-view .sequence-line,
.protein-only-mode .sequence-line,
.sequence-line-group .sequence-line {
    min-height: var(--sequence-line-height, 28px) !important;
    flex-shrink: 0 !important;
}
            </div>
        </div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">✅ Test Checklist</h2>
        
        <div class="test-step">
            <input type="checkbox" id="test1"> <label for="test1">Line Height selector appears in sequence controls</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test2"> <label for="test2">Default line height is "Comfortable" (28px)</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test3"> <label for="test3">All 5 line height options work correctly</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test4"> <label for="test4">Line height applies to both DNA and Protein sequences</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test5"> <label for="test5">Sequence re-renders immediately when line height changes</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test6"> <label for="test6">No visual compression or alignment issues</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test7"> <label for="test7">Line height selector hidden/shown correctly in mode switches</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
        
        <div class="test-step">
            <input type="checkbox" id="test8"> <label for="test8">CSS variables updated correctly</label>
            <span class="test-status status-pending">PENDING</span>
        </div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">🎨 Visual Comparison Guide</h2>
        
        <div class="note">
            <span class="note-icon">💡</span>
            <strong>Quick Visual Test:</strong> Open the same sequence region and switch between different line height settings. You should see clear differences in vertical spacing while maintaining proper alignment of position labels and gene indicators.
        </div>
        
        <div class="feature-demo">
            <h3>Expected Visual Differences</h3>
            <ul>
                <li><strong>Compact (20px):</strong> Sequences appear tighter, more content fits in view</li>
                <li><strong>Normal (24px):</strong> Previous standard appearance</li>
                <li><strong>Comfortable (28px):</strong> <span class="highlight">New default</span> - noticeably more readable</li>
                <li><strong>Spacious (32px):</strong> Generous spacing, easier on eyes</li>
                <li><strong>Extra Large (36px):</strong> Maximum spacing for accessibility needs</li>
            </ul>
        </div>
    </div>
    
    <div class="test-container">
        <h2 class="test-header">🚀 Success Criteria</h2>
        
        <div class="expected-result">
            <h3>✅ Test Passes If:</h3>
            <ul>
                <li>All 8 checklist items are completed successfully</li>
                <li>Line height changes are immediately visible</li>
                <li>No console errors during line height changes</li>
                <li>Sequence alignment remains perfect at all heights</li>
                <li>Performance remains smooth during height transitions</li>
                <li>Feature works consistently across all display modes</li>
            </ul>
        </div>
        
        <div class="note">
            <span class="note-icon">🔍</span>
            <strong>Developer Note:</strong> Check browser DevTools to verify CSS variables are being set correctly: <code>--sequence-line-height</code> and <code>--sequence-line-ratio</code> should update when line height changes.
        </div>
    </div>
    
    <script>
        // Add interactivity to checkboxes
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const statusSpan = this.parentElement.querySelector('.test-status');
                if (this.checked) {
                    statusSpan.textContent = 'PASS';
                    statusSpan.className = 'test-status status-pass';
                } else {
                    statusSpan.textContent = 'PENDING';
                    statusSpan.className = 'test-status status-pending';
                }
            });
        });
        
        // Show completion message when all tests pass
        document.addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const checkedBoxes = document.querySelectorAll('input[type="checkbox"]:checked');
            
            if (checkboxes.length === checkedBoxes.length) {
                const message = document.createElement('div');
                message.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #4caf50;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 6px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    z-index: 1000;
                    font-weight: bold;
                `;
                message.textContent = '🎉 All tests completed! Line height configuration is working correctly.';
                document.body.appendChild(message);
                
                setTimeout(() => {
                    message.remove();
                }, 5000);
            }
        });
        
        console.log('🧬 Sequence Line Height Configuration Test loaded');
        console.log('📝 Use this test file to verify the new line height feature');
        console.log('🎯 Default line height increased from 24px to 28px for better readability');
    </script>
</body>
</html> 